var app=function(){"use strict";function t(){}const e=t=>t;function n(t,e){for(const n in e)t[n]=e[n];return t}function r(t){return t()}function i(){return Object.create(null)}function o(t){t.forEach(r)}function s(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let u;function c(t,e){return u||(u=document.createElement("a")),u.href=e,t===u.href}function l(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function h(t,e,n){return t.set(n),e}const f="undefined"!=typeof window;let d=f?()=>window.performance.now():()=>Date.now(),p=f?t=>requestAnimationFrame(t):t;const v=new Set;function g(t){v.forEach((e=>{e.c(t)||(v.delete(e),e.f())})),0!==v.size&&p(g)}function y(t){let e;return 0===v.size&&p(g),{promise:new Promise((n=>{v.add(e={c:t,f:n})})),abort(){v.delete(e)}}}function m(t,e){t.appendChild(e)}function b(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e.host?e:document}function w(t){const e=T("style");return function(t,e){m(t.head||t,e)}(b(t),e),e}function E(t,e,n){t.insertBefore(e,n||null)}function I(t){t.parentNode.removeChild(t)}function _(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function T(t){return document.createElement(t)}function S(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function A(t){return document.createTextNode(t)}function k(){return A(" ")}function N(){return A("")}function D(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function C(t){return function(e){return e.preventDefault(),t.call(this,e)}}function x(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function R(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function O(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function L(t,e){for(let n=0;n<t.options.length;n+=1){const r=t.options[n];if(r.__value===e)return void(r.selected=!0)}}function P(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function M(t,e,n){t.classList[n?"add":"remove"](e)}class F{constructor(){this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){this.e||(this.e=T(e.nodeName),this.t=e,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)E(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(I)}}const V=new Set;let U,q=0;function j(t,e,n,r,i,o,s,a=0){const u=16.666/r;let c="{\n";for(let t=0;t<=1;t+=u){const r=e+(n-e)*o(t);c+=100*t+`%{${s(r,1-r)}}\n`}const l=c+`100% {${s(n,1-n)}}\n}`,h=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(l)}_${a}`,f=b(t);V.add(f);const d=f.__svelte_stylesheet||(f.__svelte_stylesheet=w(t).sheet),p=f.__svelte_rules||(f.__svelte_rules={});p[h]||(p[h]=!0,d.insertRule(`@keyframes ${h} ${l}`,d.cssRules.length));const v=t.style.animation||"";return t.style.animation=`${v?`${v}, `:""}${h} ${r}ms linear ${i}ms 1 both`,q+=1,h}function B(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-r.length;i&&(t.style.animation=r.join(", "),q-=i,q||p((()=>{q||(V.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),V.clear())})))}function z(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const r=getComputedStyle(t),i="none"===r.transform?"":r.transform;t.style.transform=`${i} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}function $(t){U=t}function K(){if(!U)throw new Error("Function called outside component initialization");return U}const G=[],H=[],Q=[],W=[],Y=Promise.resolve();let X=!1;function J(t){Q.push(t)}let Z=!1;const tt=new Set;function et(){if(!Z){Z=!0;do{for(let t=0;t<G.length;t+=1){const e=G[t];$(e),nt(e.$$)}for($(null),G.length=0;H.length;)H.pop()();for(let t=0;t<Q.length;t+=1){const e=Q[t];tt.has(e)||(tt.add(e),e())}Q.length=0}while(G.length);for(;W.length;)W.pop()();X=!1,Z=!1,tt.clear()}}function nt(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(J)}}let rt;function it(){return rt||(rt=Promise.resolve(),rt.then((()=>{rt=null}))),rt}function ot(t,e,n){t.dispatchEvent(function(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}(`${e?"intro":"outro"}${n}`))}const st=new Set;let at;function ut(){at={r:0,c:[],p:at}}function ct(){at.r||o(at.c),at=at.p}function lt(t,e){t&&t.i&&(st.delete(t),t.i(e))}function ht(t,e,n,r){if(t&&t.o){if(st.has(t))return;st.add(t),at.c.push((()=>{st.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}const ft={duration:0};function dt(n,r,i,a){let u=r(n,i),c=a?0:1,l=null,h=null,f=null;function p(){f&&B(n,f)}function v(t,e){const n=t.b-c;return e*=Math.abs(n),{a:c,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function g(r){const{delay:i=0,duration:s=300,easing:a=e,tick:g=t,css:m}=u||ft,b={start:d()+i,b:r};r||(b.group=at,at.r+=1),l||h?h=b:(m&&(p(),f=j(n,c,r,s,i,a,m)),r&&g(0,1),l=v(b,s),J((()=>ot(n,r,"start"))),y((t=>{if(h&&t>h.start&&(l=v(h,s),h=null,ot(n,l.b,"start"),m&&(p(),f=j(n,c,l.b,l.duration,0,a,u.css))),l)if(t>=l.end)g(c=l.b,1-c),ot(n,l.b,"end"),h||(l.b?p():--l.group.r||o(l.group.c)),l=null;else if(t>=l.start){const e=t-l.start;c=l.a+l.d*a(e/l.duration),g(c,1-c)}return!(!l&&!h)})))}return{run(t){s(u)?it().then((()=>{u=u(),g(t)})):g(t)},end(){p(),l=h=null}}}function pt(t,e){const n=e.token={};function r(t,r,i,o){if(e.token!==n)return;e.resolved=o;let s=e.ctx;void 0!==i&&(s=s.slice(),s[i]=o);const a=t&&(e.current=t)(s);let u=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(ut(),ht(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),ct())})):e.block.d(1),a.c(),lt(a,1),a.m(e.mount(),e.anchor),u=!0),e.block=a,e.blocks&&(e.blocks[r]=a),u&&et()}if((i=t)&&"object"==typeof i&&"function"==typeof i.then){const n=K();if(t.then((t=>{$(n),r(e.then,1,e.value,t),$(null)}),(t=>{if($(n),r(e.catch,2,e.error,t),$(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var i}function vt(t,e,n){const r=e.slice(),{resolved:i}=t;t.current===t.then&&(r[t.value]=i),t.current===t.catch&&(r[t.error]=i),t.block.p(r,n)}const gt="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function yt(t,e){t.f(),function(t,e){ht(t,1,1,(()=>{e.delete(t.key)}))}(t,e)}function mt(t,e){const n={},r={},i={$$scope:1};let o=t.length;for(;o--;){const s=t[o],a=e[o];if(a){for(const t in s)t in a||(r[t]=1);for(const t in a)i[t]||(n[t]=a[t],i[t]=1);t[o]=a}else for(const t in s)i[t]=1}for(const t in r)t in n||(n[t]=void 0);return n}function bt(t){return"object"==typeof t&&null!==t?t:{}}function wt(t){t&&t.c()}function Et(t,e,n,i){const{fragment:a,on_mount:u,on_destroy:c,after_update:l}=t.$$;a&&a.m(e,n),i||J((()=>{const e=u.map(r).filter(s);c?c.push(...e):o(e),t.$$.on_mount=[]})),l.forEach(J)}function It(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function _t(t,e){-1===t.$$.dirty[0]&&(G.push(t),X||(X=!0,Y.then(et)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Tt(e,n,r,s,a,u,c,l=[-1]){const h=U;$(e);const f=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:n.context||[]),callbacks:i(),dirty:l,skip_bound:!1,root:n.target||h.$$.root};c&&c(f.root);let d=!1;if(f.ctx=r?r(e,n.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return f.ctx&&a(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),d&&_t(e,t)),n})):[],f.update(),d=!0,o(f.before_update),f.fragment=!!s&&s(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(I)}else f.fragment&&f.fragment.c();n.intro&&lt(e.$$.fragment),Et(e,n.target,n.anchor,n.customElement),et()}$(h)}class St{$destroy(){It(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function At(t){const e=t-1;return e*e*e+1}function kt(t,{delay:n=0,duration:r=400,easing:i=e}={}){const o=+getComputedStyle(t).opacity;return{delay:n,duration:r,easing:i,css:t=>"opacity: "+t*o}}function Nt(t,{delay:e=0,duration:n=400,easing:r=At,x:i=0,y:o=0,opacity:s=0}={}){const a=getComputedStyle(t),u=+a.opacity,c="none"===a.transform?"":a.transform,l=u*(1-s);return{delay:e,duration:n,easing:r,css:(t,e)=>`\n\t\t\ttransform: ${c} translate(${(1-t)*i}px, ${(1-t)*o}px);\n\t\t\topacity: ${u-l*e}`}}function Dt(t,{delay:e=0,duration:n=400,easing:r=At}={}){const i=getComputedStyle(t),o=+i.opacity,s=parseFloat(i.height),a=parseFloat(i.paddingTop),u=parseFloat(i.paddingBottom),c=parseFloat(i.marginTop),l=parseFloat(i.marginBottom),h=parseFloat(i.borderTopWidth),f=parseFloat(i.borderBottomWidth);return{delay:e,duration:n,easing:r,css:t=>`overflow: hidden;opacity: ${Math.min(20*t,1)*o};height: ${t*s}px;padding-top: ${t*a}px;padding-bottom: ${t*u}px;margin-top: ${t*c}px;margin-bottom: ${t*l}px;border-top-width: ${t*h}px;border-bottom-width: ${t*f}px;`}}function Ct(t,e,n={}){const r=getComputedStyle(t),i="none"===r.transform?"":r.transform,o=e.from.width/t.clientWidth,a=e.from.height/t.clientHeight,u=(e.from.left-e.to.left)/o,c=(e.from.top-e.to.top)/a,l=Math.sqrt(u*u+c*c),{delay:h=0,duration:f=(t=>120*Math.sqrt(t)),easing:d=At}=n;return{delay:h,duration:s(f)?f(l):f,easing:d,css:(t,e)=>`transform: ${i} translate(${e*u}px, ${e*c}px);`}}function xt(e){let n;return{c(){n=T("div"),x(n,"class","circle svelte-14upwad"),O(n,"--size",e[3]+e[1]),O(n,"--color",e[0]),O(n,"--duration",e[2])},m(t,e){E(t,n,e)},p(t,[e]){10&e&&O(n,"--size",t[3]+t[1]),1&e&&O(n,"--color",t[0]),4&e&&O(n,"--duration",t[2])},i:t,o:t,d(t){t&&I(n)}}}function Rt(t,e,n){let{color:r="#FF3E00"}=e,{unit:i="px"}=e,{duration:o="0.75s"}=e,{size:s="60"}=e;return t.$$set=t=>{"color"in t&&n(0,r=t.color),"unit"in t&&n(1,i=t.unit),"duration"in t&&n(2,o=t.duration),"size"in t&&n(3,s=t.size)},[r,i,o,s]}class Ot extends St{constructor(t){super(),Tt(this,t,Rt,xt,a,{color:0,unit:1,duration:2,size:3})}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var Lt=function(t,e){return(Lt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Pt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Lt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Mt=function(){return(Mt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Ft(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function Vt(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function Ut(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function qt(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function jt(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Bt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,d=63&c;u||(d=64,s||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var l=s<<4&240|a>>2;if(r.push(l),64!==u){var h=a<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};function zt(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=zt(t[n],e[n]));return t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var $t=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Kt(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Gt(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Ht=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,Qt.prototype.create),o}return Pt(e,t),e}(Error),Qt=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?Wt(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new Ht(i,a,r);return u},t}();function Wt(t,e){return t.replace(Yt,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var Yt=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Xt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Jt(t,e){var n=new Zt(t,e);return n.subscribe.bind(n)}var Zt=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=te),void 0===r.error&&(r.error=te),void 0===r.complete&&(r.complete=te);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function te(){}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ee(t){return t&&t._delegate?t._delegate:t}var ne=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),re="[DEFAULT]",ie=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new $t;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t))try{this.getOrInitializeService({instanceIdentifier:re})}catch(t){}try{for(var r=Ut(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=qt(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService({instanceIdentifier:u});a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=re),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Ft(this,void 0,void 0,(function(){var t;return Vt(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(jt(jt([],qt(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),qt(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=re),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var a=Ut(this.instancesDeferred.entries()),u=a.next();!u.done;u=a.next()){var c=qt(u.value,2),l=c[0],h=c[1];o===this.normalizeInstanceIdentifier(l)&&h.resolve(s)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return s},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var o=Ut(i),s=o.next();!s.done;s=o.next()){var a=s.value;try{a(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===re?void 0:e),options:i}),this.instances.set(n,o),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=re),this.component?this.component.multipleInstances?t:re:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var oe,se=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new ie(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function ae(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ue,ce=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(ue||(ue={}));var le,he={debug:ue.DEBUG,verbose:ue.VERBOSE,info:ue.INFO,warn:ue.WARN,error:ue.ERROR,silent:ue.SILENT},fe=ue.INFO,de=((oe={})[ue.DEBUG]="log",oe[ue.VERBOSE]="log",oe[ue.INFO]="info",oe[ue.WARN]="warn",oe[ue.ERROR]="error",oe),pe=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=de[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,ae(["["+i+"]  "+t.name+":"],n))}},ve=function(){function t(t){this.name=t,this._logLevel=fe,this._logHandler=pe,this._userLogHandler=null,ce.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in ue))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?he[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ae([this,ue.DEBUG],t)),this._logHandler.apply(this,ae([this,ue.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ae([this,ue.VERBOSE],t)),this._logHandler.apply(this,ae([this,ue.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ae([this,ue.INFO],t)),this._logHandler.apply(this,ae([this,ue.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ae([this,ue.WARN],t)),this._logHandler.apply(this,ae([this,ue.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ae([this,ue.ERROR],t)),this._logHandler.apply(this,ae([this,ue.ERROR],t))},t}();function ge(t){ce.forEach((function(e){e.setLogLevel(t)}))}var ye,me=((le={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",le["bad-app-name"]="Illegal App name: '{$appName}",le["duplicate-app"]="Firebase App named '{$appName}' already exists",le["app-deleted"]="Firebase App named '{$appName}' already deleted",le["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",le["invalid-log-argument"]="First argument to `onLog` must be null or a function.",le),be=new Qt("app","Firebase",me),we="@firebase/app",Ee="[DEFAULT]",Ie=((ye={})[we]="fire-core",ye["@firebase/analytics"]="fire-analytics",ye["@firebase/app-check"]="fire-app-check",ye["@firebase/auth"]="fire-auth",ye["@firebase/database"]="fire-rtdb",ye["@firebase/functions"]="fire-fn",ye["@firebase/installations"]="fire-iid",ye["@firebase/messaging"]="fire-fcm",ye["@firebase/performance"]="fire-perf",ye["@firebase/remote-config"]="fire-rc",ye["@firebase/storage"]="fire-gcs",ye["@firebase/firestore"]="fire-fst",ye["fire-js"]="fire-js",ye["firebase-wrapper"]="fire-js-all",ye),_e=new ve("@firebase/app"),Te=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=zt(void 0,t),this.container=new se(e.name),this._addComponent(new ne("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=Ee),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=Ee),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){_e.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw be.create("app-deleted",{appName:this.name_})},t}();Te.prototype.name&&Te.prototype.options||Te.prototype.delete||console.log("dc");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Se(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name=Ee);var s=o.name;if("string"!=typeof s||!s)throw be.create("bad-app-name",{appName:String(s)});if(Xt(e,s))throw be.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=Ie[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void _e.warn(u.join(" "))}o(new ne(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:ge,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw be.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=he[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:ue[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=ce;r<i.length;r++)n(i[r])}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t,e)},apps:null,SDK_VERSION:"8.7.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!Xt(e,t=t||Ee))throw be.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return _e.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw be.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&zt(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var l=c[u];e[l]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ae=function t(){var e=Se(Te);return e.INTERNAL=Mt(Mt({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){zt(e,t)},createSubscribe:Jt,ErrorFactory:Qt,deepExtend:zt}),e}(),ke=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){_e.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Ne=self.firebase.SDK_VERSION;Ne&&Ne.indexOf("LITE")>=0&&_e.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var De=Ae.initializeApp;Ae.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Gt()&&_e.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),De.apply(void 0,t)};var Ce=Ae;!function(t,e){t.INTERNAL.registerComponent(new ne("platform-logger",(function(t){return new ke(t)}),"PRIVATE")),t.registerVersion(we,"0.6.28",e),t.registerVersion("fire-js","")}(Ce);var xe="8.8.0";
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
Ce.registerVersion("firebase",xe,"app"),Ce.SDK_VERSION=xe;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var Re=function(t,e){return(Re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Oe(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Le,Pe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Me=Me||{},Fe=Pe||self;function Ve(){}function Ue(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function qe(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var je="closure_uid_"+(1e9*Math.random()>>>0),Be=0;function ze(t,e,n){return t.call.apply(t.bind,arguments)}function $e(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Ke(t,e,n){return(Ke=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ze:$e).apply(null,arguments)}function Ge(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function He(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function Qe(){this.s=this.s,this.o=this.o}var We={};Qe.prototype.s=!1,Qe.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,je)&&t[je]||(t[je]=++Be)}(this);delete We[t]}},Qe.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Ye=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Xe=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Je(t){return Array.prototype.concat.apply([],arguments)}function Ze(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function tn(t){return/^[\s\xa0]*$/.test(t)}var en,nn=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function rn(t,e){return-1!=t.indexOf(e)}function on(t,e){return t<e?-1:t>e?1:0}t:{var sn=Fe.navigator;if(sn){var an=sn.userAgent;if(an){en=an;break t}}en=""}function un(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function cn(t){var e={};for(var n in t)e[n]=t[n];return e}var ln="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function hn(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<ln.length;o++)n=ln[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function fn(t){return fn[" "](t),t}fn[" "]=Ve;var dn,pn,vn=rn(en,"Opera"),gn=rn(en,"Trident")||rn(en,"MSIE"),yn=rn(en,"Edge"),mn=yn||gn,bn=rn(en,"Gecko")&&!(rn(en.toLowerCase(),"webkit")&&!rn(en,"Edge"))&&!(rn(en,"Trident")||rn(en,"MSIE"))&&!rn(en,"Edge"),wn=rn(en.toLowerCase(),"webkit")&&!rn(en,"Edge");function En(){var t=Fe.document;return t?t.documentMode:void 0}t:{var In="",_n=(pn=en,bn?/rv:([^\);]+)(\)|;)/.exec(pn):yn?/Edge\/([\d\.]+)/.exec(pn):gn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(pn):wn?/WebKit\/(\S+)/.exec(pn):vn?/(?:Version)[ \/]?(\S+)/.exec(pn):void 0);if(_n&&(In=_n?_n[1]:""),gn){var Tn=En();if(null!=Tn&&Tn>parseFloat(In)){dn=String(Tn);break t}}dn=In}var Sn,An={};function kn(){return function(t){var e=An;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=nn(String(dn)).split("."),n=nn("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=on(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||on(0==o[2].length,0==s[2].length)||on(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}))}if(Fe.document&&gn){var Nn=En();Sn=Nn||(parseInt(dn,10)||void 0)}else Sn=void 0;var Dn=Sn,Cn=function(){if(!Fe.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Fe.addEventListener("test",Ve,e),Fe.removeEventListener("test",Ve,e)}catch(t){}return t}();function xn(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Rn(t,e){if(xn.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(bn){t:{try{fn(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:On[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Rn.Z.h.call(this)}}xn.prototype.h=function(){this.defaultPrevented=!0},He(Rn,xn);var On={2:"touch",3:"pen",4:"mouse"};Rn.prototype.h=function(){Rn.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Ln="closure_listenable_"+(1e6*Math.random()|0),Pn=0;function Mn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++Pn,this.ca=this.fa=!1}function Fn(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Vn(t){this.src=t,this.g={},this.h=0}function Un(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=Ye(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Fn(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function qn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}Vn.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=qn(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new Mn(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var jn="closure_lm_"+(1e6*Math.random()|0),Bn={};function zn(t,e,n,r,i){if(r&&r.once)return Kn(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)zn(t,e[o],n,r,i);return null}return n=Jn(n),t&&t[Ln]?t.N(e,n,qe(r)?!!r.capture:!!r,i):$n(t,e,n,!1,r,i)}function $n(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=qe(i)?!!i.capture:!!i,a=Yn(t);if(a||(t[jn]=a=new Vn(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=Wn;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Cn||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Qn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Kn(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Kn(t,e[o],n,r,i);return null}return n=Jn(n),t&&t[Ln]?t.O(e,n,qe(r)?!!r.capture:!!r,i):$n(t,e,n,!0,r,i)}function Gn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Gn(t,e[o],n,r,i);else r=qe(r)?!!r.capture:!!r,n=Jn(n),t&&t[Ln]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=qn(o=t.g[e],n,r,i))&&(Fn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=Yn(t))&&(e=t.g[e.toString()],t=-1,e&&(t=qn(e,n,r,i)),(n=-1<t?e[t]:null)&&Hn(n))}function Hn(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Ln])Un(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Qn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Yn(e))?(Un(n,t),0==n.h&&(n.src=null,e[jn]=null)):Fn(t)}}}function Qn(t){return t in Bn?Bn[t]:Bn[t]="on"+t}function Wn(t,e){if(t.ca)t=!0;else{e=new Rn(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&Hn(t),t=n.call(r,e)}return t}function Yn(t){return(t=t[jn])instanceof Vn?t:null}var Xn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Jn(t){return"function"==typeof t?t:(t[Xn]||(t[Xn]=function(e){return t.handleEvent(e)}),t[Xn])}function Zn(){Qe.call(this),this.i=new Vn(this),this.P=this,this.I=null}function tr(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new xn(e,t);else if(e instanceof xn)e.target=e.target||t;else{var i=e;hn(e=new xn(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=er(s,r,!0,e)&&i}if(i=er(s=e.g=t,r,!0,e)&&i,i=er(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=er(s=e.g=n[o],r,!1,e)&&i}function er(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&Un(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}He(Zn,Qe),Zn.prototype[Ln]=!0,Zn.prototype.removeEventListener=function(t,e,n,r){Gn(this,t,e,n,r)},Zn.prototype.M=function(){if(Zn.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Fn(n[r]);delete e.g[t],e.h--}}this.I=null},Zn.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Zn.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var nr=Fe.JSON.stringify;function rr(){var t=hr,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var ir,or=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=sr.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),sr=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new ar}),(function(t){return t.reset()})),ar=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function ur(t){Fe.setTimeout((function(){throw t}),0)}function cr(t,e){ir||function(){var t=Fe.Promise.resolve(void 0);ir=function(){t.then(fr)}}(),lr||(ir(),lr=!0),hr.add(t,e)}var lr=!1,hr=new or;function fr(){for(var t;t=rr();){try{t.h.call(t.g)}catch(t){ur(t)}var e=sr;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}lr=!1}function dr(t,e){Zn.call(this),this.h=t||1,this.g=e||Fe,this.j=Ke(this.kb,this),this.l=Date.now()}function pr(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function vr(t,e,n){if("function"==typeof t)n&&(t=Ke(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Ke(t.handleEvent,t)}return 2147483647<Number(e)?-1:Fe.setTimeout(t,e||0)}function gr(t){t.g=vr((function(){t.g=null,t.i&&(t.i=!1,gr(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}He(dr,Zn),(Le=dr.prototype).da=!1,Le.S=null,Le.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),tr(this,"tick"),this.da&&(pr(this),this.start()))}},Le.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Le.M=function(){dr.Z.M.call(this),pr(this),delete this.g};var yr=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Re(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:gr(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(Fe.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(Qe);function mr(t){Qe.call(this),this.h=t,this.g={}}He(mr,Qe);var br=[];function wr(t,e,n,r){Array.isArray(n)||(n&&(br[0]=n.toString()),n=br);for(var i=0;i<n.length;i++){var o=zn(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function Er(t){un(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Hn(t)}),t),t.g={}}function Ir(){this.g=!0}function _r(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return nr(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}mr.prototype.M=function(){mr.Z.M.call(this),Er(this)},mr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ir.prototype.Aa=function(){this.g=!1},Ir.prototype.info=function(){};var Tr={},Sr=null;function Ar(){return Sr=Sr||new Zn}function kr(t){xn.call(this,Tr.Ma,t)}function Nr(t){var e=Ar();tr(e,new kr(e,t))}function Dr(t,e){xn.call(this,Tr.STAT_EVENT,t),this.stat=e}function Cr(t){var e=Ar();tr(e,new Dr(e,t))}function xr(t,e){xn.call(this,Tr.Na,t),this.size=e}function Rr(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Fe.setTimeout((function(){t()}),e)}Tr.Ma="serverreachability",He(kr,xn),Tr.STAT_EVENT="statevent",He(Dr,xn),Tr.Na="timingevent",He(xr,xn);var Or={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Lr={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Pr(){}function Mr(t){return t.h||(t.h=t.i())}function Fr(){}Pr.prototype.h=null;var Vr,Ur={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function qr(){xn.call(this,"d")}function jr(){xn.call(this,"c")}function Br(){}function zr(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new mr(this),this.P=Kr,t=mn?125:void 0,this.W=new dr(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new $r}function $r(){this.i=null,this.g="",this.h=!1}He(qr,xn),He(jr,xn),He(Br,Pr),Br.prototype.g=function(){return new XMLHttpRequest},Br.prototype.i=function(){return{}},Vr=new Br;var Kr=45e3,Gr={},Hr={};function Qr(t,e,n){t.K=1,t.v=yi(hi(e)),t.s=n,t.U=!0,Wr(t,null)}function Wr(t,e){t.F=Date.now(),Zr(t),t.A=hi(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Ci(n.h,"t",r),t.C=0,n=t.l.H,t.h=new $r,t.g=Ro(t.l,n?e:null,!t.s),0<t.O&&(t.L=new yr(Ke(t.Ia,t,t.g),t.O)),wr(t.V,t.g,"readystatechange",t.gb),e=t.H?cn(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Nr(1),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");s=2<=h.length&&"type"==h[1]?s+(l+"=")+c+"&":s+(l+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function Yr(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function Xr(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=Jr(t,n))==Hr){4==e&&(t.o=4,Cr(14),i=!1),_r(t.j,t.m,null,"[Incomplete Response]");break}if(r==Gr){t.o=4,Cr(15),_r(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}_r(t.j,t.m,r,null),ii(t,r)}Yr(t)&&r!=Hr&&r!=Gr&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Cr(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),To(e),e.L=!0,Cr(11))):(_r(t.j,t.m,n,"[Invalid Chunked Response]"),ri(t),ni(t))}function Jr(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Hr:(n=Number(e.substring(n,r)),isNaN(n)?Gr:(r+=1)+n>e.length?Hr:(e=e.substr(r,n),t.C=r+n,e))}function Zr(t){t.Y=Date.now()+t.P,ti(t,t.P)}function ti(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Rr(Ke(t.eb,t),e)}function ei(t){t.B&&(Fe.clearTimeout(t.B),t.B=null)}function ni(t){0==t.l.G||t.I||ko(t.l,t)}function ri(t){ei(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,pr(t.W),Er(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function ii(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Fi(n.i,t)))if(n.I=t.N,!t.J&&Fi(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Ao(n),vo(n)}_o(n),Cr(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Rr(Ke(n.ab,n),6e3));if(1>=Mi(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else Do(n,11)}else if((t.J||n.g==t)&&Ao(n),!tn(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(rn(l,"spdy")||rn(l,"quic")||rn(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(Vi(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,gi(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=t;if((r=n).oa=xo(r,r.H?r.la:null,r.W),d.J){Ui(r.i,d);var p=d,v=r.K;v&&p.setTimeout(v),p.B&&(ei(p),Zr(p)),r.g=d}else Io(r);0<n.l.length&&mo(n)}else"stop"!=o[0]&&"close"!=o[0]||Do(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?Do(n,7):po(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}Nr(4)}catch(o){}}function oi(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Ue(t)||"string"==typeof t)Xe(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(Ue(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(Ue(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function si(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof si)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ai(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];ui(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)ui(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function ui(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(Le=zr.prototype).setTimeout=function(t){this.P=t},Le.gb=function(t){t=t.target;var e=this.L;e&&3==uo(t)?e.l():this.Ia(t)},Le.Ia=function(t){try{if(t==this.g)t:{var e=uo(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||mn||this.g&&(this.h.h||this.g.ga()||co(this.g)))){this.I||4!=e||7==n||Nr(8==n||0>=r?3:2),ei(this);var i=this.g.ba();this.N=i;e:if(Yr(this)){var o=co(this.g);t="";var s=o.length,a=4==uo(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){ri(this),ni(this);var u="";break e}this.h.i=new Fe.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!tn(c)){var h=c;break e}}h=null}if(!(i=h)){this.i=!1,this.o=3,Cr(12),ri(this),ni(this);break t}_r(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,ii(this,i)}this.U?(Xr(this,e,u),mn&&this.i&&3==e&&(wr(this.V,this.W,"tick",this.fb),this.W.start())):(_r(this.j,this.m,u,null),ii(this,u)),4==e&&ri(this),this.i&&!this.I&&(4==e?ko(this.l,this):(this.i=!1,Zr(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,Cr(12)):(this.o=0,Cr(13)),ri(this),ni(this)}}}catch(e){}},Le.fb=function(){if(this.g){var t=uo(this.g),e=this.g.ga();this.C<e.length&&(ei(this),Xr(this,t,e),this.i&&4!=t&&Zr(this))}},Le.cancel=function(){this.I=!0,ri(this)},Le.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Nr(3),Cr(17)),ri(this),this.o=2,ni(this)):ti(this,this.Y-t)},(Le=si.prototype).R=function(){ai(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},Le.T=function(){return ai(this),this.g.concat()},Le.get=function(t,e){return ui(this.h,t)?this.h[t]:e},Le.set=function(t,e){ui(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},Le.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var ci=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function li(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof li){this.g=void 0!==e?e:t.g,fi(this,t.j),this.s=t.s,di(this,t.i),pi(this,t.m),this.l=t.l,e=t.h;var n=new Ai;n.i=e.i,e.g&&(n.g=new si(e.g),n.h=e.h),vi(this,n),this.o=t.o}else t&&(n=String(t).match(ci))?(this.g=!!e,fi(this,n[1]||"",!0),this.s=mi(n[2]||""),di(this,n[3]||"",!0),pi(this,n[4]),this.l=mi(n[5]||"",!0),vi(this,n[6]||"",!0),this.o=mi(n[7]||"")):(this.g=!!e,this.h=new Ai(null,this.g))}function hi(t){return new li(t)}function fi(t,e,n){t.j=n?mi(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function di(t,e,n){t.i=n?mi(e,!0):e}function pi(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function vi(t,e,n){e instanceof Ai?(t.h=e,function(t,e){e&&!t.j&&(ki(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Ni(this,e),Ci(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=bi(e,Ti)),t.h=new Ai(e,t.g))}function gi(t,e,n){t.h.set(e,n)}function yi(t){return gi(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function mi(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function bi(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,wi),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function wi(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}li.prototype.toString=function(){var t=[],e=this.j;e&&t.push(bi(e,Ei,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(bi(e,Ei,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(bi(n,"/"==n.charAt(0)?_i:Ii,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",bi(n,Si)),t.join("")};var Ei=/[#\/\?@]/g,Ii=/[#\?:]/g,_i=/[#\?]/g,Ti=/[#\?@]/g,Si=/#/g;function Ai(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ki(t){t.g||(t.g=new si,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Ni(t,e){ki(t),e=xi(t,e),ui(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,ui((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&ai(t)))}function Di(t,e){return ki(t),e=xi(t,e),ui(t.g.h,e)}function Ci(t,e,n){Ni(t,e),0<n.length&&(t.i=null,t.g.set(xi(t,e),Ze(n)),t.h+=n.length)}function xi(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(Le=Ai.prototype).add=function(t,e){ki(this),this.i=null,t=xi(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Le.forEach=function(t,e){ki(this),this.g.forEach((function(n,r){Xe(n,(function(n){t.call(e,n,r,this)}),this)}),this)},Le.T=function(){ki(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Le.R=function(t){ki(this);var e=[];if("string"==typeof t)Di(this,t)&&(e=Je(e,this.g.get(xi(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=Je(e,t[n])}return e},Le.set=function(t,e){return ki(this),this.i=null,Di(this,t=xi(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Le.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},Le.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var Ri=function(t,e){this.h=t,this.g=e};function Oi(t){this.l=t||Li,Fe.PerformanceNavigationTiming?t=0<(t=Fe.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(Fe.g&&Fe.g.Ea&&Fe.g.Ea()&&Fe.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Li=10;function Pi(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Mi(t){return t.h?1:t.g?t.g.size:0}function Fi(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Vi(t,e){t.g?t.g.add(e):t.h=e}function Ui(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function qi(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=Oe(t.g.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return Ze(t.i)}function ji(){}function Bi(){this.g=new ji}function zi(t,e,n){var r=n||"";try{oi(t,(function(t,n){var i=t;qe(t)&&(i=nr(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function $i(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function Ki(t){this.l=t.$b||null,this.j=t.ib||!1}function Gi(t,e){Zn.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Hi,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Oi.prototype.cancel=function(){var t,e;if(this.i=qi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=Oe(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},ji.prototype.stringify=function(t){return Fe.JSON.stringify(t,void 0)},ji.prototype.parse=function(t){return Fe.JSON.parse(t,void 0)},He(Ki,Pr),Ki.prototype.g=function(){return new Gi(this.l,this.j)},Ki.prototype.i=function(t){return function(){return t}}({}),He(Gi,Zn);var Hi=0;function Qi(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Wi(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Yi(t)}function Yi(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Le=Gi.prototype).open=function(t,e){if(this.readyState!=Hi)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Yi(this)},Le.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Fe).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},Le.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Wi(this)),this.readyState=Hi},Le.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Yi(this)),this.g&&(this.readyState=3,Yi(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Fe.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Qi(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},Le.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Wi(this):Yi(this),3==this.readyState&&Qi(this)}},Le.Ua=function(t){this.g&&(this.response=this.responseText=t,Wi(this))},Le.Ta=function(t){this.g&&(this.response=t,Wi(this))},Le.ha=function(){this.g&&Wi(this)},Le.setRequestHeader=function(t,e){this.v.append(t,e)},Le.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Le.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Gi.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Xi=Fe.JSON.parse;function Ji(t){Zn.call(this),this.headers=new si,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Zi,this.K=this.L=!1}He(Ji,Zn);var Zi="",to=/^https?$/i,eo=["POST","PUT"];function no(t){return"content-type"==t.toLowerCase()}function ro(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,io(t),so(t)}function io(t){t.D||(t.D=!0,tr(t,"complete"),tr(t,"error"))}function oo(t){if(t.h&&void 0!==Me&&(!t.C[1]||4!=uo(t)||2!=t.ba()))if(t.v&&4==uo(t))vr(t.Fa,0,t);else if(tr(t,"readystatechange"),4==uo(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(ci)[1]||null;if(!o&&Fe.self&&Fe.self.location){var s=Fe.self.location.protocol;o=s.substr(0,s.length-1)}i=!to.test(o?o.toLowerCase():"")}e=i}if(e)tr(t,"complete"),tr(t,"success");else{t.m=6;try{var a=2<uo(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.ba()+"]",io(t)}}finally{so(t)}}}function so(t,e){if(t.g){ao(t);var n=t.g,r=t.C[0]?Ve:null;t.g=null,t.C=null,e||tr(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function ao(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Fe.clearTimeout(t.A),t.A=null)}function uo(t){return t.g?t.g.readyState:0}function co(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Zi:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function lo(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return un(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):gi(t,e,n))}function ho(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function fo(t){this.za=0,this.l=[],this.h=new Ir,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=ho("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=ho("baseRetryDelayMs",5e3,t),this.$a=ho("retryDelaySeedMs",1e4,t),this.Ya=ho("forwardChannelMaxRetries",2,t),this.ra=ho("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Oi(t&&t.concurrentRequestLimit),this.Ca=new Bi,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function po(t){if(go(t),3==t.G){var e=t.V++,n=hi(t.F);gi(n,"SID",t.J),gi(n,"RID",e),gi(n,"TYPE","terminate"),wo(t,n),(e=new zr(t,t.h,e,void 0)).K=2,e.v=yi(hi(n)),n=!1,Fe.navigator&&Fe.navigator.sendBeacon&&(n=Fe.navigator.sendBeacon(e.v.toString(),"")),!n&&Fe.Image&&((new Image).src=e.v,n=!0),n||(e.g=Ro(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Zr(e)}Co(t)}function vo(t){t.g&&(To(t),t.g.cancel(),t.g=null)}function go(t){vo(t),t.u&&(Fe.clearTimeout(t.u),t.u=null),Ao(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Fe.clearTimeout(t.m),t.m=null)}function yo(t,e){t.l.push(new Ri(t.Za++,e)),3==t.G&&mo(t)}function mo(t){Pi(t.i)||t.m||(t.m=!0,cr(t.Ha,t),t.C=0)}function bo(t,e){var n;n=e?e.m:t.V++;var r=hi(t.F);gi(r,"SID",t.J),gi(r,"RID",n),gi(r,"AID",t.U),wo(t,r),t.o&&t.s&&lo(r,t.o,t.s),n=new zr(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=Eo(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Vi(t.i,n),Qr(n,r,e)}function wo(t,e){t.j&&oi({},(function(t,n){gi(e,n,t)}))}function Eo(t,e,n){n=Math.min(t.l.length,n);var r=t.j?Ke(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].h,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{zi(l,s,"req"+c+"_")}catch(t){r&&r(l)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function Io(t){t.g||t.u||(t.Y=1,cr(t.Ga,t),t.A=0)}function _o(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=Rr(Ke(t.Ga,t),No(t,t.A)),t.A++,!0)}function To(t){null!=t.B&&(Fe.clearTimeout(t.B),t.B=null)}function So(t){t.g=new zr(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=hi(t.oa);gi(e,"RID","rpc"),gi(e,"SID",t.J),gi(e,"CI",t.N?"0":"1"),gi(e,"AID",t.U),wo(t,e),gi(e,"TYPE","xmlhttp"),t.o&&t.s&&lo(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=yi(hi(e)),n.s=null,n.U=!0,Wr(n,t)}function Ao(t){null!=t.v&&(Fe.clearTimeout(t.v),t.v=null)}function ko(t,e){var n=null;if(t.g==e){Ao(t),To(t),t.g=null;var r=2}else{if(!Fi(t.i,e))return;n=e.D,Ui(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;tr(r=Ar(),new xr(r,n,e,i)),mo(t)}else Io(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Mi(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=Rr(Ke(t.Ha,t,e),No(t,t.C)),t.C++,0)))}(t,e)||2==r&&_o(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Do(t,5);break;case 4:Do(t,10);break;case 3:Do(t,6);break;default:Do(t,2)}}function No(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Do(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=Ke(t.jb,t);n||(n=new li("//www.google.com/images/cleardot.gif"),Fe.location&&"http"==Fe.location.protocol||fi(n,"https"),yi(n)),function(t,e){var n=new Ir;if(Fe.Image){var r=new Image;r.onload=Ge($i,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Ge($i,n,r,"TestLoadImage: error",!1,e),r.onabort=Ge($i,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Ge($i,n,r,"TestLoadImage: timeout",!1,e),Fe.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Cr(2);t.G=0,t.j&&t.j.va(e),Co(t),go(t)}function Co(t){t.G=0,t.I=-1,t.j&&(0==qi(t.i).length&&0==t.l.length||(t.i.i.length=0,Ze(t.l),t.l.length=0),t.j.ua())}function xo(t,e,n){var r=function(t){return t instanceof li?hi(t):new li(t,void 0)}(n);if(""!=r.i)e&&di(r,e+"."+r.i),pi(r,r.m);else{var i=Fe.location;r=function(t,e,n,r){var i=new li(null,void 0);return t&&fi(i,t),e&&di(i,e),n&&pi(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&un(t.aa,(function(t,e){gi(r,e,t)})),e=t.D,n=t.sa,e&&n&&gi(r,e,n),gi(r,"VER",t.ma),wo(t,r),r}function Ro(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new Ji(new Ki({ib:!0})):new Ji(t.qa)).L=t.H,e}function Oo(){}function Lo(){if(gn&&!(10<=Number(Dn)))throw Error("Environmental error: no available transport.")}function Po(t,e){Zn.call(this),this.g=new fo(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!tn(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!tn(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Vo(this)}function Mo(t){qr.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Fo(){jr.call(this),this.status=1}function Vo(t){this.g=t}(Le=Ji.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Vr.g(),this.C=this.u?Mr(this.u):Mr(Vr),this.g.onreadystatechange=Ke(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void ro(this,t)}t=n||"";var i=new si(this.headers);r&&oi(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=no,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=Fe.FormData&&t instanceof Fe.FormData,!(0<=Ye(eo,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{ao(this),0<this.B&&((this.K=function(t){return gn&&kn()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ke(this.pa,this)):this.A=vr(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){ro(this,t)}},Le.pa=function(){void 0!==Me&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,tr(this,"timeout"),this.abort(8))},Le.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,tr(this,"complete"),tr(this,"abort"),so(this))},Le.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),so(this,!0)),Ji.Z.M.call(this)},Le.Fa=function(){this.s||(this.F||this.v||this.l?oo(this):this.cb())},Le.cb=function(){oo(this)},Le.ba=function(){try{return 2<uo(this)?this.g.status:-1}catch(t){return-1}},Le.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Le.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Xi(e)}},Le.Da=function(){return this.m},Le.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(Le=fo.prototype).ma=8,Le.G=1,Le.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},Le.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new zr(this,this.h,t,void 0),n=this.s;if(this.P&&(n?hn(n=cn(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=Eo(this,e,r),gi(i=hi(this.F),"RID",t),gi(i,"CVER",22),this.D&&gi(i,"X-HTTP-Session-Id",this.D),wo(this,i),this.o&&n&&lo(i,this.o,n),Vi(this.i,e),this.Ra&&gi(i,"TYPE","init"),this.ja?(gi(i,"$req",r),gi(i,"SID","null"),e.$=!0,Qr(e,i,null)):Qr(e,i,r),this.G=2}}else 3==this.G&&(t?bo(this,t):0==this.l.length||Pi(this.i)||bo(this))},Le.Ga=function(){if(this.u=null,So(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Rr(Ke(this.bb,this),t)}},Le.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Cr(10),vo(this),So(this))},Le.ab=function(){null!=this.v&&(this.v=null,vo(this),_o(this),Cr(19))},Le.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Cr(2)):(this.h.info("Failed to ping google.com"),Cr(1))},(Le=Oo.prototype).xa=function(){},Le.wa=function(){},Le.va=function(){},Le.ua=function(){},Le.Oa=function(){},Lo.prototype.g=function(t,e){return new Po(t,e)},He(Po,Zn),Po.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),cr(Ke(t.hb,t,e))),Cr(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=xo(t,null,t.W),mo(t)},Po.prototype.close=function(){po(this.g)},Po.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,yo(this.g,e)}else this.v?((e={}).__data__=nr(t),yo(this.g,e)):yo(this.g,t)},Po.prototype.M=function(){this.g.j=null,delete this.j,po(this.g),delete this.g,Po.Z.M.call(this)},He(Mo,qr),He(Fo,jr),He(Vo,Oo),Vo.prototype.xa=function(){tr(this.g,"a")},Vo.prototype.wa=function(t){tr(this.g,new Mo(t))},Vo.prototype.va=function(t){tr(this.g,new Fo(t))},Vo.prototype.ua=function(){tr(this.g,"b")},Lo.prototype.createWebChannel=Lo.prototype.g,Po.prototype.send=Po.prototype.u,Po.prototype.open=Po.prototype.m,Po.prototype.close=Po.prototype.close,Or.NO_ERROR=0,Or.TIMEOUT=8,Or.HTTP_ERROR=6,Lr.COMPLETE="complete",Fr.EventType=Ur,Ur.OPEN="a",Ur.CLOSE="b",Ur.ERROR="c",Ur.MESSAGE="d",Zn.prototype.listen=Zn.prototype.N,Ji.prototype.listenOnce=Ji.prototype.O,Ji.prototype.getLastError=Ji.prototype.La,Ji.prototype.getLastErrorCode=Ji.prototype.Da,Ji.prototype.getStatus=Ji.prototype.ba,Ji.prototype.getResponseJson=Ji.prototype.Qa,Ji.prototype.getResponseText=Ji.prototype.ga,Ji.prototype.send=Ji.prototype.ea;var Uo=Or,qo=Lr,jo=Tr,Bo=10,zo=11,$o=Ki,Ko=Fr,Go=Ji,Ho=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Ho.o=-1;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Qo={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Wo=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Pt(e,t),e}(Error),Yo=new ve("@firebase/firestore");function Xo(){return Yo.logLevel}function Jo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Yo.logLevel<=ue.DEBUG){var r=e.map(es);Yo.debug.apply(Yo,jt(["Firestore (8.8.0): "+t],r))}}function Zo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Yo.logLevel<=ue.ERROR){var r=e.map(es);Yo.error.apply(Yo,jt(["Firestore (8.8.0): "+t],r))}}function ts(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Yo.logLevel<=ue.WARN){var r=e.map(es);Yo.warn.apply(Yo,jt(["Firestore (8.8.0): "+t],r))}}function es(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ns(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.8.0) INTERNAL ASSERTION FAILED: "+t;throw Zo(e),new Error(e)}function rs(t,e){t||ns()}function is(t,e){return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function os(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ss=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=os(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function as(t,e){return t<e?-1:t>e?1:0}function us(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function cs(t){return t+"\0"}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ls=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Wo(Qo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Wo(Qo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Wo(Qo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Wo(Qo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?as(this.nanoseconds,t.nanoseconds):as(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),hs=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new ls(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function fs(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ds(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ps(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var vs=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&ns(),void 0===n?n=t.length-e:n>t.length-e&&ns(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),gs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pt(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Wo(Qo.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(vs),ys=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ms=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pt(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return ys.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Wo(Qo.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new Wo(Qo.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Wo(Qo.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Wo(Qo.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(vs),bs=function(){function t(t){this.fields=t,t.sort(ms.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return us(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),ws=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return as(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();ws.EMPTY_BYTE_STRING=new ws("");var Es=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Is(t){if(rs(!!t),"string"==typeof t){var e=0,n=Es.exec(t);if(rs(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:_s(t.seconds),nanos:_s(t.nanos)}}function _s(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ts(t){return"string"==typeof t?ws.fromBase64String(t):ws.fromUint8Array(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ss(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function As(t){var e=t.mapValue.fields.__previous_value__;return Ss(e)?As(e):e}function ks(t){var e=Is(t.mapValue.fields.__local_write_time__.timestampValue);return new ls(e.seconds,e.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ns(t){return null==t}function Ds(t){return 0===t&&1/t==-1/0}function Cs(t){return"number"==typeof t&&Number.isInteger(t)&&!Ds(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var xs=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(gs.fromString(e))},t.fromName=function(e){return new t(gs.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===gs.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return gs.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new gs(e.slice()))},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Rs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ss(t)?4:10:ns()}function Os(t,e){var n=Rs(t);if(n!==Rs(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ks(t).isEqual(ks(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Is(t.timestampValue),r=Is(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Ts(t.bytesValue).isEqual(Ts(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return _s(t.geoPointValue.latitude)===_s(e.geoPointValue.latitude)&&_s(t.geoPointValue.longitude)===_s(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return _s(t.integerValue)===_s(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=_s(t.doubleValue),r=_s(e.doubleValue);return n===r?Ds(n)===Ds(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return us(t.arrayValue.values||[],e.arrayValue.values||[],Os);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(fs(n)!==fs(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Os(n[i],r[i])))return!1;return!0}(t,e);default:return ns()}}function Ls(t,e){return void 0!==(t.values||[]).find((function(t){return Os(t,e)}))}function Ps(t,e){var n=Rs(t),r=Rs(e);if(n!==r)return as(n,r);switch(n){case 0:return 0;case 1:return as(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=_s(t.integerValue||t.doubleValue),r=_s(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Ms(t.timestampValue,e.timestampValue);case 4:return Ms(ks(t),ks(e));case 5:return as(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Ts(t),r=Ts(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=as(n[i],r[i]);if(0!==o)return o}return as(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=as(_s(t.latitude),_s(e.latitude));return 0!==n?n:as(_s(t.longitude),_s(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ps(n[i],r[i]);if(o)return o}return as(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=as(r[s],o[s]);if(0!==a)return a;var u=Ps(n[r[s]],i[o[s]]);if(0!==u)return u}return as(r.length,o.length)}(t.mapValue,e.mapValue);default:throw ns()}}function Ms(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return as(t,e);var n=Is(t),r=Is(e),i=as(n.seconds,r.seconds);return 0!==i?i:as(n.nanos,r.nanos)}function Fs(t){return Vs(t)}function Vs(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Is(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Ts(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,xs.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Vs(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Vs(t.fields[o])}return e+"}"}(t.mapValue):ns();var e,n}function Us(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function qs(t){return!!t&&"integerValue"in t}function js(t){return!!t&&"arrayValue"in t}function Bs(t){return!!t&&"nullValue"in t}function zs(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $s(t){return!!t&&"mapValue"in t}function Ks(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return ds(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=Ks(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Ks(t.arrayValue.values[r]);return n}return Object.assign({},t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Gs=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!$s(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ks(e)},t.prototype.setAll=function(t){var e=this,n=ms.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Ks(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());$s(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return Os(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];$s(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){ds(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(Ks(this.value))},t}();function Hs(t){var e=[];return ds(t.fields,(function(t,n){var r=new ms([t]);if($s(n)){var i=Hs(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new bs(e)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Qs=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,hs.min(),Gs.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Gs.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Gs.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Gs.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Gs.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Ws=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ys(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Ws(t,e,n,r,i,o,s)}function Xs(t){var e=is(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Fs(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),Ns(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=la(e.startAt)),e.endAt&&(n+="|ub:",n+=la(e.endAt)),e.h=n}return e.h}function Js(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!fa(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!Os(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!pa(t.startAt,e.startAt)&&pa(t.endAt,e.endAt)}function Zs(t){return xs.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var ta=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Pt(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new ea(t,n,r):"array-contains"===n?new oa(t,r):"in"===n?new sa(t,r):"not-in"===n?new aa(t,r):"array-contains-any"===n?new ua(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new na(t,n):new ra(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Ps(e,this.value)):null!==e&&Rs(this.value)===Rs(e)&&this.m(Ps(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ns()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),ea=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=xs.fromName(r.referenceValue),i}return Pt(e,t),e.prototype.matches=function(t){var e=xs.comparator(t.key,this.key);return this.m(e)},e}(ta),na=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=ia("in",n),r}return Pt(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(ta),ra=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=ia("not-in",n),r}return Pt(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(ta);function ia(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return xs.fromName(t.referenceValue)}))}var oa=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Pt(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return js(e)&&Ls(e.arrayValue,this.value)},e}(ta),sa=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Pt(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Ls(this.value.arrayValue,e)},e}(ta),aa=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Pt(e,t),e.prototype.matches=function(t){if(Ls(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Ls(this.value.arrayValue,e)},e}(ta),ua=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Pt(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!js(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Ls(e.value.arrayValue,t)}))},e}(ta),ca=function(t,e){this.position=t,this.before=e};function la(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Fs(t)})).join(",")}var ha=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function fa(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function da(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?xs.comparator(xs.fromName(s.referenceValue),n.key):Ps(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function pa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Os(t.position[n],e.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var va=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function ga(t,e,n,r,i,o,s,a){return new va(t,e,n,r,i,o,s,a)}function ya(t){return new va(t)}function ma(t){return!Ns(t.limit)&&"F"===t.limitType}function ba(t){return!Ns(t.limit)&&"L"===t.limitType}function wa(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Ea(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Ia(t){return null!==t.collectionGroup}function _a(t){var e=is(t);if(null===e.p){e.p=[];var n=Ea(e),r=wa(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new ha(n)),e.p.push(new ha(ms.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new ha(ms.keyField(),u))}}}return e.p}function Ta(t){var e=is(t);if(!e.T)if("F"===e.limitType)e.T=Ys(e.path,e.collectionGroup,_a(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=_a(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ha(o.field,s))}var a=e.endAt?new ca(e.endAt.position,!e.endAt.before):null,u=e.startAt?new ca(e.startAt.position,!e.startAt.before):null;e.T=Ys(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function Sa(t,e,n){return new va(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Aa(t,e){return Js(Ta(t),Ta(e))&&t.limitType===e.limitType}function ka(t){return Xs(Ta(t))+"|lt:"+t.limitType}function Na(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Fs(e.value);var e})).join(", ")+"]"),Ns(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+la(t.startAt)),t.endAt&&(e+=", endAt: "+la(t.endAt)),"Target("+e+")"}(Ta(t))+"; limitType="+t.limitType+")"}function Da(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):xs.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!da(t.startAt,_a(t),e)||t.endAt&&da(t.endAt,_a(t),e))}(t,e)}function Ca(t){return function(e,n){for(var r=!1,i=0,o=_a(t);i<o.length;i++){var s=o[i],a=xa(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function xa(t,e,n){var r=t.field.isKeyField()?xs.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Ps(r,i):ns()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ns()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ra(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ds(e)?"-0":e}}function Oa(t){return{integerValue:""+t}}function La(t,e){return Cs(e)?Oa(e):Ra(t,e)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Pa=function(){this._=void 0};function Ma(t,e,n){return t instanceof Ua?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof qa?ja(t,e):t instanceof Ba?za(t,e):function(t,e){var n=Va(t,e),r=Ka(n)+Ka(t.A);return qs(n)&&qs(t.A)?Oa(r):Ra(t.R,r)}(t,e)}function Fa(t,e,n){return t instanceof qa?ja(t,e):t instanceof Ba?za(t,e):n}function Va(t,e){return t instanceof $a?qs(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Ua=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pt(e,t),e}(Pa),qa=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Pt(e,t),e}(Pa);function ja(t,e){for(var n=Ga(e),r=function(t){n.some((function(e){return Os(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ba=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Pt(e,t),e}(Pa);function za(t,e){for(var n=Ga(e),r=function(t){n=n.filter((function(e){return!Os(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var $a=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return Pt(e,t),e}(Pa);function Ka(t){return _s(t.integerValue||t.doubleValue)}function Ga(t){return js(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ha=function(t,e){this.field=t,this.transform=e},Qa=function(t,e){this.version=t,this.transformResults=e},Wa=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Ya(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Xa=function(){};function Ja(t,e,n){t instanceof ru?function(t,e,n){var r=t.value.clone(),i=su(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof iu?function(t,e,n){if(Ya(t.precondition,e)){var r=su(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(ou(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Za(t,e,n){t instanceof ru?function(t,e,n){if(Ya(t.precondition,e)){var r=t.value.clone(),i=au(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(nu(e),r).setHasLocalMutations()}}(t,e,n):t instanceof iu?function(t,e,n){if(Ya(t.precondition,e)){var r=au(t.fieldTransforms,n,e),i=e.data;i.setAll(ou(t)),i.setAll(r),e.convertToFoundDocument(nu(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){Ya(t.precondition,e)&&e.convertToNoDocument(hs.min())}(t,e)}function tu(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=Va(o.transform,s||null);null!=a&&(null==n&&(n=Gs.empty()),n.set(o.field,a))}return n||null}function eu(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&us(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof qa&&e instanceof qa||t instanceof Ba&&e instanceof Ba?us(t.elements,e.elements,Os):t instanceof $a&&e instanceof $a?Os(t.A,e.A):t instanceof Ua&&e instanceof Ua}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function nu(t){return t.isFoundDocument()?t.version:hs.min()}var ru=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Pt(e,t),e}(Xa),iu=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return Pt(e,t),e}(Xa);function ou(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function su(t,e,n){var r=new Map;rs(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,Fa(s,a,n[i]))}return r}function au(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,Ma(a,u,e))}return r}var uu,cu,lu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Pt(e,t),e}(Xa),hu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Pt(e,t),e}(Xa),fu=function(t){this.count=t};function du(t){switch(t){case Qo.OK:return ns();case Qo.CANCELLED:case Qo.UNKNOWN:case Qo.DEADLINE_EXCEEDED:case Qo.RESOURCE_EXHAUSTED:case Qo.INTERNAL:case Qo.UNAVAILABLE:case Qo.UNAUTHENTICATED:return!1;case Qo.INVALID_ARGUMENT:case Qo.NOT_FOUND:case Qo.ALREADY_EXISTS:case Qo.PERMISSION_DENIED:case Qo.FAILED_PRECONDITION:case Qo.ABORTED:case Qo.OUT_OF_RANGE:case Qo.UNIMPLEMENTED:case Qo.DATA_LOSS:return!0;default:return ns()}}function pu(t){if(void 0===t)return Zo("GRPC error has no .code"),Qo.UNKNOWN;switch(t){case uu.OK:return Qo.OK;case uu.CANCELLED:return Qo.CANCELLED;case uu.UNKNOWN:return Qo.UNKNOWN;case uu.DEADLINE_EXCEEDED:return Qo.DEADLINE_EXCEEDED;case uu.RESOURCE_EXHAUSTED:return Qo.RESOURCE_EXHAUSTED;case uu.INTERNAL:return Qo.INTERNAL;case uu.UNAVAILABLE:return Qo.UNAVAILABLE;case uu.UNAUTHENTICATED:return Qo.UNAUTHENTICATED;case uu.INVALID_ARGUMENT:return Qo.INVALID_ARGUMENT;case uu.NOT_FOUND:return Qo.NOT_FOUND;case uu.ALREADY_EXISTS:return Qo.ALREADY_EXISTS;case uu.PERMISSION_DENIED:return Qo.PERMISSION_DENIED;case uu.FAILED_PRECONDITION:return Qo.FAILED_PRECONDITION;case uu.ABORTED:return Qo.ABORTED;case uu.OUT_OF_RANGE:return Qo.OUT_OF_RANGE;case uu.UNIMPLEMENTED:return Qo.UNIMPLEMENTED;case uu.DATA_LOSS:return Qo.DATA_LOSS;default:return ns()}}(cu=uu||(uu={}))[cu.OK=0]="OK",cu[cu.CANCELLED=1]="CANCELLED",cu[cu.UNKNOWN=2]="UNKNOWN",cu[cu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",cu[cu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",cu[cu.NOT_FOUND=5]="NOT_FOUND",cu[cu.ALREADY_EXISTS=6]="ALREADY_EXISTS",cu[cu.PERMISSION_DENIED=7]="PERMISSION_DENIED",cu[cu.UNAUTHENTICATED=16]="UNAUTHENTICATED",cu[cu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",cu[cu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",cu[cu.ABORTED=10]="ABORTED",cu[cu.OUT_OF_RANGE=11]="OUT_OF_RANGE",cu[cu.UNIMPLEMENTED=12]="UNIMPLEMENTED",cu[cu.INTERNAL=13]="INTERNAL",cu[cu.UNAVAILABLE=14]="UNAVAILABLE",cu[cu.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var vu=function(){function t(t,e){this.comparator=t,this.root=e||yu.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,yu.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yu.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new gu(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new gu(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new gu(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new gu(this.root,t,this.comparator,!0)},t}(),gu=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),yu=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw ns();if(this.right.isRed())throw ns();var t=this.left.check();if(t!==this.right.check())throw ns();return t+(this.isRed()?0:1)},t}();yu.EMPTY=null,yu.RED=!0,yu.BLACK=!1,yu.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw ns()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw ns()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw ns()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw ns()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw ns()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new yu(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var mu=function(){function t(t){this.comparator=t,this.data=new vu(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new bu(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new bu(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),bu=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),wu=new vu(xs.comparator);function Eu(){return wu}var Iu=new vu(xs.comparator);function _u(){return Iu}var Tu=new vu(xs.comparator);var Su=new mu(xs.comparator);function Au(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Su,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var ku=new mu(as);function Nu(){return ku}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Du=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Cu.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(hs.min(),r,Nu(),Eu(),Au())},t}(),Cu=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(ws.EMPTY_BYTE_STRING,n,Au(),Au(),Au())},t}(),xu=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Ru=function(t,e){this.targetId=t,this.V=e},Ou=function(t,e,n,r){void 0===n&&(n=ws.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Lu=function(){function t(){this.S=0,this.D=Fu(),this.C=ws.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=Au(),e=Au(),n=Au();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:ns()}})),new Cu(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=Fu()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),Pu=function(){function t(t){this.W=t,this.G=new Map,this.H=Eu(),this.J=Mu(),this.Y=new mu(as)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:ns()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Zs(i))if(0===n){var o=new xs(i.path);this.tt(e,o,Qs.newNoDocument(o,hs.min()))}else rs(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&Zs(o.target)){var s=new xs(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,Qs.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=Au();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Du(t,n,this.Y,this.H,r);return this.H=Eu(),this.J=Mu(),this.Y=new mu(as),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Lu,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new mu(as),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Jo("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Lu),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Mu(){return new vu(xs.comparator)}function Fu(){return new vu(xs.comparator)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Vu={asc:"ASCENDING",desc:"DESCENDING"},Uu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},qu=function(t,e){this.databaseId=t,this.I=e};function ju(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Bu(t,e){return t.I?e.toBase64():e.toUint8Array()}function zu(t,e){return ju(t,e.toTimestamp())}function $u(t){return rs(!!t),hs.fromTimestamp(function(t){var e=Is(t);return new ls(e.seconds,e.nanos)}(t))}function Ku(t,e){return function(t){return new gs(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Gu(t){var e=gs.fromString(t);return rs(vc(e)),e}function Hu(t,e){return Ku(t.databaseId,e.path)}function Qu(t,e){var n=Gu(e);if(n.get(1)!==t.databaseId.projectId)throw new Wo(Qo.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Wo(Qo.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new xs(Ju(n))}function Wu(t,e){return Ku(t.databaseId,e)}function Yu(t){var e=Gu(t);return 4===e.length?gs.emptyPath():Ju(e)}function Xu(t){return new gs(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ju(t){return rs(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Zu(t,e,n){return{name:Hu(t,e),fields:n.value.mapValue.fields}}function tc(t,e){var n;if(e instanceof ru)n={update:Zu(t,e.key,e.value)};else if(e instanceof lu)n={delete:Hu(t,e.key)};else if(e instanceof iu)n={update:Zu(t,e.key,e.data),updateMask:pc(e.fieldMask)};else{if(!(e instanceof hu))return ns();n={verify:Hu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Ua)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof qa)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ba)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof $a)return{fieldPath:e.field.canonicalString(),increment:n.A};throw ns()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:zu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:ns()}(t,e.precondition)),n}function ec(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Wa.updateTime($u(t.updateTime)):void 0!==t.exists?Wa.exists(t.exists):Wa.none()}(e.currentDocument):Wa.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)rs("REQUEST_TIME"===e.setToServerValue),n=new Ua;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new qa(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Ba(i)}else"increment"in e?n=new $a(t,e.increment):ns();var o=ms.fromServerFormat(e.fieldPath);return new Ha(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=Qu(t,e.update.name),o=new Gs({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new bs(e.map((function(t){return ms.fromServerFormat(t)})))}(e.updateMask);return new iu(i,o,s,n,r)}return new ru(i,o,n,r)}if(e.delete){var a=Qu(t,e.delete);return new lu(a,n)}if(e.verify){var u=Qu(t,e.verify);return new hu(u,n)}return ns()}function nc(t,e){return{documents:[Wu(t,e.path)]}}function rc(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Wu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Wu(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(zs(t.value))return{unaryFilter:{field:lc(t.field),op:"IS_NAN"}};if(Bs(t.value))return{unaryFilter:{field:lc(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(zs(t.value))return{unaryFilter:{field:lc(t.field),op:"IS_NOT_NAN"}};if(Bs(t.value))return{unaryFilter:{field:lc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lc(t.field),op:cc(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:lc(t.field),direction:uc(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||Ns(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=sc(e.startAt)),e.endAt&&(n.structuredQuery.endAt=sc(e.endAt)),n}function ic(t){var e=Yu(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){rs(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=oc(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new ha(hc(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return Ns(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=ac(n.startAt));var l=null;return n.endAt&&(l=ac(n.endAt)),ga(e,i,a,s,u,"F",c,l)}function oc(t){return t?void 0!==t.unaryFilter?[dc(t)]:void 0!==t.fieldFilter?[fc(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return oc(t)})).reduce((function(t,e){return t.concat(e)})):ns():[]}function sc(t){return{before:t.before,values:t.position}}function ac(t){var e=!!t.before,n=t.values||[];return new ca(n,e)}function uc(t){return Vu[t]}function cc(t){return Uu[t]}function lc(t){return{fieldPath:t.canonicalString()}}function hc(t){return ms.fromServerFormat(t.fieldPath)}function fc(t){return ta.create(hc(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return ns()}}(t.fieldFilter.op),t.fieldFilter.value)}function dc(t){switch(t.unaryFilter.op){case"IS_NAN":var e=hc(t.unaryFilter.field);return ta.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=hc(t.unaryFilter.field);return ta.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=hc(t.unaryFilter.field);return ta.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=hc(t.unaryFilter.field);return ta.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return ns()}}function pc(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function vc(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function gc(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=mc(e)),e=yc(t.get(n),e);return mc(e)}function yc(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function mc(t){return t+""}function bc(t){var e=t.length;if(rs(e>=2),2===e)return rs(""===t.charAt(0)&&""===t.charAt(1)),gs.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&ns(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:ns()}o=s+2}return new gs(r)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var wc=function(t,e){this.seconds=t,this.nanoseconds=e},Ec=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Ec.store="owner",Ec.key="owner";var Ic=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ic.store="mutationQueues",Ic.keyPath="userId";var _c=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};_c.store="mutations",_c.keyPath="batchId",_c.userMutationsIndex="userMutationsIndex",_c.userMutationsKeyPath=["userId","batchId"];var Tc=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,gc(e)]},t.key=function(t,e,n){return[t,gc(e),n]},t}();Tc.store="documentMutations",Tc.PLACEHOLDER=new Tc;var Sc=function(t,e){this.path=t,this.readTime=e},Ac=function(t,e){this.path=t,this.version=e},kc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};kc.store="remoteDocuments",kc.readTimeIndex="readTimeIndex",kc.readTimeIndexPath="readTime",kc.collectionReadTimeIndex="collectionReadTimeIndex",kc.collectionReadTimeIndexPath=["parentPath","readTime"];var Nc=function(t){this.byteSize=t};Nc.store="remoteDocumentGlobal",Nc.key="remoteDocumentGlobalKey";var Dc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Dc.store="targets",Dc.keyPath="targetId",Dc.queryTargetsIndexName="queryTargetsIndex",Dc.queryTargetsKeyPath=["canonicalId","targetId"];var Cc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Cc.store="targetDocuments",Cc.keyPath=["targetId","path"],Cc.documentTargetsIndex="documentTargetsIndex",Cc.documentTargetsKeyPath=["path","targetId"];var xc=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};xc.key="targetGlobalKey",xc.store="targetGlobal";var Rc=function(t,e){this.collectionId=t,this.parent=e};Rc.store="collectionParents",Rc.keyPath=["collectionId","parent"];var Oc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Oc.store="clientMetadata",Oc.keyPath="clientId";var Lc=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Lc.store="bundles",Lc.keyPath="bundleId";var Pc=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Pc.store="namedQueries",Pc.keyPath="name";var Mc=jt(jt([],jt(jt([],jt(jt([],jt(jt([],[Ic.store,_c.store,Tc.store,kc.store,Dc.store,Ec.store,xc.store,Cc.store]),[Oc.store])),[Nc.store])),[Rc.store])),[Lc.store,Pc.store]),Fc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Vc=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),Uc=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},qc=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&ns(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),jc=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Uc,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new $c(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Wc(e.target.error);n.ft.reject(new $c(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new $c(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Jo("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Gc(e)},t}(),Bc=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Kt())&&Zo("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Jo("SimpleDb","Removing database:",t),Hc(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Kt(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Ft(this,void 0,void 0,(function(){var e,n=this;return Vt(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(Jo("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new $c(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Wo(Qo.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new $c(t,n))},i.onupgradeneeded=function(t){Jo("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){Jo("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Ft(this,void 0,void 0,(function(){var i,o,s,a,u;return Vt(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,l;return Vt(this,(function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=h.sent(),e=jc.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),qc.reject(t)})).toPromise(),u={},s.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(h.sent(),s),u)];case 4:return c=h.sent(),l="FirebaseError"!==c.name&&o<3,Jo("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),a.close(),l?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),zc=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Hc(this.Pt.delete())},t}(),$c=function(t){function e(e,n){var r=this;return(r=t.call(this,Qo.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Pt(e,t),e}(Wo);function Kc(t){return"IndexedDbTransactionError"===t.name}var Gc=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Jo("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Jo("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Hc(n)},t.prototype.add=function(t){return Jo("SimpleDb","ADD",this.store.name,t,t),Hc(this.store.add(t))},t.prototype.get=function(t){var e=this;return Hc(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Jo("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return Jo("SimpleDb","DELETE",this.store.name,t),Hc(this.store.delete(t))},t.prototype.count=function(){return Jo("SimpleDb","COUNT",this.store.name),Hc(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){Jo("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new qc((function(n,r){e.onerror=function(t){var e=Wc(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new qc((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new zc(i),s=e(i.primaryKey,i.value,o);if(s instanceof qc){var a=s.catch((function(t){return o.done(),qc.reject(t)}));n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return qc.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Hc(t){return new qc((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Wc(t.target.error);n(e)}}))}var Qc=!1;function Wc(t){var e=Bc._t(Kt());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Wo("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Qc||(Qc=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Yc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return Pt(e,t),e}(Vc);function Xc(t,e){var n=is(t);return Bc.It(n.Mt,e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Jc=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Ja(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Za(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Za(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(hs.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Au())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&us(this.mutations,t.mutations,(function(t,e){return eu(t,e)}))&&us(this.baseMutations,t.baseMutations,(function(t,e){return eu(t,e)}))},t}(),Zc=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){rs(e.mutations.length===r.length);for(var i=Tu,o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),tl=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=hs.min()),void 0===o&&(o=hs.min()),void 0===s&&(s=ws.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),el=function(t){this.Lt=t};function nl(t,e){if(e.document)return function(t,e,n){var r=Qu(t,e.name),i=$u(e.updateTime),o=new Gs({mapValue:{fields:e.fields}}),s=Qs.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=xs.fromSegments(e.noDocument.path),r=al(e.noDocument.readTime),i=Qs.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=xs.fromSegments(e.unknownDocument.path);return r=al(e.unknownDocument.version),Qs.newUnknownDocument(o,r)}return ns()}function rl(t,e,n){var r=il(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Hu(t,e.key),fields:e.data.value.mapValue.fields,updateTime:ju(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new kc(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=sl(e.version);return s=e.hasCommittedMutations,new kc(null,new Sc(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),l=sl(e.version);return new kc(new Ac(c,l),null,null,!0,r,i)}return ns()}function il(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ol(t){var e=new ls(t[0],t[1]);return hs.fromTimestamp(e)}function sl(t){var e=t.toTimestamp();return new wc(e.seconds,e.nanoseconds)}function al(t){var e=new ls(t.seconds,t.nanoseconds);return hs.fromTimestamp(e)}function ul(t,e){for(var n=(e.baseMutations||[]).map((function(e){return ec(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return ec(t.Lt,e)})),a=ls.fromMillis(e.localWriteTimeMs);return new Jc(e.batchId,a,n,s)}function cl(t){var e,n,r=al(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?al(t.lastLimboFreeSnapshotVersion):hs.min();return void 0!==t.query.documents?(rs(1===(n=t.query).documents.length),e=Ta(ya(Yu(n.documents[0])))):e=function(t){return Ta(ic(t))}(t.query),new tl(e,t.targetId,0,t.lastListenSequenceNumber,r,i,ws.fromBase64String(t.resumeToken))}function ll(t,e){var n,r=sl(e.snapshotVersion),i=sl(e.lastLimboFreeSnapshotVersion);n=Zs(e.target)?nc(t.Lt,e.target):rc(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Dc(e.targetId,Xs(e.target),r,o,e.sequenceNumber,i,n)}function hl(t){var e=ic({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Sa(e,e.limit,"L"):e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var fl=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return dl(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:al(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return dl(t).put({bundleId:(n=e).id,createTime:sl($u(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return pl(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:hl(e.bundledQuery),readTime:al(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return pl(t).put(function(t){return{name:t.name,readTime:sl($u(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function dl(t){return Xc(t,Lc.store)}function pl(t){return Xc(t,Pc.store)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var vl=function(){function t(){this.Bt=new gl}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),qc.resolve()},t.prototype.getCollectionParents=function(t,e){return qc.resolve(this.Bt.getEntries(e))},t}(),gl=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new mu(gs.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new mu(gs.comparator)).toArray()},t}(),yl=function(){function t(){this.qt=new gl}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:gc(i)};return ml(t).put(o)}return qc.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[cs(e),""],!1,!0);return ml(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(bc(o.parent))}return n}))},t}();function ml(t){return Xc(t,Rc.store)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var bl={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},wl=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function El(t,e,n){var r=t.store(_c.store),i=t.store(Tc.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){rs(1===a)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],d=Tc.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return qc.waitFor(o).next((function(){return c}))}function Il(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ns();e=t.noDocument}return JSON.stringify(e).length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */wl.DEFAULT_COLLECTION_PERCENTILE=10,wl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wl.DEFAULT=new wl(41943040,wl.DEFAULT_COLLECTION_PERCENTILE,wl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wl.DISABLED=new wl(-1,0,0);var _l=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return rs(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Sl(t).$t({index:_c.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Al(t),s=Sl(t);return s.add({}).next((function(a){rs("number"==typeof a);for(var u=new Jc(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return tc(t.Lt,e)})),i=n.mutations.map((function(e){return tc(t.Lt,e)}));return new _c(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),l=[],h=new mu((function(t,e){return as(t.canonicalString(),e.canonicalString())})),f=0,d=r;f<d.length;f++){var p=d[f],v=Tc.key(i.userId,p.key.path,a);h=h.add(p.key.path.popLast()),l.push(s.put(c)),l.push(o.put(v,Tc.PLACEHOLDER))}return h.forEach((function(e){l.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[a]=u.keys()})),qc.waitFor(l).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Sl(t).get(e).next((function(t){return t?(rs(t.userId===n.userId),ul(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?qc.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Sl(t).$t({index:_c.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(rs(e.batchId>=r),o=ul(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Sl(t).$t({index:_c.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Sl(t).Nt(_c.userMutationsIndex,n).next((function(t){return t.map((function(t){return ul(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Tc.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Al(t).$t({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],l=bc(u);if(a===n.userId&&e.path.isEqual(l))return Sl(t).get(c).next((function(t){if(!t)throw ns();rs(t.userId===n.userId),o.push(ul(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new mu(as),i=[];return e.forEach((function(e){var o=Tc.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Al(t).$t({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=bc(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),qc.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Tc.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new mu(as);return Al(t).$t({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],l=bc(u);s===n.userId&&r.isPrefixOf(l)?l.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Wt(t,a)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Sl(t).get(e).next((function(t){if(null===t)throw ns();rs(t.userId===n.userId),r.push(ul(n.R,t))})))})),qc.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return El(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),qc.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return qc.resolve();var r=IDBKeyRange.lowerBound(Tc.prefixForUser(e.userId)),i=[];return Al(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=bc(t[1]);i.push(o)}else r.done()})).next((function(){rs(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return Tl(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return kl(t).get(this.userId).next((function(t){return t||new Ic(e.userId,-1,"")}))},t}();function Tl(t,e,n){var r=Tc.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Al(t).$t({range:o,kt:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function Sl(t){return Xc(t,_c.store)}function Al(t){return Xc(t,Tc.store)}function kl(t){return Xc(t,Ic.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Nl=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Dl=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new Nl(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return hs.fromTimestamp(new ls(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Cl(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return rs(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Cl(t).$t((function(s,a){var u=cl(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return qc.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return Cl(t).$t((function(t,n){var r=cl(n);e(r)}))},t.prototype.Xt=function(t){return xl(t).get(xc.key).next((function(t){return rs(null!==t),t}))},t.prototype.Zt=function(t,e){return xl(t).put(xc.key,e)},t.prototype.te=function(t,e){return Cl(t).put(ll(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=Xs(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Cl(t).$t({range:r,index:Dc.queryTargetsIndexName},(function(t,n,r){var o=cl(n);Js(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Rl(t);return e.forEach((function(e){var s=gc(e.path);i.push(o.put(new Cc(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),qc.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Rl(t);return qc.forEach(e,(function(e){var o=gc(e.path);return qc.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Rl(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Rl(t),i=Au();return r.$t({range:n,kt:!0},(function(t,e,n){var r=bc(t[1]),o=new xs(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=gc(e.path),r=IDBKeyRange.bound([n],[cs(n)],!1,!0),i=0;return Rl(t).$t({index:Cc.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return Cl(t).get(e).next((function(t){return t?cl(t):null}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Cl(t){return Xc(t,Dc.store)}function xl(t){return Xc(t,xc.store)}function Rl(t){return Xc(t,Cc.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ol(t){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(e){if(t.code!==Qo.FAILED_PRECONDITION||t.message!==Fc)throw t;return Jo("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ll(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=as(n,i);return 0===s?as(r,o):s}var Pl=function(){function t(t){this.ne=t,this.buffer=new mu(Ll),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Ll(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Ml=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Jo("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return Ft(e,void 0,void 0,(function(){var e;return Vt(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Kc(e=n.sent())?(Jo("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ol(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Fl=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return qc.resolve(Ho.o);var r=new Pl(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Jo("LruGarbageCollector","Garbage collection skipped; disabled"),qc.resolve(bl)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Jo("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),bl):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(Jo("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),Xo()<=ue.DEBUG&&Jo("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-l)+"ms"),qc.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),Vl=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Fl(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return Ul(t,n)},t.prototype.removeReference=function(t,e,n){return Ul(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Ul(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return kl(t).Ot((function(r){return Tl(t,r,e).next((function(t){return t&&(n=!0),qc.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,a){if(a<=e){var u=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),Rl(t).delete([0,gc(s.path)])}))}));i.push(u)}})).next((function(){return qc.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Ul(t,e)},t.prototype.we=function(t,e){var n,r=Rl(t),i=Ho.o;return r.$t({index:Cc.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var s=r.path,a=r.sequenceNumber;0===o?(i!==Ho.o&&e(new xs(bc(n)),i),i=a,n=s):i=Ho.o})).next((function(){i!==Ho.o&&e(new xs(bc(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Ul(t,e){return Rl(t).put(function(t,e){return new Cc(0,gc(t.path),e)}(e,t.currentSequenceNumber))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ql=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){ds(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return ps(this.inner)},t}(),jl=function(){function t(){this.changes=new ql((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:hs.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Qs.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?qc.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Bl=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Kl(t).put(Gl(e),n)},t.prototype.removeEntry=function(t,e){var n=Kl(t),r=Gl(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return Kl(t).get(Gl(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return Kl(t).get(Gl(e)).next((function(t){return{document:n.ye(e,t),size:Il(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=Eu();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=Eu(),i=new vu(xs.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Il(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return qc.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Kl(t).$t({range:r},(function(t,e,r){for(var s=xs.fromSegments(t);o&&xs.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=Eu(),o=e.path.length+1,s={};if(n.isEqual(hs.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=il(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=kc.collectionReadTimeIndex}return Kl(t).$t(s,(function(t,n,s){if(t.length===o){var a=nl(r.R,n);e.path.isPrefixOf(a.key.path)?Da(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new zl(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return $l(t).get(Nc.key).next((function(t){return rs(!!t),t}))},t.prototype.me=function(t,e){return $l(t).put(Nc.key,e)},t.prototype.ye=function(t,e){if(e){var n=nl(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(hs.min()))return n}return Qs.newInvalidDocument(t)},t}(),zl=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new ql((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return Pt(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new mu((function(t,e){return as(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=rl(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Il(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var l=rl(e.Ie.R,Qs.newNoDocument(o,hs.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,l))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),qc.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(jl);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function $l(t){return Xc(t,Nc.store)}function Kl(t){return Xc(t,kc.store)}function Gl(t){return t.path.toArray()}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Hl=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;rs(n<r&&n>=0&&r<=11);var o=new jc("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Ec.store)}(t),function(t){t.createObjectStore(Ic.store,{keyPath:Ic.keyPath}),t.createObjectStore(_c.store,{keyPath:_c.keyPath,autoIncrement:!0}).createIndex(_c.userMutationsIndex,_c.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Tc.store)}(t),Ql(t),function(t){t.createObjectStore(kc.store)}(t));var s=qc.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Cc.store),t.deleteObjectStore(Dc.store),t.deleteObjectStore(xc.store)}(t),Ql(t)),s=s.next((function(){return function(t){var e=t.store(xc.store),n=new xc(0,0,hs.min().toTimestamp(),0);return e.put(xc.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(_c.store).Nt().next((function(n){t.deleteObjectStore(_c.store),t.createObjectStore(_c.store,{keyPath:_c.keyPath,autoIncrement:!0}).createIndex(_c.userMutationsIndex,_c.userMutationsKeyPath,{unique:!0});var r=e.store(_c.store),i=n.map((function(t){return r.put(t)}));return qc.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Oc.store,{keyPath:Oc.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Nc.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(kc.store);e.createIndex(kc.readTimeIndex,kc.readTimeIndexPath,{unique:!1}),e.createIndex(kc.collectionReadTimeIndex,kc.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Lc.store,{keyPath:Lc.keyPath})}(t),function(t){t.createObjectStore(Pc.store,{keyPath:Pc.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(kc.store).$t((function(t,n){e+=Il(n)})).next((function(){var n=new Nc(e);return t.store(Nc.store).put(Nc.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(Ic.store),r=t.store(_c.store);return n.Nt().next((function(n){return qc.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(_c.userMutationsIndex,i).next((function(r){return qc.forEach(r,(function(r){rs(r.userId===n.userId);var i=ul(e.R,r);return El(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(Cc.store),n=t.store(kc.store);return t.store(xc.store).get(xc.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new gs(n),s=function(t){return[0,gc(t)]}(o);r.push(e.get(s).next((function(n){return n?qc.resolve():function(n){return e.put(new Cc(0,gc(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return qc.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(Rc.store,{keyPath:Rc.keyPath});var n=e.store(Rc.store),r=new gl,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:gc(i)})}};return e.store(kc.store).$t({kt:!0},(function(t,e){var n=new gs(t);return i(n.popLast())})).next((function(){return e.store(Tc.store).$t({kt:!0},(function(t,e){t[0];var n=t[1];t[2];var r=bc(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(Dc.store);return n.$t((function(t,r){var i=cl(r),o=ll(e.R,i);return n.put(o)}))},t}();function Ql(t){t.createObjectStore(Cc.store,{keyPath:Cc.keyPath}).createIndex(Cc.documentTargetsIndex,Cc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Dc.store,{keyPath:Dc.keyPath}).createIndex(Dc.queryTargetsIndexName,Dc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(xc.store)}var Wl="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Yl=function(){function t(e,n,r,i,o,s,a,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=l,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Wo(Qo.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Vl(this,i),this.Le=n+"main",this.R=new el(u),this.Be=new Bc(this.Le,11,new Hl(this.R)),this.qe=new Dl(this.referenceDelegate,this.R),this.Ut=new yl,this.Ue=function(t,e){return new Bl(t,e)}(this.R,this.Ut),this.Ke=new fl,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===l&&Zo("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Wo(Qo.FAILED_PRECONDITION,Wl);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new Ho(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Ft(e,void 0,void 0,(function(){return Vt(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return Ft(e,void 0,void 0,(function(){return Vt(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return Ft(e,void 0,void 0,(function(){return Vt(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Jl(e).put(new Oc(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(Kc(e))return Jo("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Jo("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return Xl(t).get(Ec.key).next((function(t){return qc.resolve(e.tn(t))}))},t.prototype.en=function(t){return Jl(t).delete(this.clientId)},t.prototype.nn=function(){return Ft(this,void 0,void 0,(function(){var t,e,n,r,i=this;return Vt(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Xc(t,Oc.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return qc.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?qc.resolve(!0):Xl(t).get(Ec.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Wo(Qo.FAILED_PRECONDITION,Wl);return!1}}return!(!e.networkEnabled||!e.inForeground)||Jl(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Jo("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return Ft(this,void 0,void 0,(function(){var t=this;return Vt(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Ec.store,Oc.store],(function(e){var n=new Yc(e,Ho.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Jl(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return _l.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Jo("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,Mc,(function(o){return i=new Yc(o,r.Ne?r.Ne.next():Ho.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw Zo("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new Wo(Qo.FAILED_PRECONDITION,Fc);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return Xl(t).get(Ec.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Wo(Qo.FAILED_PRECONDITION,Wl)}))},t.prototype.Ze=function(t){var e=new Ec(this.clientId,this.allowTabSynchronization,Date.now());return Xl(t).put(Ec.key,e)},t.yt=function(){return Bc.yt()},t.prototype.Xe=function(t){var e=this,n=Xl(t);return n.get(Ec.key).next((function(t){return e.tn(t)?(Jo("IndexedDbPersistence","Releasing primary lease."),n.delete(Ec.key)):qc.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Zo("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),!Gt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match("Version/14")&&e.Se.enterRestrictedMode(!0),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return Jo("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Zo("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Zo("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Xl(t){return Xc(t,Ec.store)}function Jl(t){return Xc(t,Oc.store)}function Zl(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var th=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return xs.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):Ia(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new xs(e)).next((function(t){var e=_u();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=_u();return this.Ut.getCollectionParents(t,i).next((function(s){return qc.forEach(s,(function(s){var a=function(t,e){return new va(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,l=r.get(c);null==l&&(l=Qs.newInvalidDocument(c),r=r.insert(c,l)),Za(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){Da(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=Au(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof iu&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),eh=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=Au(),i=Au(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),nh=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(hs.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var s=i.Cn(e,o);return(ma(e)||ba(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(Xo()<=ue.DEBUG&&Jo("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Na(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new mu(Ca(t));return e.forEach((function(e,r){Da(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return Xo()<=ue.DEBUG&&Jo("QueryEngine","Using full collection scan to execute query:",Na(e)),this.Sn.getDocumentsMatchingQuery(t,e,hs.min())},t}(),rh=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new vu(as),this.kn=new ql((function(t){return Xs(t)}),Js),this.$n=hs.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new th(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Fn)}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ih(t,e,n,r){return new rh(t,e,n,r)}function oh(t,e){return Ft(this,void 0,void 0,(function(){var n,r,i,o;return Vt(this,(function(s){switch(s.label){case 0:return n=is(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new th(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=Au(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];s=s.add(f.key)}}for(var d=0,p=e;d<p.length;d++){var v=p[d];r.push(v.batchId);for(var g=0,y=v.mutations;g<y.length;g++){var m=y[g];s=s.add(m.key)}}return i.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function sh(t,e){var n=is(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=qc.resolve();return o.forEach((function(t){s=s.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);rs(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),s.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function ah(t){var e=is(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function uh(t,e){var n=is(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return rs(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}}));var a=Eu();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(function(t,e,n,r,i){var o=Au();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Eu();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(hs.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):Jo("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(hs.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return qc.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,a)})).next((function(){return a}))})).then((function(t){return n.Fn=i,t}))}function ch(t,e){var n=is(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function lh(t,e){var n=is(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,qc.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new tl(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function hh(t,e,n){return Ft(this,void 0,void 0,(function(){var r,i,o,s;return Vt(this,(function(a){switch(a.label){case 0:r=is(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Kc(s=a.sent()))throw s;return Jo("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}}))}))}function fh(t,e,n){var r=is(t),i=hs.min(),o=Au();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=is(t),i=r.kn.get(n);return void 0!==i?qc.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,Ta(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:hs.min(),n?o:Au())})).next((function(t){return{documents:t,Bn:o}}))}))}function dh(t,e){var n=is(t),r=is(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function ph(t){var e=is(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=is(t),i=Eu(),o=il(n),s=Kl(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:kc.readTimeIndex,range:a},(function(t,e){var n=nl(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:ol(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function vh(t){return Ft(this,void 0,void 0,(function(){var e;return Vt(this,(function(n){return[2,(e=is(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Kl(t),n=hs.min();return e.$t({index:kc.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=ol(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var gh=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return qc.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:$u(n.createTime)}),qc.resolve()},t.prototype.getNamedQuery=function(t,e){return qc.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:hl(t.bundledQuery),readTime:$u(t.readTime)}}(e)),qc.resolve()},t}(),yh=function(){function t(){this.Wn=new mu(mh.Gn),this.zn=new mu(mh.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new mh(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new mh(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new xs(new gs([])),r=new mh(n,t),i=new mh(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new xs(new gs([])),n=new mh(e,t),r=new mh(e,t+1),i=Au();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new mh(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),mh=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return xs.comparator(t.key,e.key)||as(t.ns,e.ns)},t.Hn=function(t,e){return as(t.ns,e.ns)||xs.comparator(t.key,e.key)},t}(),bh=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new mu(mh.Gn)}return t.prototype.checkEmpty=function(t){return qc.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new Jc(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new mh(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return qc.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return qc.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return qc.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return qc.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return qc.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new mh(e,0),i=new mh(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),qc.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new mu(as);return e.forEach((function(t){var e=new mh(t,0),i=new mh(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),qc.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;xs.isDocumentKey(i)||(i=i.child(""));var o=new mh(new xs(i),0),s=new mu(as);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),qc.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;rs(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return qc.forEach(e.mutations,(function(i){var o=new mh(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new mh(e,0),r=this.rs.firstAfterOrEqual(n);return qc.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,qc.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),wh=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new vu(xs.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return qc.resolve(n?n.document.clone():Qs.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=Eu();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Qs.newInvalidDocument(t))})),qc.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Eu(),i=new xs(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,l=u.readTime;if(!e.path.isPrefixOf(a.path))break;l.compareTo(n)<=0||Da(e,c)&&(r=r.insert(c.key,c.clone()))}return qc.resolve(r)},t.prototype.fs=function(t,e){return qc.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new Eh(this)},t.prototype.getSize=function(t){return qc.resolve(this.size)},t}(),Eh=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return Pt(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),qc.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(jl),Ih=function(){function t(t){this.persistence=t,this.ds=new ql((function(t){return Xs(t)}),Js),this.lastRemoteSnapshotVersion=hs.min(),this.highestTargetId=0,this.ws=0,this._s=new yh,this.targetCount=0,this.ys=Nl.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),qc.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return qc.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return qc.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),qc.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),qc.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Nl(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,qc.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),qc.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,qc.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),qc.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return qc.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return qc.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),qc.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),qc.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),qc.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return qc.resolve(n)},t.prototype.containsKey=function(t,e){return qc.resolve(this._s.containsKey(e))},t}(),_h=function(){function t(t,e){var n=this;this.gs={},this.Ne=new Ho(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Ih(this),this.Ut=new vl,this.Ue=function(t,e){return new wh(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new el(e),this.Ke=new gh(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new bh(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Jo("MemoryPersistence","Starting transaction:",t);var i=new Th(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return qc.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),Th=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return Pt(e,t),e}(Vc),Sh=function(){function t(t){this.persistence=t,this.As=new yh,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw ns()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),qc.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),qc.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),qc.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return qc.forEach(this.vs,(function(r){var i=xs.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return qc.or([function(){return qc.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),Ah=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function kh(t,e){return"firestore_clients_"+t+"_"+e}function Nh(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Dh(t,e){return"firestore_targets_"+t+"_"+e}Ah.UNAUTHENTICATED=new Ah(null),Ah.GOOGLE_CREDENTIALS=new Ah("google-credentials-uid"),Ah.FIRST_PARTY=new Ah("first-party-uid");var Ch=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Wo(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(Zo("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),xh=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Wo(i.error.code,i.error.message)),o?new t(e,i.state,r):(Zo("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Rh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Nu(),s=0;i&&s<r.activeTargetIds.length;++s)i=Cs(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Zo("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Oh=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Zo("SharedClientState","Failed to parse online state: "+e),null)},t}(),Lh=function(){function t(){this.activeTargetIds=Nu()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Ph=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new vu(as),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=kh(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Lh),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Ft(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,l,h=this;return Vt(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(kh(this.persistenceKey,r)))&&(o=Rh.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)l=c[u],this.Fs(l);return this.$s=[],this.window.addEventListener("pagehide",(function(){return h.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Dh(this.persistenceKey,t));if(n){var r=xh.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Dh(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Jo("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Jo("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Jo("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Jo("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Zo("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return Ft(e,void 0,void 0,(function(){var t,e,r,i,o,s;return Vt(this,(function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=Ho.o;if(null!=t)try{var n=JSON.parse(t);rs("number"==typeof n),e=n}catch(t){Zo("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Ho.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new Ch(this.currentUser,t,e,n),i=Nh(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Nh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=Dh(this.persistenceKey,t),i=new xh(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Rh.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Ch.Vs(new Ah(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return xh.Vs(r,e)},t.prototype.js=function(t){return Oh.Vs(t)},t.prototype.ii=function(t){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Jo("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.hi(s,a).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=Nu();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),Mh=function(){function t(){this.li=new Lh,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Lh,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Fh=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Vh=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Jo("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Jo("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Uh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},qh=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),jh=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return Pt(e,t),e.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var s=new Go;s.listenOnce(qo.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case Uo.NO_ERROR:var e=s.getResponseJson();Jo("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Uo.TIMEOUT:Jo("Connection",'RPC "'+t+'" timed out'),o(new Wo(Qo.DEADLINE_EXCEEDED,"Request time out"));break;case Uo.HTTP_ERROR:var n=s.getStatus();if(Jo("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Qo).indexOf(e)>=0?e:Qo.UNKNOWN}(r.status);o(new Wo(a,r.message))}else o(new Wo(Qo.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Wo(Qo.UNAVAILABLE,"Connection failed."));break;default:ns()}}finally{Jo("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new Lo,o=Ar(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new $o({})),this.Fi(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Kt())||"object"==typeof navigator&&"ReactNative"===navigator.product||Kt().indexOf("Electron/")>=0||function(){var t=Kt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||Kt().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");Jo("Connection","Creating WebChannel: "+a,s);var u=i.createWebChannel(a,s),c=!1,l=!1,h=new qh({Ei:function(t){l?Jo("Connection","Not sending because WebChannel is closed:",t):(c||(Jo("Connection","Opening WebChannel transport."),u.open(),c=!0),Jo("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,Ko.EventType.OPEN,(function(){l||Jo("Connection","WebChannel transport opened.")})),f(u,Ko.EventType.CLOSE,(function(){l||(l=!0,Jo("Connection","WebChannel transport closed"),h.Vi())})),f(u,Ko.EventType.ERROR,(function(t){l||(l=!0,ts("Connection","WebChannel transport errored:",t),h.Vi(new Wo(Qo.UNAVAILABLE,"The operation could not be completed")))})),f(u,Ko.EventType.MESSAGE,(function(t){var e;if(!l){var n=t.data[0];rs(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Jo("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=uu[t];if(void 0!==e)return pu(e)}(o),a=i.message;void 0===s&&(s=Qo.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),l=!0,h.Vi(new Wo(s,a)),u.close()}else Jo("Connection","WebChannel received:",n),h.Si(n)}})),f(o,jo.STAT_EVENT,(function(t){t.stat===Bo?Jo("Connection","Detected buffering proxy"):t.stat===zo&&Jo("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Pi()}),0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Jo("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return Jo("RestConnection","Received: ",t),t}),(function(e){throw ts("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.8.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=Uh[t];return this.Di+"/v1/"+e+":"+n},t}());
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Bh(){return"undefined"!=typeof window?window:null}function zh(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function $h(t){return new qu(t,!0)}var Kh=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&Jo("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Gh=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Kh(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Qo.RESOURCE_EXHAUSTED?(Zo(e.toString()),Zo("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===Qo.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new Wo(Qo.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return Ft(t,void 0,void 0,(function(){return Vt(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return Jo("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(Jo("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Hh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return Pt(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:ns()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(rs(void 0===e||"string"==typeof e),ws.fromBase64String(e||"")):(rs(void 0===e||e instanceof Uint8Array),ws.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Qo.UNKNOWN:pu(t.code);return new Wo(e,t.message||"")}(a);n=new Ou(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=Qu(t,r.document.name),o=$u(r.document.updateTime);var a=new Gs({mapValue:{fields:r.document.fields}}),u=(s=Qs.newFoundDocument(i,o,a),r.targetIds||[]),c=r.removedTargetIds||[];n=new xu(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=Qu(t,r.document),o=r.readTime?$u(r.readTime):hs.min(),a=Qs.newNoDocument(i,o),s=r.removedTargetIds||[],n=new xu([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=Qu(t,r.document),o=r.removedTargetIds||[],n=new xu([],o,i,null);else{if(!("filter"in e))return ns();e.filter;var l=e.filter;l.targetId,r=l.count||0,i=new fu(r),o=l.targetId,n=new Ru(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return hs.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?hs.min():e.readTime?$u(e.readTime):hs.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Xu(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Zs(r)?{documents:nc(t,r)}:{query:rc(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Bu(t,e.resumeToken):e.snapshotVersion.compareTo(hs.min())>0&&(n.readTime=ju(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ns()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Xu(this.R),e.removeTarget=t,this.cr(e)},e}(Gh),Qh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return Pt(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(rs(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(rs(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?$u(t.updateTime):$u(e);return n.isEqual(hs.min())&&(n=$u(e)),new Qa(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=$u(t.commitTime);return this.listener.Tr(n,e)}return rs(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Xu(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return tc(e.R,t)}))};this.cr(n)},e}(Gh),Wh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return Pt(e,t),e.prototype.br=function(){if(this.Rr)throw new Wo(Qo.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Qo.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Wo(Qo.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Qo.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Wo(Qo.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),Yh=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Zo(e),this.Vr=!1):Jo("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),Xh=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return Ft(o,void 0,void 0,(function(){return Vt(this,(function(t){switch(t.label){case 0:return af(this)?(Jo("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Ft(this,void 0,void 0,(function(){var e;return Vt(this,(function(n){switch(n.label){case 0:return(e=is(t)).Or.add(4),[4,Zh(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,Jh(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new Yh(n,r)};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Jh(t){return Ft(this,void 0,void 0,(function(){var e,n;return Vt(this,(function(r){switch(r.label){case 0:if(!af(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Zh(t){return Ft(this,void 0,void 0,(function(){var e,n;return Vt(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function tf(t,e){var n=is(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),sf(n)?of(n):If(n).er()&&nf(n,e))}function ef(t,e){var n=is(t),r=If(n);n.$r.delete(e),r.er()&&rf(n,e),0===n.$r.size&&(r.er()?r.ir():af(n)&&n.Br.set("Unknown"))}function nf(t,e){t.qr.U(e.targetId),If(t).mr(e)}function rf(t,e){t.qr.U(e),If(t).yr(e)}function of(t){t.qr=new Pu({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),If(t).start(),t.Br.Sr()}function sf(t){return af(t)&&!If(t).tr()&&t.$r.size>0}function af(t){return 0===is(t).Or.size}function uf(t){t.qr=void 0}function cf(t){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(e){return t.$r.forEach((function(e,n){nf(t,e)})),[2]}))}))}function lf(t,e){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(n){return uf(t),sf(t)?(t.Br.Nr(e),of(t)):t.Br.set("Unknown"),[2]}))}))}function hf(t,e,n){return Ft(this,void 0,void 0,(function(){var r,i,o;return Vt(this,(function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof Ou&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Ft(this,void 0,void 0,(function(){var n,r,i,o;return Vt(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Jo("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,ff(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof xu?t.qr.X(e):e instanceof Ru?t.qr.rt(e):t.qr.et(e),n.isEqual(hs.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,ah(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(ws.EMPTY_BYTE_STRING,n.snapshotVersion)),rf(t,e);var r=new tl(n.target,e,1,n.sequenceNumber);nf(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Jo("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,ff(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function ff(t,e,n){return Ft(this,void 0,void 0,(function(){var r=this;return Vt(this,(function(i){switch(i.label){case 0:if(!Kc(e))throw e;return t.Or.add(1),[4,Zh(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return ah(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return Ft(r,void 0,void 0,(function(){return Vt(this,(function(e){switch(e.label){case 0:return Jo("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,Jh(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function df(t,e){return e().catch((function(n){return ff(t,n,e)}))}function pf(t){return Ft(this,void 0,void 0,(function(){var e,n,r,i,o;return Vt(this,(function(s){switch(s.label){case 0:e=is(t),n=_f(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return af(t)&&t.kr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,ch(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=_f(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,ff(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return vf(e)&&gf(e),[2]}}))}))}function vf(t){return af(t)&&!_f(t).tr()&&t.kr.length>0}function gf(t){_f(t).start()}function yf(t){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(e){return _f(t).Ar(),[2]}))}))}function mf(t){return Ft(this,void 0,void 0,(function(){var e,n,r,i;return Vt(this,(function(o){for(e=_f(t),n=0,r=t.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function bf(t,e,n){return Ft(this,void 0,void 0,(function(){var r,i;return Vt(this,(function(o){switch(o.label){case 0:return r=t.kr.shift(),i=Zc.from(r,e,n),[4,df(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,pf(t)];case 2:return o.sent(),[2]}}))}))}function wf(t,e){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(n){switch(n.label){case 0:return e&&_f(t).pr?[4,function(t,e){return Ft(this,void 0,void 0,(function(){var n,r;return Vt(this,(function(i){switch(i.label){case 0:return du(r=e.code)&&r!==Qo.ABORTED?(n=t.kr.shift(),_f(t).sr(),[4,df(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,pf(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return vf(t)&&gf(t),[2]}}))}))}function Ef(t,e){return Ft(this,void 0,void 0,(function(){var n;return Vt(this,(function(r){switch(r.label){case 0:return n=is(t),e?(n.Or.delete(2),[4,Jh(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,Zh(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function If(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=is(t);return r.br(),new Hh(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:cf.bind(null,t),Ri:lf.bind(null,t),_r:hf.bind(null,t)}),t.Mr.push((function(n){return Ft(e,void 0,void 0,(function(){return Vt(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),sf(t)?of(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),uf(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function _f(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=is(t);return r.br(),new Qh(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:yf.bind(null,t),Ri:wf.bind(null,t),Ir:mf.bind(null,t),Tr:bf.bind(null,t)}),t.Mr.push((function(n){return Ft(e,void 0,void 0,(function(){return Vt(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,pf(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.kr.length>0&&(Jo("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Tf=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Uc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Wo(Qo.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Sf(t,e){if(Zo("AsyncQueue",e+": "+t),Kc(t))return new Wo(Qo.UNAVAILABLE,e+": "+t);throw t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Af=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||xs.comparator(e.key,n.key)}:function(t,e){return xs.comparator(t.key,e.key)},this.keyedMap=_u(),this.sortedSet=new vu(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),kf=function(){function t(){this.Qr=new vu(xs.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):ns():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),Nf=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Af.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Aa(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Df=function(){this.Wr=void 0,this.listeners=[]},Cf=function(){this.queries=new ql((function(t){return ka(t)}),Aa),this.onlineState="Unknown",this.Gr=new Set};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function xf(t,e){return Ft(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return Vt(this,(function(c){switch(c.label){case 0:if(n=is(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new Df),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=Sf(a,"Initialization of query '"+Na(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Pf(n),[2]}}))}))}function Rf(t,e){return Ft(this,void 0,void 0,(function(){var n,r,i,o,s;return Vt(this,(function(a){return n=is(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function Of(t,e){for(var n=is(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,l=u.listeners;c<l.length;c++)l[c].Hr(s)&&(r=!0);u.Wr=s}}r&&Pf(n)}function Lf(t,e,n){var r=is(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Pf(t){t.Gr.forEach((function(t){t.next()}))}var Mf=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Nf(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Nf.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Ff=function(t){this.key=t},Vf=function(t){this.key=t},Uf=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Au(),this.mutatedKeys=Au(),this.lo=Ca(t),this.fo=new Af(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new kf,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=ma(this.query)&&i.size===this.query.limit?i.last():null,c=ba(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var l=i.get(t),h=Da(n.query,e)?e:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),p=!0):n.yo(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.lo(h,u)>0||c&&n.lo(h,c)<0)&&(a=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(a=!0)),p&&(h?(s=s.add(h),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),ma(this.query)||ba(this.query))for(;s.size>this.query.limit;){var l=ma(this.query)?s.last():s.first();s=s.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ns()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new Nf(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new kf,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Au(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new Vf(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new Ff(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Au();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Nf.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),qf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},jf=function(t){this.key=t,this.bo=!1},Bf=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new ql((function(t){return ka(t)}),Aa),this.Vo=new Map,this.So=new Set,this.Do=new vu(xs.comparator),this.Co=new Map,this.No=new yh,this.xo={},this.Fo=new Map,this.ko=Nl.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function zf(t,e){return Ft(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Vt(this,(function(u){switch(u.label){case 0:return n=md(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,lh(n.localStore,Ta(e))];case 2:return s=u.sent(),a=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,$f(n,e,r,"current"===a)];case 3:i=u.sent(),n.isPrimaryClient&&tf(n.remoteStore,s),u.label=4;case 4:return[2,i]}}))}))}function $f(t,e,n,r){return Ft(this,void 0,void 0,(function(){var i,o,s,a,u,c;return Vt(this,(function(l){switch(l.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Ft(this,void 0,void 0,(function(){var i,o,s;return Vt(this,(function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,fh(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(rd(t,e.targetId,s.To),s.snapshot)]}}))}))}(t,e,n,r)},[4,fh(t.localStore,e,!0)];case 1:return i=l.sent(),o=new Uf(e,i.Bn),s=o._o(i.documents),a=Cu.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),rd(t,n,u.To),c=new qf(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function Kf(t,e){return Ft(this,void 0,void 0,(function(){var n,r,i;return Vt(this,(function(o){switch(o.label){case 0:return n=is(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!Aa(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,hh(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),ef(n.remoteStore,r.targetId),ed(n,r.targetId)})).catch(Ol)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return ed(n,r.targetId),[4,hh(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Gf(t,e,n){return Ft(this,void 0,void 0,(function(){var r,i,o,s;return Vt(this,(function(a){switch(a.label){case 0:r=bd(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=is(t),i=ls.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Au());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],l=tu(c,n.get(c.key));null!=l&&s.push(new iu(c.key,l,Hs(l.value.mapValue),Wa.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new vu(as)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,sd(r,i.changes)];case 3:return a.sent(),[4,pf(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=Sf(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function Hf(t,e){return Ft(this,void 0,void 0,(function(){var n,r;return Vt(this,(function(i){switch(i.label){case 0:n=is(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,uh(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(rs(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?rs(r.bo):t.removedDocuments.size>0&&(rs(r.bo),r.bo=!1))})),[4,sd(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Ol(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Qf(t,e,n){var r=is(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=is(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&Pf(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Wf(t,e,n){return Ft(this,void 0,void 0,(function(){var r,i,o,s,a,u;return Vt(this,(function(c){switch(c.label){case 0:return(r=is(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new vu(xs.comparator)).insert(o,Qs.newNoDocument(o,hs.min())),a=Au().add(o),u=new Du(hs.min(),new Map,new mu(as),s,a),[4,Hf(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),od(r),[3,4];case 2:return[4,hh(r.localStore,e,!1).then((function(){return ed(r,e,n)})).catch(Ol)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function Yf(t,e){return Ft(this,void 0,void 0,(function(){var n,r,i;return Vt(this,(function(o){switch(o.label){case 0:n=is(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,sh(n.localStore,e)];case 2:return i=o.sent(),td(n,r,null),Zf(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,sd(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ol(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Xf(t,e,n){return Ft(this,void 0,void 0,(function(){var r,i;return Vt(this,(function(o){switch(o.label){case 0:r=is(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=is(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return rs(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),td(r,e,n),Zf(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,sd(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ol(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Jf(t,e){return Ft(this,void 0,void 0,(function(){var n,r,i,o,s;return Vt(this,(function(a){switch(a.label){case 0:af((n=is(t)).remoteStore)||Jo("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=is(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=Sf(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function Zf(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function td(t,e,n){var r=is(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function ed(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||nd(t,e)}))}function nd(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(ef(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),od(t))}function rd(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Ff?(t.No.addReference(o.key,e),id(t,o)):o instanceof Vf?(Jo("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||nd(t,o.key)):ns()}}function id(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Jo("SyncEngine","New document in limbo: "+n),t.So.add(r),od(t))}function od(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new xs(gs.fromString(e)),r=t.ko.next();t.Co.set(r,new jf(n)),t.Do=t.Do.insert(n,r),tf(t.remoteStore,new tl(Ta(ya(n.path)),r,2,Ho.o))}}function sd(t,e,n){return Ft(this,void 0,void 0,(function(){var r,i,o,s;return Vt(this,(function(a){switch(a.label){case 0:return r=is(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,a){s.push(r.Oo(a,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=eh.Pn(a.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Ft(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l;return Vt(this,(function(h){switch(h.label){case 0:n=is(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return qc.forEach(e,(function(e){return qc.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return qc.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return h.sent(),[3,4];case 3:if(!Kc(r=h.sent()))throw r;return Jo("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],a=s.targetId,s.fromCache||(u=n.Fn.get(a),c=u.snapshotVersion,l=u.withLastLimboFreeSnapshotVersion(c),n.Fn=n.Fn.insert(a,l));return[2]}}))}))}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function ad(t,e){return Ft(this,void 0,void 0,(function(){var n,r;return Vt(this,(function(i){switch(i.label){case 0:return(n=is(t)).currentUser.isEqual(e)?[3,3]:(Jo("SyncEngine","User change. New user:",e.toKey()),[4,oh(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach((function(t){t.forEach((function(t){t.reject(new Wo(Qo.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,sd(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function ud(t,e){var n=is(t),r=n.Co.get(e);if(r&&r.bo)return Au().add(r.key);var i=Au(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function cd(t,e){return Ft(this,void 0,void 0,(function(){var n,r,i;return Vt(this,(function(o){switch(o.label){case 0:return[4,fh((n=is(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&rd(n,e.targetId,i.To),i)]}}))}))}function ld(t){return Ft(this,void 0,void 0,(function(){var e;return Vt(this,(function(n){return[2,ph((e=is(t)).localStore).then((function(t){return sd(e,t)}))]}))}))}function hd(t,e,n,r){return Ft(this,void 0,void 0,(function(){var i,o;return Vt(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=is(t),r=is(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):qc.resolve(null)}))}))}((i=is(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,pf(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(td(i,e,r||null),Zf(i,e),function(t,e){is(is(t)._n).Gt(e)}(i.localStore,e)):ns(),s.label=4;case 4:return[4,sd(i,o)];case 5:return s.sent(),[3,7];case 6:Jo("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function fd(t,e){return Ft(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c;return Vt(this,(function(l){switch(l.label){case 0:return md(n=is(t)),bd(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,dd(n,r.toArray())]);case 1:return i=l.sent(),n.$o=!0,[4,Ef(n.remoteStore,!0)];case 2:for(l.sent(),o=0,s=i;o<s.length;o++)a=s[o],tf(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return ed(n,e),hh(n.localStore,e,!0)})),ef(n.remoteStore,e)})),[4,c]);case 4:return l.sent(),[4,dd(n,u)];case 5:return l.sent(),function(t){var e=is(t);e.Co.forEach((function(t,n){ef(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new vu(xs.comparator)}(n),n.$o=!1,[4,Ef(n.remoteStore,!1)];case 6:l.sent(),l.label=7;case 7:return[2]}}))}))}function dd(t,e,n){return Ft(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l,h,f,d,p,v;return Vt(this,(function(g){switch(g.label){case 0:n=is(t),r=[],i=[],o=0,s=e,g.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.Vo.get(a))&&0!==c.length?[4,lh(n.localStore,Ta(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),l=0,h=c,g.label=3;case 3:return l<h.length?(f=h[l],d=n.Po.get(f),[4,cd(n,d)]):[3,6];case 4:(p=g.sent()).snapshot&&i.push(p.snapshot),g.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,dh(n.localStore,a)];case 8:return v=g.sent(),[4,lh(n.localStore,v)];case 9:return u=g.sent(),[4,$f(n,pd(v),a,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function pd(t){return ga(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function vd(t){var e=is(t);return is(is(e.localStore).persistence).fn()}function gd(t,e,n,r){return Ft(this,void 0,void 0,(function(){var i,o,s;return Vt(this,(function(a){switch(a.label){case 0:return(i=is(t)).$o?(Jo("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,ph(i.localStore)];case 3:return o=a.sent(),s=Du.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,sd(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,hh(i.localStore,e,!0)];case 6:return a.sent(),ed(i,e,r),[3,8];case 7:ns(),a.label=8;case 8:return[2]}}))}))}function yd(t,e,n){return Ft(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h,f;return Vt(this,(function(d){switch(d.label){case 0:if(!(r=md(t)).$o)return[3,10];i=0,o=e,d.label=1;case 1:return i<o.length?(s=o[i],r.Vo.has(s)?(Jo("SyncEngine","Adding an already active target "+s),[3,5]):[4,dh(r.localStore,s)]):[3,6];case 2:return a=d.sent(),[4,lh(r.localStore,a)];case 3:return u=d.sent(),[4,$f(r,pd(a),u.targetId,!1)];case 4:d.sent(),tf(r.remoteStore,u),d.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Vt(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,hh(r.localStore,t,!1).then((function(){ef(r.remoteStore,t),ed(r,t)})).catch(Ol)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,h=n,d.label=7;case 7:return l<h.length?(f=h[l],[5,c(f)]):[3,10];case 8:d.sent(),d.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function md(t){var e=is(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Hf.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ud.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Wf.bind(null,e),e.vo._r=Of.bind(null,e.eventManager),e.vo.Mo=Lf.bind(null,e.eventManager),e}function bd(t){var e=is(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Yf.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Xf.bind(null,e),e}var wd=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(e){switch(e.label){case 0:return this.R=$h(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return ih(this.persistence,new nh,t.initialUser,this.R)},t.prototype.qo=function(t){return new _h(Sh.bs,this.R)},t.prototype.Bo=function(t){return new Mh},t.prototype.terminate=function(){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),Ed=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Pt(e,t),e.prototype.initialize=function(e){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,vh(this.localStore)];case 2:return n.sent(),[4,this.Qo.initialize(this,e)];case 3:return n.sent(),[4,bd(this.Qo.syncEngine)];case 4:return n.sent(),[4,pf(this.Qo.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Ko=function(t){return ih(this.persistence,new nh,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new Ml(e,t.asyncQueue)},e.prototype.qo=function(t){var e=Zl(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?wl.withCacheSize(this.cacheSizeBytes):wl.DEFAULT;return new Yl(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Bh(),zh(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Mh},e}(wd),Id=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Pt(e,t),e.prototype.initialize=function(e){return Ft(this,void 0,void 0,(function(){var n,r=this;return Vt(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof Ph?(this.sharedClientState.syncEngine={ui:hd.bind(null,n),ai:gd.bind(null,n),hi:yd.bind(null,n),fn:vd.bind(null,n),ci:ld.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return Ft(r,void 0,void 0,(function(){return Vt(this,(function(e){switch(e.label){case 0:return[4,fd(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=Bh();if(!Ph.yt(e))throw new Wo(Qo.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Zl(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Ph(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(Ed),_d=function(){function t(){}return t.prototype.initialize=function(t,e){return Ft(this,void 0,void 0,(function(){var n=this;return Vt(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Qf(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=ad.bind(null,this.syncEngine),[4,Ef(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new Cf},t.prototype.createDatastore=function(t){var e,n=$h(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new jh(e));return function(t,e,n){return new Wh(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Qf(s.syncEngine,t,0)},o=Vh.yt()?new Vh:new Fh,new Xh(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Bf(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Ft(this,void 0,void 0,(function(){var e;return Vt(this,(function(n){switch(n.label){case 0:return e=is(t),Jo("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,Zh(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}(),Td=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),Sd=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Ft(this,void 0,void 0,(function(){var e,n=this;return Vt(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Wo(Qo.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Ft(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Vt(this,(function(u){switch(u.label){case 0:return n=is(t),r=Xu(n.R)+"/documents",i={documents:e.map((function(t){return Hu(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){rs(!!e.found),e.found.name,e.found.updateTime;var n=Qu(t,e.found.name),r=$u(e.found.updateTime),i=new Gs({mapValue:{fields:e.found.fields}});return Qs.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){rs(!!e.missing),rs(!!e.readTime);var n=Qu(t,e.missing),r=$u(e.readTime);return Qs.newNoDocument(n,r)}(t,e):ns()}(n.R,t);s.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=s.get(t.toString());rs(!!e),a.push(e)})),a)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new lu(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Ft(this,void 0,void 0,(function(){var t,e=this;return Vt(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=xs.fromPath(n);e.mutations.push(new hu(r,e.precondition(r)))})),[4,function(t,e){return Ft(this,void 0,void 0,(function(){var n,r,i;return Vt(this,(function(o){switch(o.label){case 0:return n=is(t),r=Xu(n.R)+"/documents",i={writes:e.map((function(t){return tc(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw ns();e=hs.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Wo(Qo.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Wa.updateTime(e):Wa.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(hs.min()))throw new Wo(Qo.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Wa.updateTime(e)}return Wa.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),Ad=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Kh(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return Ft(t,void 0,void 0,(function(){var t,e,n=this;return Vt(this,(function(r){return t=new Sd(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Ns(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!du(e)}return!1},t}(),kd=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Ah.UNAUTHENTICATED,this.clientId=ss.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return Ft(r,void 0,void 0,(function(){return Vt(this,(function(e){switch(e.label){case 0:return Jo("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Wo(Qo.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Uc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return Ft(t,void 0,void 0,(function(){var t,n;return Vt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Sf(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Nd(t,e){return Ft(this,void 0,void 0,(function(){var n,r,i=this;return Vt(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Jo("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return Ft(i,void 0,void 0,(function(){return Vt(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,oh(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function Dd(t,e){return Ft(this,void 0,void 0,(function(){var n,r;return Vt(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Cd(t)];case 1:return n=i.sent(),Jo("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return Ft(this,void 0,void 0,(function(){var n,r;return Vt(this,(function(i){switch(i.label){case 0:return(n=is(t)).asyncQueue.verifyOperationInProgress(),Jo("RemoteStore","RemoteStore received new credentials"),r=af(n),n.Or.add(3),[4,Zh(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,Jh(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function Cd(t){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Jo("FirestoreClient","Using default OfflineComponentProvider"),[4,Nd(t,new wd)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function xd(t){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Jo("FirestoreClient","Using default OnlineComponentProvider"),[4,Dd(t,new _d)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Rd(t){return Cd(t).then((function(t){return t.persistence}))}function Od(t){return Cd(t).then((function(t){return t.localStore}))}function Ld(t){return xd(t).then((function(t){return t.remoteStore}))}function Pd(t){return xd(t).then((function(t){return t.syncEngine}))}function Md(t){return Ft(this,void 0,void 0,(function(){var e,n;return Vt(this,(function(r){switch(r.label){case 0:return[4,xd(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=zf.bind(null,e.syncEngine),n.onUnlisten=Kf.bind(null,e.syncEngine),n)]}}))}))}function Fd(t,e,n){var r=this;void 0===n&&(n={});var i=new Uc;return t.asyncQueue.enqueueAndForget((function(){return Ft(r,void 0,void 0,(function(){var r;return Vt(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Td({next:function(o){e.enqueueAndForget((function(){return Rf(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new Wo(Qo.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new Wo(Qo.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Mf(ya(n.path),o,{includeMetadataChanges:!0,so:!0});return xf(t,s)},[4,Md(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function Vd(t,e,n){var r=this;void 0===n&&(n={});var i=new Uc;return t.asyncQueue.enqueueAndForget((function(){return Ft(r,void 0,void 0,(function(){var r;return Vt(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Td({next:function(n){e.enqueueAndForget((function(){return Rf(t,s)})),n.fromCache&&"server"===r.source?i.reject(new Wo(Qo.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Mf(n,o,{includeMetadataChanges:!0,so:!0});return xf(t,s)},[4,Md(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var Ud=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},qd=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),jd=new Map,Bd=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},zd=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(Ah.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),$d=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Kd=function(){function t(t){var e=this;this.currentUser=Ah.UNAUTHENTICATED,this.oc=new Uc,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){Jo("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Jo("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(Jo("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(rs("string"==typeof n.accessToken),new Bd(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return Ft(n,void 0,void 0,(function(){return Vt(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return rs(null===t||"string"==typeof t),new Ah(t)},t}(),Gd=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=Ah.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),Hd=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Gd(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(Ah.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Qd(t,e,n){if(!n)throw new Wo(Qo.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Wd(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Wo(Qo.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Yd(t,e,n,r){if(!0===e&&!0===r)throw new Wo(Qo.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Xd(t){if(!xs.isDocumentKey(t))throw new Wo(Qo.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Jd(t){if(xs.isDocumentKey(t))throw new Wo(Qo.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Zd(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":ns()}function tp(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Wo(Qo.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Zd(t);throw new Wo(Qo.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function ep(t,e){if(e<=0)throw new Wo(Qo.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var np=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Wo(Qo.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Wo(Qo.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Yd("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),rp=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new np({}),this._settingsFrozen=!1,t instanceof qd?(this._databaseId=t,this._credentials=new zd):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Wo(Qo.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new qd(t.options.projectId)}(t),this._credentials=new Kd(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Wo(Qo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Wo(Qo.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new np(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new zd;switch(t.type){case"gapi":var e=t.client;return rs(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Hd(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Wo(Qo.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=jd.get(this))&&(Jo("ComponentProvider","Removing Datastore"),jd.delete(this),t.terminate()),Promise.resolve();var t},t}(),ip=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new sp(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),op=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),sp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,ya(r))||this)._path=r,i.type="collection",i}return Pt(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new ip(this.firestore,null,new xs(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(op);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ap(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=ee(t),Qd("collection","path",e),t instanceof rp)return Jd(n=gs.fromString.apply(gs,jt([e],r))),new sp(t,null,n);if(!(t instanceof ip||t instanceof sp))throw new Wo(Qo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Jd(n=gs.fromString.apply(gs,jt([t.path],r)).child(gs.fromString(e))),new sp(t.firestore,null,n)}function up(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=ee(t),1===arguments.length&&(e=ss.u()),Qd("doc","path",e),t instanceof rp)return Xd(n=gs.fromString.apply(gs,jt([e],r))),new ip(t,null,new xs(n));if(!(t instanceof ip||t instanceof sp))throw new Wo(Qo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Xd(n=t._path.child(gs.fromString.apply(gs,jt([e],r)))),new ip(t.firestore,t instanceof sp?t.converter:null,new xs(n))}function cp(t,e){return t=ee(t),e=ee(e),(t instanceof ip||t instanceof sp)&&(e instanceof ip||e instanceof sp)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function lp(t,e){return t=ee(t),e=ee(e),t instanceof op&&e instanceof op&&t.firestore===e.firestore&&Aa(t._query,e._query)&&t.converter===e.converter
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var hp=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new Kh(this,"async_queue_retry"),this.Ic=function(){var e=zh();e&&Jo("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=zh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},t.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var e=zh();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ic)}},t.prototype.enqueue=function(t){var e=this;if(this.Ac(),this._c)return new Promise((function(){}));var n=new Uc;return this.Rc((function(){return e._c&&e.Ec?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.bc()}))},t.prototype.bc=function(){return Ft(this,void 0,void 0,(function(){var t,e=this;return Vt(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Kc(t=n.sent()))throw t;return Jo("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.bc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Rc=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,Zo("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ac(),this.Tc.indexOf(t)>-1&&(e=0);var i=Tf.createAndSchedule(this,t,e,n,(function(t){return r.vc(t)}));return this.mc.push(i),i},t.prototype.Ac=function(){this.yc&&ns()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Pc=function(){return Ft(this,void 0,void 0,(function(){var t;return Vt(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Vc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Sc=function(t){var e=this;return this.Pc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Pc()}))},t.prototype.Dc=function(t){this.Tc.push(t)},t.prototype.vc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function fp(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var dp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new hp,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return Pt(e,t),e.prototype._terminate=function(){return this._firestoreClient||vp(this),this._firestoreClient.terminate()},e}(rp);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function pp(t){return t._firestoreClient||vp(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function vp(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Ud(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new kd(t._credentials,t._queue,r)}function gp(t,e,n){var r=this,i=new Uc;return t.asyncQueue.enqueue((function(){return Ft(r,void 0,void 0,(function(){var r;return Vt(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Nd(t,n)];case 1:return o.sent(),[4,Dd(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Qo.FAILED_PRECONDITION||t.code===Qo.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function yp(t){if(t._initialized||t._terminated)throw new Wo(Qo.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var mp=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Wo(Qo.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ms(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),bp=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(ws.fromBase64String(e))}catch(e){throw new Wo(Qo.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(ws.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),wp=function(t){this._methodName=t},Ep=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Wo(Qo.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Wo(Qo.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return as(this._lat,t._lat)||as(this._long,t._long)},t}(),Ip=/^__.*__$/,_p=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new iu(t,this.data,this.fieldMask,e,this.fieldTransforms):new ru(t,this.data,e,this.fieldTransforms)},t}(),Tp=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new iu(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Sp(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ns()}}var Ap=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),t.prototype.xc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.Fc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,kc:!1});return r.$c(t),r},t.prototype.Oc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,kc:!1});return r.Cc(),r},t.prototype.Mc=function(t){return this.xc({path:void 0,kc:!0})},t.prototype.Lc=function(t){return Gp(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Lc("Document fields must not be empty");if(Sp(this.Nc)&&Ip.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},t}(),kp=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||$h(t)}return t.prototype.Uc=function(t,e,n,r){return void 0===r&&(r=!1),new Ap({Nc:t,methodName:e,qc:n,path:ms.emptyPath(),kc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function Np(t){var e=t._freezeSettings(),n=$h(t._databaseId);return new kp(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Dp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Uc(o.merge||o.mergeFields?2:0,e,n,i);Bp("Data must be an object, but it was:",s,r);var a,u,c=qp(r,s);if(o.merge)a=new bs(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var d=zp(e,f[h],n);if(!s.contains(d))throw new Wo(Qo.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Hp(l,d)||l.push(d)}a=new bs(l),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new _p(new Gs(c),a,u)}var Cp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pt(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Nc)throw 1===t.Nc?t.Lc(this._methodName+"() can only appear at the top level of your update data"):t.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(wp);function xp(t,e,n){return new Ap({Nc:3,qc:e.settings.qc,methodName:t._methodName,kc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Rp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pt(e,t),e.prototype._toFieldTransform=function(t){return new Ha(t.path,new Ua)},e.prototype.isEqual=function(t){return t instanceof e},e}(wp),Op=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Pt(e,t),e.prototype._toFieldTransform=function(t){var e=xp(this,t,!0),n=this.Kc.map((function(t){return Up(t,e)})),r=new qa(n);return new Ha(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(wp),Lp=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Pt(e,t),e.prototype._toFieldTransform=function(t){var e=xp(this,t,!0),n=this.Kc.map((function(t){return Up(t,e)})),r=new Ba(n);return new Ha(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(wp),Pp=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return Pt(e,t),e.prototype._toFieldTransform=function(t){var e=new $a(t.R,La(t.R,this.Qc));return new Ha(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(wp);function Mp(t,e,n,r){var i=t.Uc(1,e,n);Bp("Data must be an object, but it was:",i,r);var o=[],s=Gs.empty();ds(r,(function(t,r){var a=Kp(e,t,n);r=ee(r);var u=i.Oc(a);if(r instanceof Cp)o.push(a);else{var c=Up(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new bs(o);return new Tp(s,a,i.fieldTransforms)}function Fp(t,e,n,r,i,o){var s=t.Uc(1,e,n),a=[zp(e,r,n)],u=[i];if(o.length%2!=0)throw new Wo(Qo.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(zp(e,o[c])),u.push(o[c+1]);for(var l=[],h=Gs.empty(),f=a.length-1;f>=0;--f)if(!Hp(l,a[f])){var d=a[f],p=u[f];p=ee(p);var v=s.Oc(d);if(p instanceof Cp)l.push(d);else{var g=Up(p,v);null!=g&&(l.push(d),h.set(d,g))}}var y=new bs(l);return new Tp(h,y,s.fieldTransforms)}function Vp(t,e,n,r){return void 0===r&&(r=!1),Up(n,t.Uc(r?4:3,e))}function Up(t,e){if(jp(t=ee(t)))return Bp("Unsupported field value:",e,t),qp(t,e);if(t instanceof wp)return function(t,e){if(!Sp(e.Nc))throw e.Lc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Lc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.kc&&4!==e.Nc)throw e.Lc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Up(o[i],e.Mc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=ee(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return La(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ls.fromDate(t);return{timestampValue:ju(e.R,n)}}if(t instanceof ls)return n=new ls(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:ju(e.R,n)};if(t instanceof Ep)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof bp)return{bytesValue:Bu(e.R,t._byteString)};if(t instanceof ip){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ku(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Lc("Unsupported field value: "+Zd(t))}(t,e)}function qp(t,e){var n={};return ps(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ds(t,(function(t,r){var i=Up(r,e.Fc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function jp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ls||t instanceof Ep||t instanceof bp||t instanceof ip||t instanceof wp)}function Bp(t,e,n){if(!jp(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Zd(n);throw"an object"===r?e.Lc(t+" a custom object"):e.Lc(t+" "+r)}}function zp(t,e,n){if((e=ee(e))instanceof mp)return e._internalPath;if("string"==typeof e)return Kp(t,e);throw Gp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var $p=new RegExp("[~\\*/\\[\\]]");function Kp(t,e,n){if(e.search($p)>=0)throw Gp("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(mp.bind.apply(mp,jt([void 0],e.split(".")))))._internalPath}catch(r){throw Gp("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Gp(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Wo(Qo.INVALID_ARGUMENT,(a+=". ")+t+u)}function Hp(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Qp=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new ip(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Wp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(Yp("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Wp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pt(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Qp);function Yp(t,e){return"string"==typeof e?Kp(t,e):e instanceof mp?e._internalPath:e._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Xp=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Jp=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return Pt(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Zp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(Yp("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Qp),Zp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pt(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Jp),tv=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Xp(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Zp(n._firestore,n._userDataWriter,r.key,r,new Xp(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Wo(Qo.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new Zp(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Xp(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Zp(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Xp(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:ev(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function ev(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ns()}}function nv(t,e){return t instanceof Jp&&e instanceof Jp?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof tv&&e instanceof tv&&t._firestore===e._firestore&&lp(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function rv(t){if(ba(t)&&0===t.explicitOrderBy.length)throw new Wo(Qo.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var iv=function(){};function ov(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var sv=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).jc=e,i.Wc=n,i.Gc=r,i.type="where",i}return Pt(e,t),e.prototype._apply=function(t){var e=Np(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Wo(Qo.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){dv(s,o);for(var u=[],c=0,l=s;c<l.length;c++){var h=l[c];u.push(fv(r,t,h))}a={arrayValue:{values:u}}}else a=fv(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||dv(s,o),a=Vp(n,"where",s,"in"===o||"not-in"===o);var f=ta.create(i,o,a);return function(t,e){if(e.g()){var n=Ea(t);if(null!==n&&!n.isEqual(e.field))throw new Wo(Qo.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=wa(t);null!==r&&pv(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new Wo(Qo.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Wo(Qo.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.jc,this.Wc,this.Gc);return new op(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new va(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(iv),av=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jc=e,r.zc=n,r.type="orderBy",r}return Pt(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Wo(Qo.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Wo(Qo.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ha(e,n);return function(t,e){if(null===wa(t)){var n=Ea(t);null!==n&&pv(t,n,e.field)}}(t,r),r}(t._query,this.jc,this.zc);return new op(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new va(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(iv),uv=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return Pt(e,t),e.prototype._apply=function(t){return new op(t.firestore,t.converter,Sa(t._query,this.Hc,this.Jc))},e}(iv),cv=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return Pt(e,t),e.prototype._apply=function(t){var e=hv(t,this.type,this.Yc,this.Xc);return new op(t.firestore,t.converter,function(t,e){return new va(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(iv),lv=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return Pt(e,t),e.prototype._apply=function(t){var e=hv(t,this.type,this.Yc,this.Xc);return new op(t.firestore,t.converter,function(t,e){return new va(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(iv);function hv(t,e,n,r){if(n[0]=ee(n[0]),n[0]instanceof Qp)return function(t,e,n,r,i){if(!r)throw new Wo(Qo.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=_a(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Us(e,r.key));else{var c=r.data.field(u.field);if(Ss(c))throw new Wo(Qo.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new Wo(Qo.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new ca(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Np(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Wo(Qo.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Wo(Qo.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Ia(t)&&-1!==c.indexOf("/"))throw new Wo(Qo.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=t.path.child(gs.fromString(c));if(!xs.isDocumentKey(l))throw new Wo(Qo.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new xs(l);a.push(Us(e,h))}else{var f=Vp(n,r,c);a.push(f)}}return new ca(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function fv(t,e,n){if("string"==typeof(n=ee(n))){if(""===n)throw new Wo(Qo.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ia(e)&&-1!==n.indexOf("/"))throw new Wo(Qo.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(gs.fromString(n));if(!xs.isDocumentKey(r))throw new Wo(Qo.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Us(t,new xs(r))}if(n instanceof ip)return Us(t,n._key);throw new Wo(Qo.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Zd(n)+".")}function dv(t,e){if(!Array.isArray(t)||0===t.length)throw new Wo(Qo.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Wo(Qo.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function pv(t,e,n){if(!n.isEqual(e))throw new Wo(Qo.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var vv=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Rs(t)){case 0:return null;case 1:return t.booleanValue;case 2:return _s(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Ts(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw ns()}},t.prototype.convertObject=function(t,e){var n=this,r={};return ds(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new Ep(_s(t.latitude),_s(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=As(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(ks(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=Is(t);return new ls(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=gs.fromString(t);rs(vc(n));var r=new qd(n.get(1),n.get(3)),i=new xs(n.popFirst(5));return r.isEqual(e)||Zo("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function gv(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var yv=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Pt(e,t),e.prototype.convertBytes=function(t){return new bp(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new ip(this.firestore,null,e)},e}(vv),mv=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Np(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=bv(t,this._firestore),i=gv(r.converter,e,n),o=Dp(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Wa.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=bv(t,this._firestore);return o="string"==typeof(e=ee(e))||e instanceof mp?Fp(this._dataReader,"WriteBatch.update",s._key,e,n,r):Mp(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,Wa.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=bv(t,this._firestore);return this._mutations=this._mutations.concat(new lu(e._key,Wa.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Wo(Qo.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function bv(t,e){if((t=ee(t)).firestore!==e)throw new Wo(Qo.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var wv=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Pt(e,t),e.prototype.convertBytes=function(t){return new bp(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new ip(this.firestore,null,e)},e}(vv);function Ev(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=tp(t,ip);var o=tp(t.firestore,dp),s=Np(o);return _v(o,[("string"==typeof(e=ee(e))||e instanceof mp?Fp(s,"updateDoc",t._key,e,n,r):Mp(s,"updateDoc",t._key,e)).toMutation(t._key,Wa.exists(!0))])}function Iv(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=ee(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||fp(i[a])||(s=i[a],a++);var u,c,l,h={includeMetadataChanges:s.includeMetadataChanges};if(fp(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof ip)c=tp(t.firestore,dp),l=ya(t._key.path),u={next:function(e){i[a]&&i[a](Tv(c,t,e))},error:i[a+1],complete:i[a+2]};else{var d=tp(t,op);c=tp(d.firestore,dp),l=d._query;var p=new wv(c);u={next:function(t){i[a]&&i[a](new tv(c,p,d,t))},error:i[a+1],complete:i[a+2]},rv(t._query)}return function(t,e,n,r){var i=this,o=new Td(r),s=new Mf(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return Ft(i,void 0,void 0,(function(){var e;return Vt(this,(function(n){switch(n.label){case 0:return e=xf,[4,Md(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return Ft(i,void 0,void 0,(function(){var e;return Vt(this,(function(n){switch(n.label){case 0:return e=Rf,[4,Md(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(pp(c),l,h,u)}function _v(t,e){return function(t,e){var n=this,r=new Uc;return t.asyncQueue.enqueueAndForget((function(){return Ft(n,void 0,void 0,(function(){var n;return Vt(this,(function(i){switch(i.label){case 0:return n=Gf,[4,Pd(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(pp(t),e)}function Tv(t,e,n){var r=n.docs.get(e._key),i=new wv(t);return new Jp(t,i,e._key,r,new Xp(n.hasPendingWrites,n.fromCache),e.converter)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Sv=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return Pt(e,t),e.prototype.get=function(e){var n=this,r=bv(e,this._firestore),i=new wv(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new Jp(n._firestore,i,r._key,t._document,new Xp(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Np(t)}return t.prototype.get=function(t){var e=this,n=bv(t,this._firestore),r=new yv(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return ns();var i=t[0];if(i.isFoundDocument())return new Qp(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Qp(e._firestore,r,n._key,null,n.converter);throw ns()}))},t.prototype.set=function(t,e,n){var r=bv(t,this._firestore),i=gv(r.converter,e,n),o=Dp(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=bv(t,this._firestore);return o="string"==typeof(e=ee(e))||e instanceof mp?Fp(this._dataReader,"Transaction.update",s._key,e,n,r):Mp(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=bv(t,this._firestore);return this._transaction.delete(e._key),this},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Av(){if("undefined"==typeof Uint8Array)throw new Wo(Qo.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function kv(){if("undefined"==typeof atob)throw new Wo(Qo.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Nv=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return kv(),new t(bp.fromBase64String(e))},t.fromUint8Array=function(e){return Av(),new t(bp.fromUint8Array(e))},t.prototype.toBase64=function(){return kv(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Av(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Dv=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){yp(t=tp(t,dp));var n=pp(t),r=t._freezeSettings(),i=new _d;return gp(n,i,new Ed(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){yp(t=tp(t,dp));var e=pp(t),n=t._freezeSettings(),r=new _d;return gp(e,r,new Id(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Wo(Qo.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Uc;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return Ft(e,void 0,void 0,(function(){var e;return Vt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Ft(this,void 0,void 0,(function(){var e;return Vt(this,(function(n){switch(n.label){case 0:return Bc.yt()?(e=t+"main",[4,Bc.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Zl(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),Cv=function(){function t(t,e,n){var r=this;this._delegate=e,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof qd||(this.tu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||ts("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=tp(t,rp))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&ts("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=Mt({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Bt.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),Bt.encodeString(JSON.stringify(o),!1),""].join(".")}(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Wo(Qo.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new $d(new Bd(o,new Ah(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Ft(e,void 0,void 0,(function(){var e,n;return Vt(this,(function(r){switch(r.label){case 0:return[4,Rd(t)];case 1:return e=r.sent(),[4,Ld(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=is(t);return e.Or.delete(0),Jh(e)}(n))]}}))}))}))}(pp(tp(this._delegate,dp)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Ft(e,void 0,void 0,(function(){var e,n;return Vt(this,(function(r){switch(r.label){case 0:return[4,Rd(t)];case 1:return e=r.sent(),[4,Ld(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Ft(this,void 0,void 0,(function(){var e;return Vt(this,(function(n){switch(n.label){case 0:return(e=is(t)).Or.add(0),[4,Zh(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(pp(tp(this._delegate,dp)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Yd("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Uc;return t.asyncQueue.enqueueAndForget((function(){return Ft(e,void 0,void 0,(function(){var e;return Vt(this,(function(r){switch(r.label){case 0:return e=Jf,[4,Pd(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(pp(tp(this._delegate,dp)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Td(e);return t.asyncQueue.enqueueAndForget((function(){return Ft(n,void 0,void 0,(function(){var e;return Vt(this,(function(n){switch(n.label){case 0:return e=function(t,e){is(t).Gr.add(e),e.next()},[4,Md(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return Ft(n,void 0,void 0,(function(){var e;return Vt(this,(function(n){switch(n.label){case 0:return e=function(t,e){is(t).Gr.delete(e)},[4,Md(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(pp(t=tp(t,dp)),fp(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.tu)throw new Wo(Qo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new $v(this,ap(this._delegate,t))}catch(t){throw Mv(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Pv(this,up(this._delegate,t))}catch(t){throw Mv(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new jv(this,function(t,e){if(t=tp(t,rp),Qd("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Wo(Qo.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new op(t,null,function(t){return new va(gs.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Mv(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Uc;return t.asyncQueue.enqueueAndForget((function(){return Ft(n,void 0,void 0,(function(){var n;return Vt(this,(function(i){switch(i.label){case 0:return[4,function(t){return xd(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new Ad(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(pp(t),(function(n){return e(new Sv(t,n))}))}(this._delegate,(function(n){return t(new Rv(e,n))}))},t.prototype.batch=function(){var t=this;return pp(this._delegate),new Ov(new mv(this._delegate,(function(e){return _v(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new Wo(Qo.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Wo(Qo.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),xv=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Pt(e,t),e.prototype.convertBytes=function(t){return new Nv(new bp(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Pv.eu(e,this.firestore,null)},e}(vv);var Rv=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new xv(t)}return t.prototype.get=function(t){var e=this,n=Kv(t);return this._delegate.get(n).then((function(t){return new Uv(e._firestore,new Jp(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=Kv(t);return n?(Wd("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Kv(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,jt([s,e,n],i)),this},t.prototype.delete=function(t){var e=Kv(t);return this._delegate.delete(e),this},t}(),Ov=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Kv(t);return n?(Wd("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Kv(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,jt([s,e,n],i)),this},t.prototype.delete=function(t){var e=Kv(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Lv=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Zp(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new qv(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.nu=function(e,n){var r=t.su,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new xv(e),n),i.set(n,o)),o},t}();Lv.su=new WeakMap;var Pv=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new xv(t)}return t.iu=function(e,n,r){if(e.length%2!=0)throw new Wo(Qo.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new ip(n._delegate,r,new xs(e)))},t.eu=function(e,n,r){return new t(n,new ip(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new $v(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new $v(this.firestore,ap(this._delegate,t))}catch(t){throw Mv(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=ee(t))instanceof ip&&cp(this._delegate,t)},t.prototype.set=function(t,e){e=Wd("DocumentReference.set",e);try{return function(t,e,n){t=tp(t,ip);var r=tp(t.firestore,dp),i=gv(t.converter,e,n);return _v(r,[Dp(Np(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Wa.none())])}(this._delegate,t,e)}catch(t){throw Mv(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Ev(this._delegate,t):Ev.apply(void 0,jt([this._delegate,t,e],n))}catch(t){throw Mv(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return _v(tp((t=this._delegate).firestore,dp),[new lu(t._key,Wa.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Fv(e),i=Vv(e,(function(e){return new Uv(t.firestore,new Jp(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return Iv(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=tp(t,ip);var e=tp(t.firestore,dp),n=pp(e),r=new wv(e);return function(t,e){var n=this,r=new Uc;return t.asyncQueue.enqueueAndForget((function(){return Ft(n,void 0,void 0,(function(){var n;return Vt(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Ft(this,void 0,void 0,(function(){var r,i;return Vt(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=is(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Wo(Qo.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Sf(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Od(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new Jp(e,r,t._key,n,new Xp(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=tp(t,ip);var e=tp(t.firestore,dp);return Fd(pp(e),t._key,{source:"server"}).then((function(n){return Tv(e,t,n)}))}(this._delegate):function(t){t=tp(t,ip);var e=tp(t.firestore,dp);return Fd(pp(e),t._key).then((function(n){return Tv(e,t,n)}))}(this._delegate)).then((function(t){return new Uv(e.firestore,new Jp(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Lv.nu(this.firestore,e)):this._delegate.withConverter(null))},t}();function Mv(t,e,n){return t.message=t.message.replace(e,n),t}function Fv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!fp(r))return r}return{}}function Vv(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=fp(t[0])?t[0]:fp(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Uv=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Pv(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return nv(this._delegate,t._delegate)},t}(),qv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pt(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Uv),jv=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new xv(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,ov(this._delegate,function(t,e,n){var r=e,i=Yp("where",t);return new sv(i,r,n)}(e,n,r)))}catch(e){throw Mv(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,ov(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=Yp("orderBy",t);return new av(r,n)}(e,n)))}catch(e){throw Mv(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,ov(this._delegate,function(t){return ep("limit",t),new uv("limit",t,"F")}(e)))}catch(e){throw Mv(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,ov(this._delegate,function(t){return ep("limitToLast",t),new uv("limitToLast",t,"L")}(e)))}catch(e){throw Mv(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ov(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new cv("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw Mv(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ov(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new cv("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw Mv(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ov(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new lv("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw Mv(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ov(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new lv("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw Mv(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return lp(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=tp(t,op);var e=tp(t.firestore,dp),n=pp(e),r=new wv(e);return function(t,e){var n=this,r=new Uc;return t.asyncQueue.enqueueAndForget((function(){return Ft(n,void 0,void 0,(function(){var n;return Vt(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Ft(this,void 0,void 0,(function(){var r,i,o,s,a;return Vt(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,fh(t,e,!0)];case 1:return a=u.sent(),r=new Uf(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=Sf(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,Od(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new tv(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=tp(t,op);var e=tp(t.firestore,dp),n=pp(e),r=new wv(e);return Vd(n,t._query,{source:"server"}).then((function(n){return new tv(e,r,t,n)}))}(this._delegate):function(t){t=tp(t,op);var e=tp(t.firestore,dp),n=pp(e),r=new wv(e);return rv(t._query),Vd(n,t._query).then((function(n){return new tv(e,r,t,n)}))}(this._delegate)).then((function(t){return new zv(e.firestore,new tv(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Fv(e),i=Vv(e,(function(e){return new zv(t.firestore,new tv(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return Iv(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Lv.nu(this.firestore,e)):this._delegate.withConverter(null))},t}(),Bv=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new qv(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),zv=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new jv(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new qv(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new Bv(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new qv(n._firestore,r))}))},t.prototype.isEqual=function(t){return nv(this._delegate,t._delegate)},t}(),$v=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return Pt(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Pv(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Pv(this.firestore,void 0===t?up(this._delegate):up(this._delegate,t))}catch(t){throw Mv(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=tp(t.firestore,dp),r=up(t),i=gv(t.converter,e);return _v(n,[Dp(Np(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Wa.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new Pv(e.firestore,t)}))},e.prototype.isEqual=function(t){return cp(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Lv.nu(this.firestore,t)):this._delegate.withConverter(null))},e}(jv);function Kv(t){return tp(t,ip)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Gv,Hv=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(mp.bind.apply(mp,jt([void 0],t)))}return t.documentId=function(){return new t(ms.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=ee(t))instanceof mp&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Qv=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Rp("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Cp("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Op("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Lp("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Pp("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),Wv={Firestore:Cv,GeoPoint:Ep,Timestamp:ls,Blob:Nv,Transaction:Rv,WriteBatch:Ov,DocumentReference:Pv,DocumentSnapshot:Uv,Query:jv,QueryDocumentSnapshot:qv,QuerySnapshot:zv,CollectionReference:$v,FieldPath:Hv,FieldValue:Qv,setLogLevel:function(t){var e;e=t,Yo.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new ne("firestore",(function(t){return function(t,e){return new Cv(t,new dp(t,e),new Dv)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Wv)))})(Gv=Ce),Gv.registerVersion("@firebase/firestore","2.3.9");
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Yv={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Xv=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return Pt(e,t),e}(Error);var Jv=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return Ft(this,void 0,void 0,(function(){var t;return Vt(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return Ft(this,void 0,void 0,(function(){return Vt(this,(function(t){switch(t.label){case 0:if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.messaging.getToken()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getContext=function(){return Ft(this,void 0,void 0,(function(){var t,e;return Vt(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Zv(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var tg=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return Zv(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?Zv(t,(function(t){return e.decode(t)})):t},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var eg=function(){function t(t,e,n,r,i,o){var s=this;void 0===i&&(i="us-central1"),this.app_=t,this.appCheckProvider=r,this.fetchImpl=o,this.serializer=new tg,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(s.deleteService())}},this.contextProvider=new Jv(e,n),this.cancelAllRequests=new Promise((function(t){s.deleteService=function(){return t()}}));try{var a=new URL(i);this.customDomain=a.origin,this.region="us-central1"}catch(t){this.customDomain=null,this.region=i}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return Ft(this,void 0,void 0,(function(){var r,i,o;return Vt(this,(function(s){switch(s.label){case 0:return n["Content-Type"]="application/json",[4,this.getAppCheckToken()];case 1:null!==(r=s.sent())&&(n["X-Firebase-AppCheck"]=r),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 3:return i=s.sent(),[3,5];case 4:return s.sent(),[2,{status:0,json:null}];case 5:o=null,s.label=6;case 6:return s.trys.push([6,8,,9]),[4,i.json()];case 7:return o=s.sent(),[3,9];case 8:return s.sent(),[3,9];case 9:return[2,{status:i.status,json:o}]}}))}))},t.prototype.getAppCheckToken=function(){return Ft(this,void 0,void 0,(function(){var t;return Vt(this,(function(e){switch(e.label){case 0:return(t=this.appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype.call=function(t,e,n){return Ft(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h,f,d;return Vt(this,(function(p){switch(p.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(s=p.sent()).authToken&&(o.Authorization="Bearer "+s.authToken),s.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=s.instanceIdToken),a=n.timeout||7e4,u=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new Xv("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(a),c=u.timer,l=u.promise,[4,Promise.race([ng(c,this.postJSON(r,i,o)),l,ng(c,this.cancelAllRequests)])];case 2:if(!(h=p.sent()))throw new Xv("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var s=e&&e.error;if(s){var a=s.status;if("string"==typeof a){if(!Yv[a])return new Xv("internal","internal");r=Yv[a],i=a}var u=s.message;"string"==typeof u&&(i=u),void 0!==(o=s.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new Xv(r,i,o)}(h.status,h.json,this.serializer))throw f;if(!h.json)throw new Xv("internal","Response is not valid JSON object.");if(void 0===(d=h.json.data)&&(d=h.json.result),void 0===d)throw new Xv("internal","Response is missing data field.");return[2,{data:this.serializer.decode(d)}]}}))}))},t}();function ng(t,e){return Ft(this,void 0,void 0,(function(){var n;return Vt(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
!function(t,e){var n={Functions:eg};t.INTERNAL.registerComponent(new ne("functions",(function(t,n){var r=n.instanceIdentifier,i=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal"),a=t.getProvider("messaging");return new eg(i,o,a,s,r,e)}),"PUBLIC").setServiceProps(n).setMultipleInstances(!0))}(Ce,fetch.bind(self)),Ce.registerVersion("@firebase/functions","0.6.13");Ce.initializeApp({apiKey:"AIzaSyAq59lK80pPZj_-DmD8swIckq2TYTt8Meo",authDomain:"anime-corner-rankings.firebaseapp.com",projectId:"anime-corner-rankings",storageBucket:"anime-corner-rankings.appspot.com",messagingSenderId:"1056575402361",appId:"1:1056575402361:web:0fd9790f5ef43a94897fa8",measurementId:"G-264NJGB06X"});const rg=Ce.firestore(),ig=Ce.functions();function og(e){let n,r;return{c(){n=T("div"),r=A(e[0]),x(n,"class","svelte-w1ujin")},m(t,e){E(t,n,e),m(n,r)},p(t,[e]){1&e&&R(r,t[0])},i:t,o:t,d(t){t&&I(n)}}}function sg(t,e,n){let{rank:r}=e;return t.$$set=t=>{"rank"in t&&n(0,r=t.rank)},[r]}class ag extends St{constructor(t){super(),Tt(this,t,sg,og,a,{rank:0})}}function ug(e){let n,r,i;return{c(){n=T("div"),r=T("div"),i=A(e[1]),x(r,"class","title svelte-ps336j"),x(n,"class","banner svelte-ps336j"),O(n,"background-image","linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url("+e[0]+")")},m(t,e){E(t,n,e),m(n,r),m(r,i)},p(t,[e]){2&e&&R(i,t[1]),1&e&&O(n,"background-image","linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url("+t[0]+")")},i:t,o:t,d(t){t&&I(n)}}}function cg(t,e,n){let{banner:r}=e,{title:i}=e;return t.$$set=t=>{"banner"in t&&n(0,r=t.banner),"title"in t&&n(1,i=t.title)},[r,i]}class lg extends St{constructor(t){super(),Tt(this,t,cg,ug,a,{banner:0,title:1})}}function hg(t){let e,n,r,i;return{c(){e=S("svg"),n=S("path"),r=k(),i=A(t[4]),x(n,"d","M24 22h-24l12-20z"),x(e,"class","arrow-gain svelte-63vq6l"),x(e,"xmlns","http://www.w3.org/2000/svg"),x(e,"width","16"),x(e,"height","16"),x(e,"viewBox","0 0 24 24")},m(t,o){E(t,e,o),m(e,n),E(t,r,o),E(t,i,o)},p(t,e){16&e&&R(i,t[4])},d(t){t&&I(e),t&&I(r),t&&I(i)}}}function fg(t){let e,n,r,i;return{c(){e=S("svg"),n=S("path"),r=k(),i=A(t[4]),x(n,"d","M0 9h24v6h-24z"),x(e,"class","arrow-neutral svelte-63vq6l"),x(e,"xmlns","http://www.w3.org/2000/svg"),x(e,"width","16"),x(e,"height","16"),x(e,"viewBox","0 0 24 24")},m(t,o){E(t,e,o),m(e,n),E(t,r,o),E(t,i,o)},p(t,e){16&e&&R(i,t[4])},d(t){t&&I(e),t&&I(r),t&&I(i)}}}function dg(t){let e,n,r,i,o=t[4].toString().replace("-","")+"";return{c(){e=S("svg"),n=S("path"),r=k(),i=A(o),x(n,"d","M12 21l-12-18h24z"),x(e,"class","arrow-drop svelte-63vq6l"),x(e,"xmlns","http://www.w3.org/2000/svg"),x(e,"width","16"),x(e,"height","16"),x(e,"viewBox","0 0 24 24")},m(t,o){E(t,e,o),m(e,n),E(t,r,o),E(t,i,o)},p(t,e){16&e&&o!==(o=t[4].toString().replace("-","")+"")&&R(i,o)},d(t){t&&I(e),t&&I(r),t&&I(i)}}}function pg(t){let e,n,r;return{c(){e=T("div"),n=A("From Rank "),r=A(t[1]),x(e,"class","label svelte-63vq6l"),M(e,"gain",t[4]>0),M(e,"drop",t[4]<0)},m(t,i){E(t,e,i),m(e,n),m(e,r)},p(t,n){2&n&&R(r,t[1]),16&n&&M(e,"gain",t[4]>0),16&n&&M(e,"drop",t[4]<0)},d(t){t&&I(e)}}}function vg(t){let e;return{c(){e=T("div"),e.textContent="Same Rank",x(e,"class","label svelte-63vq6l"),M(e,"neutral",t[1]==t[0])},m(t,n){E(t,e,n)},p(t,n){3&n&&M(e,"neutral",t[1]==t[0])},d(t){t&&I(e)}}}function gg(t){let e;return{c(){e=T("div"),e.textContent="New Entry",x(e,"class","label svelte-63vq6l"),M(e,"neutral",null==t[1])},m(t,n){E(t,e,n)},p(t,n){2&n&&M(e,"neutral",null==t[1])},d(t){t&&I(e)}}}function yg(t){let e;return{c(){e=T("div"),e.textContent="New Entry",x(e,"class","label border-br svelte-63vq6l"),M(e,"neutral",0==t[5]),M(e,"no-border-br",t[3])},m(t,n){E(t,e,n)},p(t,n){32&n&&M(e,"neutral",0==t[5]),8&n&&M(e,"no-border-br",t[3])},d(t){t&&I(e)}}}function mg(t){let e,n,r;return{c(){e=T("div"),n=A(t[5]),r=A("% Drop"),x(e,"class","label border-br svelte-63vq6l"),M(e,"drop",t[5]<0),M(e,"no-border-br",t[3])},m(t,i){E(t,e,i),m(e,n),m(e,r)},p(t,r){32&r&&R(n,t[5]),32&r&&M(e,"drop",t[5]<0),8&r&&M(e,"no-border-br",t[3])},d(t){t&&I(e)}}}function bg(t){let e,n,r,i;return{c(){e=T("div"),n=A("+"),r=A(t[5]),i=A("% Gain"),x(e,"class","label border-br svelte-63vq6l"),M(e,"gain",t[5]>0),M(e,"no-border-br",t[3])},m(t,o){E(t,e,o),m(e,n),m(e,r),m(e,i)},p(t,n){32&n&&R(r,t[5]),32&n&&M(e,"gain",t[5]>0),8&n&&M(e,"no-border-br",t[3])},d(t){t&&I(e)}}}function wg(e){let n,r,i,o,s,a,u,c,l,h;function f(t,e){return t[4]<0?dg:0===t[4]?fg:hg}let d=f(e),p=d(e);function v(t,e){return null==t[1]?gg:t[1]==t[0]?vg:pg}let g=v(e),y=g(e);function b(t,e){return t[5]>0?bg:t[5]<0?mg:yg}let w=b(e),_=w(e);return{c(){n=T("div"),r=T("div"),i=T("div"),p.c(),o=k(),y.c(),s=k(),a=T("div"),u=T("div"),c=A(e[2]),l=A("%"),h=k(),_.c(),x(i,"class","figure svelte-63vq6l"),x(r,"class","sub-container svelte-63vq6l"),x(u,"class","figure border-br svelte-63vq6l"),x(a,"class","sub-container border-br svelte-63vq6l"),x(n,"class","container border-tr border-br svelte-63vq6l")},m(t,e){E(t,n,e),m(n,r),m(r,i),p.m(i,null),m(r,o),y.m(r,null),m(n,s),m(n,a),m(a,u),m(u,c),m(u,l),m(a,h),_.m(a,null)},p(t,[e]){d===(d=f(t))&&p?p.p(t,e):(p.d(1),p=d(t),p&&(p.c(),p.m(i,null))),g===(g=v(t))&&y?y.p(t,e):(y.d(1),y=g(t),y&&(y.c(),y.m(r,null))),4&e&&R(c,t[2]),w===(w=b(t))&&_?_.p(t,e):(_.d(1),_=w(t),_&&(_.c(),_.m(a,null)))},i:t,o:t,d(t){t&&I(n),p.d(),y.d(),_.d()}}}function Eg(t,e,n){let r,i,{rank:o}=e,{previousRank:s}=e,{votes:a}=e,{previousVotes:u}=e,{isActive:c}=e;return function(t){K().$$.after_update.push(t)}((()=>{n(4,r=function(t,e){return null==e?0:t<e?e-t:e==t?0:e-t}(o,s)),n(5,i=function(t,e){if(null==e)return 0;return(t-e).toFixed(2)}(a,u))})),t.$$set=t=>{"rank"in t&&n(0,o=t.rank),"previousRank"in t&&n(1,s=t.previousRank),"votes"in t&&n(2,a=t.votes),"previousVotes"in t&&n(6,u=t.previousVotes),"isActive"in t&&n(3,c=t.isActive)},[o,s,a,c,r,i,u]}class Ig extends St{constructor(t){super(),Tt(this,t,Eg,wg,a,{rank:0,previousRank:1,votes:2,previousVotes:6,isActive:3})}}function _g(t){let e,n=localStorage.getItem(`${t}`);return n&&(n=JSON.parse(n),e=parseInt(Date.now()/1e3)-n.cachetime>86400),{cachedData:n,expired:e}}function Tg(t,e){const n={data:e,cachetime:parseInt(Date.now()/1e3)};localStorage.setItem(`${t}`,JSON.stringify(n))}function Sg(t,e,n){const r=t.slice();return r[13]=e[n],r}function Ag(t,e,n){const r=t.slice();return r[9]=e[n],r}function kg(t){let e,n,r,i,o,s,a,u,c,l,h,f,d,p,v=t[9],g=[];for(let e=0;e<v.length;e+=1)g[e]=Ng(Ag(t,v,e));const y=[Cg,Dg],b=[];function w(t,e){return 0==t[8].length?0:1}return c=w(t),l=b[c]=y[c](t),{c(){e=T("div"),n=T("div"),r=T("h2"),i=A(t[2]),o=k(),s=T("div");for(let t=0;t<g.length;t+=1)g[t].c();a=k(),u=T("div"),l.c(),h=k(),f=new F,x(r,"class","title svelte-gd335j"),x(s,"class","pills svelte-gd335j"),x(u,"class","links svelte-gd335j"),f.a=null,x(e,"class","card-content svelte-gd335j")},m(l,d){E(l,e,d),m(e,n),m(n,r),m(r,i),m(e,o),m(e,s);for(let t=0;t<g.length;t+=1)g[t].m(s,null);m(e,a),m(e,u),b[c].m(u,null),m(e,h),f.m(t[7],e),p=!0},p(t,e){if((!p||4&e)&&R(i,t[2]),512&e){let n;for(v=t[9],n=0;n<v.length;n+=1){const r=Ag(t,v,n);g[n]?g[n].p(r,e):(g[n]=Ng(r),g[n].c(),g[n].m(s,null))}for(;n<g.length;n+=1)g[n].d(1);g.length=v.length}let n=c;c=w(t),c===n?b[c].p(t,e):(ut(),ht(b[n],1,1,(()=>{b[n]=null})),ct(),l=b[c],l?l.p(t,e):(l=b[c]=y[c](t),l.c()),lt(l,1),l.m(u,null)),(!p||128&e)&&f.p(t[7])},i(t){p||(lt(l),J((()=>{d||(d=dt(e,Dt,{duration:200},!0)),d.run(1)})),p=!0)},o(t){ht(l),d||(d=dt(e,Dt,{duration:200},!1)),d.run(0),p=!1},d(t){t&&I(e),_(g,t),b[c].d(),t&&d&&d.end()}}}function Ng(t){let e,n,r=t[9]+"";return{c(){e=T("div"),n=A(r),x(e,"class","pill svelte-gd335j")},m(t,r){E(t,e,r),m(e,n)},p(t,e){512&e&&r!==(r=t[9]+"")&&R(n,r)},d(t){t&&I(e)}}}function Dg(t){let e,n,r,i=t[8],o=[];for(let e=0;e<i.length;e+=1)o[e]=Ug(Sg(t,i,e));const s=t=>ht(o[t],1,1,(()=>{o[t]=null}));return{c(){e=A("Watch on:\n          ");for(let t=0;t<o.length;t+=1)o[t].c();n=N()},m(t,i){E(t,e,i);for(let e=0;e<o.length;e+=1)o[e].m(t,i);E(t,n,i),r=!0},p(t,e){if(3328&e){let r;for(i=t[8],r=0;r<i.length;r+=1){const s=Sg(t,i,r);o[r]?(o[r].p(s,e),lt(o[r],1)):(o[r]=Ug(s),o[r].c(),lt(o[r],1),o[r].m(n.parentNode,n))}for(ut(),r=i.length;r<o.length;r+=1)s(r);ct()}},i(t){if(!r){for(let t=0;t<i.length;t+=1)lt(o[t]);r=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)ht(o[t]);r=!1},d(t){t&&I(e),_(o,t),t&&I(n)}}}function Cg(e){let n;return{c(){n=A("Could not find on Crunchyroll or Funimation ")},m(t,e){E(t,n,e)},p:t,i:t,o:t,d(t){t&&I(n)}}}function xg(t){let e,n,r={ctx:t,current:null,token:null,hasCatch:!1,pending:Pg,then:Lg,catch:Og,value:16,blocks:[,,,]};return pt(t[11](),r),{c(){e=N(),r.block.c()},m(t,i){E(t,e,i),r.block.m(t,r.anchor=i),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(e,n){vt(r,t=e,n)},i(t){n||(lt(r.block),n=!0)},o(t){for(let t=0;t<3;t+=1){ht(r.blocks[t])}n=!1},d(t){t&&I(e),r.block.d(t),r.token=null,r=null}}}function Rg(t){let e,n,r={ctx:t,current:null,token:null,hasCatch:!1,pending:Vg,then:Fg,catch:Mg,value:16,blocks:[,,,]};return pt(t[10](),r),{c(){e=N(),r.block.c()},m(t,i){E(t,e,i),r.block.m(t,r.anchor=i),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(e,n){vt(r,t=e,n)},i(t){n||(lt(r.block),n=!0)},o(t){for(let t=0;t<3;t+=1){ht(r.blocks[t])}n=!1},d(t){t&&I(e),r.block.d(t),r.token=null,r=null}}}function Og(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function Lg(e){let n,r,i,o,s;return{c(){n=T("a"),r=T("img"),s=k(),c(r.src,i=e[16])||x(r,"src",i),x(r,"alt","Funimation Logo"),x(r,"class","funimation svelte-gd335j"),x(n,"href",o=e[13].url),x(n,"class","link svelte-gd335j"),x(n,"target","_blank")},m(t,e){E(t,n,e),m(n,r),E(t,s,e)},p(t,e){256&e&&o!==(o=t[13].url)&&x(n,"href",o)},i:t,o:t,d(t){t&&I(n),t&&I(s)}}}function Pg(e){let n,r,i;return n=new Ot({props:{size:"32",unit:"px",color:"#65b893"}}),{c(){wt(n.$$.fragment),r=k()},m(t,e){Et(n,t,e),E(t,r,e),i=!0},p:t,i(t){i||(lt(n.$$.fragment,t),i=!0)},o(t){ht(n.$$.fragment,t),i=!1},d(t){It(n,t),t&&I(r)}}}function Mg(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function Fg(e){let n,r,i,o,s;return{c(){n=T("a"),r=T("img"),s=k(),c(r.src,i=e[16])||x(r,"src",i),x(r,"alt","Crunchyroll Logo"),x(r,"class","crunchyroll svelte-gd335j"),x(n,"href",o=e[13].url),x(n,"class","link svelte-gd335j"),x(n,"target","_blank")},m(t,e){E(t,n,e),m(n,r),E(t,s,e)},p(t,e){256&e&&o!==(o=t[13].url)&&x(n,"href",o)},i:t,o:t,d(t){t&&I(n),t&&I(s)}}}function Vg(e){let n,r,i;return n=new Ot({props:{size:"32",unit:"px",color:"#65b893"}}),{c(){wt(n.$$.fragment),r=k()},m(t,e){Et(n,t,e),E(t,r,e),i=!0},p:t,i(t){i||(lt(n.$$.fragment,t),i=!0)},o(t){ht(n.$$.fragment,t),i=!1},d(t){It(n,t),t&&I(r)}}}function Ug(t){let e,n,r,i;const o=[Rg,xg],s=[];function a(t,e){return"Crunchyroll"==t[13].site?0:"Funimation"==t[13].site?1:-1}return~(e=a(t))&&(n=s[e]=o[e](t)),{c(){n&&n.c(),r=N()},m(t,n){~e&&s[e].m(t,n),E(t,r,n),i=!0},p(t,i){let u=e;e=a(t),e===u?~e&&s[e].p(t,i):(n&&(ut(),ht(s[u],1,1,(()=>{s[u]=null})),ct()),~e?(n=s[e],n?n.p(t,i):(n=s[e]=o[e](t),n.c()),lt(n,1),n.m(r.parentNode,r)):n=null)},i(t){i||(lt(n),i=!0)},o(t){ht(n),i=!1},d(t){~e&&s[e].d(t),t&&I(r)}}}function qg(t){let e,n,r,i,s,a,u,c,l,h,f;r=new ag({props:{rank:t[1]}}),s=new lg({props:{banner:t[4],title:t[2]}}),u=new Ig({props:{rank:t[1],previousRank:t[5],votes:t[3],previousVotes:t[6],isActive:t[0]}});let d=t[0]&&kg(t);return{c(){e=T("div"),n=T("div"),wt(r.$$.fragment),i=k(),wt(s.$$.fragment),a=k(),wt(u.$$.fragment),c=k(),d&&d.c(),x(n,"class","card svelte-gd335j"),x(n,"tabindex","0"),x(e,"class","wrapper svelte-gd335j")},m(o,p){E(o,e,p),m(e,n),Et(r,n,null),m(n,i),Et(s,n,null),m(n,a),Et(u,n,null),m(e,c),d&&d.m(e,null),l=!0,h||(f=[D(n,"click",t[12]),D(n,"keypress",C(t[12]))],h=!0)},p(t,[n]){const i={};2&n&&(i.rank=t[1]),r.$set(i);const o={};16&n&&(o.banner=t[4]),4&n&&(o.title=t[2]),s.$set(o);const a={};2&n&&(a.rank=t[1]),32&n&&(a.previousRank=t[5]),8&n&&(a.votes=t[3]),64&n&&(a.previousVotes=t[6]),1&n&&(a.isActive=t[0]),u.$set(a),t[0]?d?(d.p(t,n),1&n&&lt(d,1)):(d=kg(t),d.c(),lt(d,1),d.m(e,null)):d&&(ut(),ht(d,1,1,(()=>{d=null})),ct())},i(t){l||(lt(r.$$.fragment,t),lt(s.$$.fragment,t),lt(u.$$.fragment,t),lt(d),l=!0)},o(t){ht(r.$$.fragment,t),ht(s.$$.fragment,t),ht(u.$$.fragment,t),ht(d),l=!1},d(t){t&&I(e),It(r),It(s),It(u),d&&d.d(),h=!1,o(f)}}}function jg(t,e,n){let{rank:r}=e,{title:i}=e,{votes:o}=e,{banner:s}=e,{previousRank:a}=e,{previousVotes:u}=e,{description:c}=e,{genres:l}=e,{externalLinks:h}=e,{isActive:f}=e;return t.$$set=t=>{"rank"in t&&n(1,r=t.rank),"title"in t&&n(2,i=t.title),"votes"in t&&n(3,o=t.votes),"banner"in t&&n(4,s=t.banner),"previousRank"in t&&n(5,a=t.previousRank),"previousVotes"in t&&n(6,u=t.previousVotes),"description"in t&&n(7,c=t.description),"genres"in t&&n(9,l=t.genres),"externalLinks"in t&&n(8,h=t.externalLinks),"isActive"in t&&n(0,f=t.isActive)},[f,r,i,o,s,a,u,c,h,l,async()=>{const t="crunchyroll",e=_g(t);let n;return e.cachedData&&!e.expired?n=e.cachedData.data:(n=await rg.collection("logos").doc("crunchyroll").get().then((t=>t.data().url)),Tg(t,n)),n},async()=>{const t="funimation",e=_g(t);let n;return e.cachedData&&!e.expired?n=e.cachedData.data:(n=await rg.collection("logos").doc("funimation").get().then((t=>t.data().url)),Tg(t,n)),n},function(){n(0,f=!f)}]}class Bg extends St{constructor(t){super(),Tt(this,t,jg,qg,a,{rank:1,title:2,votes:3,banner:4,previousRank:5,previousVotes:6,description:7,genres:9,externalLinks:8,isActive:0})}}const zg=[];function $g(e,n=t){let r;const i=new Set;function o(t){if(a(e,t)&&(e=t,r)){const t=!zg.length;for(const t of i)t[1](),zg.push(t,e);if(t){for(let t=0;t<zg.length;t+=2)zg[t][0](zg[t+1]);zg.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const u=[s,a];return i.add(u),1===i.size&&(r=n(o)||t),s(e),()=>{i.delete(u),0===i.size&&(r(),r=null)}}}}const Kg=$g("2021"),Gg=$g("Summer"),Hg=$g("Week-07"),Qg=$g(1),Wg=$g(!1),Yg=$g([{question:"What is Anime Corner Rankings?",answer:"This site tracks the weekly rankings released by Anime Corner, an online community that provides news, highlights and articles on the anime industry. In particular the site displays their list in an interactive leaderboard that can expand to show you more information about a show if it catches your interest."},{question:"Where does the data come from?",answer:"The poll data is collected by Anime Corner and published on their <a href='https://animecorner.me/category/anime-corner/rankings/anime-of-the-week/' target='_blank'>website</a>. If you're curious about how the data is collected and calculated you can learn more about it <a href='https://animecorner.me/polls/' target='_blank'>here</a>.<br /><br />Data about each anime is provided by <a href='https://anilist.co/' target='_blank'>Anilist</a> & <a href='https://kitsu.io/' target='_blank'>Kitsu</a>."},{question:"How often are the rankings updated?",answer:"The rankings are updated every Friday at approximately 13:00pm UTC."},{question:"How can I vote?",answer:"You can cast your vote over at <a href='https://polls.animecorner.me/' target='_blank'>polls.animecorner.me</a>"},{question:"Are there similar rankings out there?",answer:"Yes this site was actually inspired by some of these sites here:<br /><ul><li><a href='https://animekarmalist.com/' target='_blank'>animekarmalist.com</a></li><li><a href='https://animekarmawatch.com/' target='_blank'>animekarmawatch.com</a></li><li><a href='https://animetrics.co/' target='_blank'>animetrics.co</a></li><li><a href='https://anitrendz.net/' target='_blank'>anitrendz.net</a></li></ul>"},{question:"How can I contact you?",answer:"If you have any have questions, feedback or suggestions about the site, please feel free and create an issue on the <a href='https://github.com/arlandfran/anime-corner-rankings/issues' target=''_blank>project repository</a> or even better make a PR yourself!"}]);function Xg(t){let e,n,r;return{c(){e=T("div"),x(e,"class","panel svelte-11l3acu")},m(n,i){E(n,e,i),e.innerHTML=t[3],r=!0},p(t,n){(!r||8&n)&&(e.innerHTML=t[3])},i(t){r||(J((()=>{n||(n=dt(e,Dt,{duration:200},!0)),n.run(1)})),r=!0)},o(t){n||(n=dt(e,Dt,{duration:200},!1)),n.run(0),r=!1},d(t){t&&I(e),t&&n&&n.end()}}}function Jg(t){let e,n,r,i,s,a,u,c,l=(t[1]||t[0])&&Xg(t);return{c(){e=T("div"),n=T("h3"),r=A(t[2]),i=k(),l&&l.c(),s=N(),x(n,"class","svelte-11l3acu"),x(e,"class","accordion svelte-11l3acu"),x(e,"tabindex","0"),M(e,"active",t[1])},m(o,h){E(o,e,h),m(e,n),m(n,r),E(o,i,h),l&&l.m(o,h),E(o,s,h),a=!0,u||(c=[D(e,"click",t[4]),D(e,"keypress",t[4])],u=!0)},p(t,[n]){(!a||4&n)&&R(r,t[2]),2&n&&M(e,"active",t[1]),t[1]||t[0]?l?(l.p(t,n),3&n&&lt(l,1)):(l=Xg(t),l.c(),lt(l,1),l.m(s.parentNode,s)):l&&(ut(),ht(l,1,1,(()=>{l=null})),ct())},i(t){a||(lt(l),a=!0)},o(t){ht(l),a=!1},d(t){t&&I(e),t&&I(i),l&&l.d(t),t&&I(s),u=!1,o(c)}}}function Zg(t,e,n){let{question:r}=e,{answer:i}=e,{showAll:o}=e,{showDropdown:s}=e;return t.$$set=t=>{"question"in t&&n(2,r=t.question),"answer"in t&&n(3,i=t.answer),"showAll"in t&&n(0,o=t.showAll),"showDropdown"in t&&n(1,s=t.showDropdown)},[o,s,r,i,function(){o?(n(0,o=!1),n(1,s=!1)):n(1,s=!s)}]}class ty extends St{constructor(t){super(),Tt(this,t,Zg,Jg,a,{question:2,answer:3,showAll:0,showDropdown:1})}}function ey(t,e,n){const r=t.slice();return r[12]=e[n],r}function ny(e){let n,r,i,a,u,c,l,h,f,d,p,v,g,y,b,w,S,N,C,R,O,L,P,F,V,U,q,j,B,z,$,K,G,H,Q=e[3],W=[];for(let t=0;t<Q.length;t+=1)W[t]=ry(ey(e,Q,t));const Y=t=>ht(W[t],1,1,(()=>{W[t]=null}));return{c(){n=T("div"),r=T("div"),i=k(),a=T("div"),u=T("div"),c=T("button"),c.innerHTML='<svg id="svg-close" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="#fff" preserveAspectRatio="xMidYMid meet" class="svelte-64hn7n"><path d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"></path></svg>',l=k(),h=T("div"),f=T("div"),f.innerHTML='<h1 class="svelte-64hn7n">About</h1>',d=k(),p=T("h2"),p.textContent="Navigation",v=k(),g=T("p"),g.innerHTML='Use the A D,\n          <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="#fff"><path d="M16.67 0l2.83 2.829-9.339 9.175 9.339 9.167-2.83 2.829-12.17-11.996z"></path></svg> \n          <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="#fff"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg> keys to navigate back and forth the weekly ranking.',y=k(),b=T("h2"),b.textContent="Legend",w=k(),S=T("ul"),S.innerHTML='<li><svg class="arrow-gain svelte-64hn7n" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path d="M24 22h-24l12-20z"></path></svg> \n            <svg class="arrow-drop svelte-64hn7n" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path d="M12 21l-12-18h24z"></path></svg> \n            <svg class="arrow-neutral svelte-64hn7n" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path d="M0 9h24v6h-24z"></path></svg>\n            Rank Progression</li> \n          <li>% Vote Percentage</li>',N=k(),C=T("h2"),C.textContent="FAQ",R=k(),O=T("div"),L=T("button"),P=A("Expand All"),F=A("\n          |\n          "),V=T("button"),U=A("Collapse All"),j=k();for(let t=0;t<W.length;t+=1)W[t].c();x(r,"class","backdrop svelte-64hn7n"),x(c,"aria-label","Open About"),x(u,"class","close svelte-64hn7n"),x(f,"class","title svelte-64hn7n"),x(p,"class","svelte-64hn7n"),x(b,"class","svelte-64hn7n"),x(C,"class","svelte-64hn7n"),x(L,"id","expand"),L.disabled=e[0],x(L,"class","svelte-64hn7n"),M(L,"active",!e[0]),M(L,"disabled",e[0]),x(V,"id","collapse"),V.disabled=q=!e[0],x(V,"class","svelte-64hn7n"),M(V,"active",e[0]),M(V,"disabled",!e[0]),x(O,"class","expand-toggles"),x(h,"class","content svelte-64hn7n"),x(a,"class","content-wrapper svelte-64hn7n"),x(n,"class","modal svelte-64hn7n"),x(n,"tabindex","0")},m(o,I){E(o,n,I),m(n,r),m(n,i),m(n,a),m(a,u),m(u,c),m(a,l),m(a,h),m(h,f),m(h,d),m(h,p),m(h,v),m(h,g),m(h,y),m(h,b),m(h,w),m(h,S),m(h,N),m(h,C),m(h,R),m(h,O),m(O,L),m(L,P),m(O,F),m(O,V),m(V,U),m(h,j);for(let t=0;t<W.length;t+=1)W[t].m(h,null);var _;K=!0,G||(H=[D(c,"click",e[6]),D(L,"click",e[7]),D(V,"click",e[8]),(_=z=e[9].call(null,n),_&&s(_.destroy)?_.destroy:t)],G=!0)},p(t,e){if((!K||1&e)&&(L.disabled=t[0]),1&e&&M(L,"active",!t[0]),1&e&&M(L,"disabled",t[0]),(!K||1&e&&q!==(q=!t[0]))&&(V.disabled=q),1&e&&M(V,"active",t[0]),1&e&&M(V,"disabled",!t[0]),11&e){let n;for(Q=t[3],n=0;n<Q.length;n+=1){const r=ey(t,Q,n);W[n]?(W[n].p(r,e),lt(W[n],1)):(W[n]=ry(r),W[n].c(),lt(W[n],1),W[n].m(h,null))}for(ut(),n=Q.length;n<W.length;n+=1)Y(n);ct()}},i(t){if(!K){for(let t=0;t<Q.length;t+=1)lt(W[t]);J((()=>{B||(B=dt(a,Nt,{y:50,duration:200},!0)),B.run(1)})),J((()=>{$||($=dt(n,kt,{duration:200},!0)),$.run(1)})),K=!0}},o(t){W=W.filter(Boolean);for(let t=0;t<W.length;t+=1)ht(W[t]);B||(B=dt(a,Nt,{y:50,duration:200},!1)),B.run(0),$||($=dt(n,kt,{duration:200},!1)),$.run(0),K=!1},d(t){t&&I(n),_(W,t),t&&B&&B.end(),t&&$&&$.end(),G=!1,o(H)}}}function ry(t){let e,r;const i=[t[12],{showAll:t[0]},{showDropdown:t[1]}];let o={};for(let t=0;t<i.length;t+=1)o=n(o,i[t]);return e=new ty({props:o}),{c(){wt(e.$$.fragment)},m(t,n){Et(e,t,n),r=!0},p(t,n){const r=11&n?mt(i,[8&n&&bt(t[12]),1&n&&{showAll:t[0]},2&n&&{showDropdown:t[1]}]):{};e.$set(r)},i(t){r||(lt(e.$$.fragment,t),r=!0)},o(t){ht(e.$$.fragment,t),r=!1},d(t){It(e,t)}}}function iy(t){let e,n,r,i,o,s,a,u=t[2]&&ny(t);return{c(){e=T("div"),n=T("button"),n.innerHTML='<svg id="svg-info" width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" class="svelte-64hn7n"><path d="M24 17.981h-13l-7 5.02v-5.02h-4v-16.981h24v16.981zm-11-9.98h-2v6h2v-6zm-1-1.5c.69 0 1.25-.56 1.25-1.25s-.56-1.25-1.25-1.25-1.25.56-1.25 1.25.56 1.25 1.25 1.25z"></path></svg>',r=k(),u&&u.c(),i=N(),x(n,"class","about svelte-64hn7n")},m(c,l){E(c,e,l),m(e,n),E(c,r,l),u&&u.m(c,l),E(c,i,l),o=!0,s||(a=D(n,"click",t[5]),s=!0)},p(t,[e]){t[2]?u?(u.p(t,e),4&e&&lt(u,1)):(u=ny(t),u.c(),lt(u,1),u.m(i.parentNode,i)):u&&(ut(),ht(u,1,1,(()=>{u=null})),ct())},i(t){o||(lt(u),o=!0)},o(t){ht(u),o=!1},d(t){t&&I(e),t&&I(r),u&&u.d(t),t&&I(i),s=!1,a()}}}function oy(t){t.target.focus()}function sy(t,e,n){let r,i;l(t,Yg,(t=>n(3,i=t)));const o=function(t){const e=$g(t),{set:n}=e;return{isOpen:e,open:()=>n(!0),close:()=>n(!1)}}(!1),{isOpen:s,open:a,close:u}=o;l(t,s,(t=>n(2,r=t)));let c=!1,h=!1;function f(t){t.stopPropagation(),"Escape"===t.key&&u()}return[c,h,r,i,s,a,u,function(){n(0,c=!0),n(1,h=!0)},function(){n(0,c=!1),n(1,h=!1)},function(t){const e=[];if("hidden"!==document.body.style.overflow){const t=document.body.style.overflow;document.body.style.overflow="hidden",e.push((()=>{document.body.style.overflow=t}))}return t.addEventListener("keydown",f),t.addEventListener("transitionend",oy),t.focus(),e.push((()=>{t.removeEventListener("keydown",f),t.removeEventListener("transitionend",oy)})),{destroy:()=>e.forEach((t=>t()))}}]}class ay extends St{constructor(t){super(),Tt(this,t,sy,iy,a,{})}}function uy(t,e,n){const r=t.slice();return r[33]=e[n],r}function cy(t,e,n){const r=t.slice();return r[36]=e[n],r}function ly(t,e,n){const r=t.slice();return r[39]=e[n],r}function hy(t){let e,n,r,i=t[0],s=[];for(let e=0;e<i.length;e+=1)s[e]=dy(ly(t,i,e));return{c(){e=T("select");for(let t=0;t<s.length;t+=1)s[t].c();x(e,"aria-label","Select Season"),void 0===t[7]&&J((()=>t[15].call(e)))},m(i,o){E(i,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);L(e,t[7]),n||(r=[D(e,"change",t[15]),D(e,"change",t[11])],n=!0)},p(t,n){if(1&n[0]){let r;for(i=t[0],r=0;r<i.length;r+=1){const o=ly(t,i,r);s[r]?s[r].p(o,n):(s[r]=dy(o),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=i.length}129&n[0]&&L(e,t[7])},d(t){t&&I(e),_(s,t),n=!1,o(r)}}}function fy(e){let n,r;return{c(){n=T("select"),r=T("option"),r.textContent="Loading...",r.__value="",r.value=r.__value,x(n,"aria-label","Select Season")},m(t,e){E(t,n,e),m(n,r)},p:t,d(t){t&&I(n)}}}function dy(t){let e,n,r,i=t[39]+"";return{c(){e=T("option"),n=A(i),x(e,"class","dropdown-item svelte-168ebyw"),e.__value=r=t[39],e.value=e.__value},m(t,r){E(t,e,r),m(e,n)},p(t,o){1&o[0]&&i!==(i=t[39]+"")&&R(n,i),1&o[0]&&r!==(r=t[39])&&(e.__value=r,e.value=e.__value)},d(t){t&&I(e)}}}function py(t){let e,n,r,i=t[1],s=[];for(let e=0;e<i.length;e+=1)s[e]=gy(cy(t,i,e));return{c(){e=T("select");for(let t=0;t<s.length;t+=1)s[t].c();x(e,"aria-label","Select Week"),void 0===t[6]&&J((()=>t[16].call(e)))},m(i,o){E(i,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);L(e,t[6]),n||(r=[D(e,"change",t[16]),D(e,"change",t[12])],n=!0)},p(t,n){if(2&n[0]){let r;for(i=t[1],r=0;r<i.length;r+=1){const o=cy(t,i,r);s[r]?s[r].p(o,n):(s[r]=gy(o),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=i.length}66&n[0]&&L(e,t[6])},d(t){t&&I(e),_(s,t),n=!1,o(r)}}}function vy(e){let n,r;return{c(){n=T("select"),r=T("option"),r.textContent="Loading...",r.__value="",r.value=r.__value,x(n,"aria-label","Select Week")},m(t,e){E(t,n,e),m(n,r)},p:t,d(t){t&&I(n)}}}function gy(t){let e,n,r,i,o=parseInt(t[36].split("-")[1])+"";return{c(){e=T("option"),n=A("Week "),r=A(o),x(e,"class","dropdown-item svelte-168ebyw"),e.__value=i=t[36],e.value=e.__value},m(t,i){E(t,e,i),m(e,n),m(e,r)},p(t,n){2&n[0]&&o!==(o=parseInt(t[36].split("-")[1])+"")&&R(r,o),2&n[0]&&i!==(i=t[36])&&(e.__value=i,e.value=e.__value)},d(t){t&&I(e)}}}function yy(t){let e,n,r=[],i=new Map,o=t[2];const s=t=>t[33].title;for(let e=0;e<o.length;e+=1){let n=uy(t,o,e),a=s(n);i.set(a,r[e]=by(a,n))}return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=N()},m(t,i){for(let e=0;e<r.length;e+=1)r[e].m(t,i);E(t,e,i),n=!0},p(t,n){if(260&n[0]){o=t[2],ut();for(let t=0;t<r.length;t+=1)r[t].r();r=function(t,e,n,r,i,o,s,a,u,c,l,h){let f=t.length,d=o.length,p=f;const v={};for(;p--;)v[t[p].key]=p;const g=[],y=new Map,m=new Map;for(p=d;p--;){const t=h(i,o,p),a=n(t);let u=s.get(a);u?r&&u.p(t,e):(u=c(a,t),u.c()),y.set(a,g[p]=u),a in v&&m.set(a,Math.abs(p-v[a]))}const b=new Set,w=new Set;function E(t){lt(t,1),t.m(a,l),s.set(t.key,t),l=t.first,d--}for(;f&&d;){const e=g[d-1],n=t[f-1],r=e.key,i=n.key;e===n?(l=e.first,f--,d--):y.has(i)?!s.has(r)||b.has(r)?E(e):w.has(i)?f--:m.get(r)>m.get(i)?(w.add(r),E(e)):(b.add(i),f--):(u(n,s),f--)}for(;f--;){const e=t[f];y.has(e.key)||u(e,s)}for(;d;)E(g[d-1]);return g}(r,n,s,1,t,o,i,e.parentNode,yt,by,e,uy);for(let t=0;t<r.length;t+=1)r[t].a();ct()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)lt(r[t]);n=!0}},o(t){for(let t=0;t<r.length;t+=1)ht(r[t]);n=!1},d(t){for(let e=0;e<r.length;e+=1)r[e].d(t);t&&I(e)}}}function my(e){let n,r,i;return r=new Ot({props:{size:"64",unit:"px",color:Ey}}),{c(){n=T("div"),wt(r.$$.fragment),x(n,"class","loading svelte-168ebyw")},m(t,e){E(t,n,e),Et(r,n,null),i=!0},p:t,i(t){i||(lt(r.$$.fragment,t),i=!0)},o(t){ht(r.$$.fragment,t),i=!1},d(t){t&&I(n),It(r)}}}function by(r,i){let a,u,c,l,h,f,p,v=t;const g=[i[33],{isActive:i[8]}];let b={};for(let t=0;t<g.length;t+=1)b=n(b,g[t]);return u=new Bg({props:b}),{key:r,first:null,c(){a=T("div"),wt(u.$$.fragment),c=k(),this.first=a},m(t,e){E(t,a,e),Et(u,a,null),m(a,c),p=!0},p(t,e){i=t;const n=260&e[0]?mt(g,[4&e[0]&&bt(i[33]),256&e[0]&&{isActive:i[8]}]):{};u.$set(n)},r(){f=a.getBoundingClientRect()},f(){!function(t){const e=getComputedStyle(t);if("absolute"!==e.position&&"fixed"!==e.position){const{width:n,height:r}=e,i=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=r,z(t,i)}}(a),v(),z(a,f)},a(){v(),v=function(n,r,i,o){if(!r)return t;const s=n.getBoundingClientRect();if(r.left===s.left&&r.right===s.right&&r.top===s.top&&r.bottom===s.bottom)return t;const{delay:a=0,duration:u=300,easing:c=e,start:l=d()+a,end:h=l+u,tick:f=t,css:p}=i(n,{from:r,to:s},o);let v,g=!0,m=!1;function b(){p&&B(n,v),g=!1}return y((t=>{if(!m&&t>=l&&(m=!0),m&&t>=h&&(f(1,0),b()),!g)return!1;if(m){const e=0+1*c((t-l)/u);f(e,1-e)}return!0})),p&&(v=j(n,0,1,u,a,c,p)),a||(m=!0),f(0,1),b}(a,f,Ct,{duration:850})},i(n){p||(lt(u.$$.fragment,n),J((()=>{h&&h.end(1),l=function(n,r,i){let o,a,u=r(n,i),c=!1,l=0;function h(){o&&B(n,o)}function f(){const{delay:r=0,duration:i=300,easing:s=e,tick:f=t,css:p}=u||ft;p&&(o=j(n,0,1,i,r,s,p,l++)),f(0,1);const v=d()+r,g=v+i;a&&a.abort(),c=!0,J((()=>ot(n,!0,"start"))),a=y((t=>{if(c){if(t>=g)return f(1,0),ot(n,!0,"end"),h(),c=!1;if(t>=v){const e=s((t-v)/i);f(e,1-e)}}return c}))}let p=!1;return{start(){p||(p=!0,B(n),s(u)?(u=u(),it().then(f)):f())},invalidate(){p=!1},end(){c&&(h(),c=!1)}}}(a,kt,{duration:500}),l.start()})),p=!0)},o(n){ht(u.$$.fragment,n),l&&l.invalidate(),h=function(n,r,i){let a,u=r(n,i),c=!0;const l=at;function h(){const{delay:r=0,duration:i=300,easing:s=e,tick:h=t,css:f}=u||ft;f&&(a=j(n,1,0,i,r,s,f));const p=d()+r,v=p+i;J((()=>ot(n,!1,"start"))),y((t=>{if(c){if(t>=v)return h(0,1),ot(n,!1,"end"),--l.r||o(l.c),!1;if(t>=p){const e=s((t-p)/i);h(1-e,e)}}return c}))}return l.r+=1,s(u)?it().then((()=>{u=u(),h()})):h(),{end(t){t&&u.tick&&u.tick(1,0),c&&(a&&B(n,a),c=!1)}}}(a,kt,{duration:300}),p=!1},d(t){t&&I(a),It(u),t&&h&&h.end()}}}function wy(t){let e,n,r,i,s,a,u,c,l,h,f,d,p,v,g,y,b,w,_;function A(t,e){return 0==t[0]?fy:hy}let N=A(t),C=N(t);function R(t,e){return 0==t[1].length||t[3]?vy:py}let O=R(t),L=O(t);d=new ay({});const P=[my,yy],F=[];function V(t,e){return 0==t[2].length?0:1}return g=V(t),y=F[g]=P[g](t),{c(){e=T("div"),n=T("button"),r=S("svg"),i=S("path"),s=k(),C.c(),a=k(),L.c(),u=k(),c=T("button"),l=S("svg"),h=S("path"),f=k(),wt(d.$$.fragment),p=k(),v=T("div"),y.c(),x(i,"d","M24 20.205L21.005 23.185L9.873 12L21.005 0.813972L24 3.79497L15.833 12L24 20.205V20.205ZM5.96 12L14.127 3.79497L11.132 0.814974L0 12L11.132 23.186L14.127 20.206L5.96 12V12Z"),x(r,"xmlns","http://www.w3.org/2000/svg"),x(r,"width","16"),x(r,"height","16"),x(r,"viewBox","0 0 24 24"),x(r,"class","svelte-168ebyw"),M(r,"active",!t[5]),M(r,"disabled",t[5]),x(n,"class","arrow svelte-168ebyw"),x(n,"id","prev-btn"),x(n,"aria-label","Previous Page"),x(h,"d","M0 3.795l2.995-2.98 11.132 11.185-11.132 11.186-2.995-2.981 8.167-8.205-8.167-8.205zm18.04 8.205l-8.167 8.205 2.995 2.98 11.132-11.185-11.132-11.186-2.995 2.98 8.167 8.206z"),x(l,"xmlns","http://www.w3.org/2000/svg"),x(l,"width","16"),x(l,"height","16"),x(l,"viewBox","0 0 24 24"),x(l,"class","svelte-168ebyw"),M(l,"active",!t[4]),M(l,"disabled",t[4]),x(c,"class","arrow svelte-168ebyw"),x(c,"id","next-btn"),x(c,"aria-label","Next Page"),x(e,"class","filters svelte-168ebyw"),x(v,"class","rankings svelte-168ebyw")},m(o,y){E(o,e,y),m(e,n),m(n,r),m(r,i),m(e,s),C.m(e,null),m(e,a),L.m(e,null),m(e,u),m(e,c),m(c,l),m(l,h),m(e,f),Et(d,e,null),E(o,p,y),E(o,v,y),F[g].m(v,null),b=!0,w||(_=[D(n,"click",t[13]),D(c,"click",t[14])],w=!0)},p(t,n){32&n[0]&&M(r,"active",!t[5]),32&n[0]&&M(r,"disabled",t[5]),N===(N=A(t))&&C?C.p(t,n):(C.d(1),C=N(t),C&&(C.c(),C.m(e,a))),O===(O=R(t))&&L?L.p(t,n):(L.d(1),L=O(t),L&&(L.c(),L.m(e,u))),16&n[0]&&M(l,"active",!t[4]),16&n[0]&&M(l,"disabled",t[4]);let i=g;g=V(t),g===i?F[g].p(t,n):(ut(),ht(F[i],1,1,(()=>{F[i]=null})),ct(),y=F[g],y?y.p(t,n):(y=F[g]=P[g](t),y.c()),lt(y,1),y.m(v,null))},i(t){b||(lt(d.$$.fragment,t),lt(y),b=!0)},o(t){ht(d.$$.fragment,t),ht(y),b=!1},d(t){t&&I(e),C.d(),L.d(),It(d),t&&I(p),t&&I(v),F[g].d(),w=!1,o(_)}}}const Ey="#f3667b";function Iy(t,e=300){let n;return(...r)=>{n||t.apply(this,r),clearTimeout(n),n=setTimeout((()=>{n=void 0}),e)}}function _y(t,e,n){let r,i,o,s,a,u,c;l(t,Hg,(t=>n(6,o=t))),l(t,Gg,(t=>n(7,s=t))),l(t,Kg,(t=>n(19,a=t))),l(t,Qg,(t=>n(20,u=t))),l(t,Wg,(t=>n(8,c=t)));const f=function(t){const e=$g(t),{set:n}=e;return{next:e,enableNext:()=>{document.getElementById("next-btn").disabled=!1,n(!1)},disableNext:()=>{document.getElementById("next-btn").disabled=!0,n(!0)}}}(!1),d=function(t){const e=$g(t),{set:n}=e;return{prev:e,enablePrev:()=>{document.getElementById("prev-btn").disabled=!1,n(!1)},disablePrev:()=>{document.getElementById("prev-btn").disabled=!0,n(!0)}}}(!1),{next:p,enableNext:v,disableNext:g}=f;l(t,p,(t=>n(4,r=t)));const{prev:y,enablePrev:m,disablePrev:b}=d;l(t,y,(t=>n(5,i=t)));let w=[],E=[],I=[],_=!1,T=!1,S=rg.collection(a).doc(s).collection(o).orderBy("rank","asc").limit(15);!function(t){K().$$.on_mount.push(t)}((async()=>{b(),g(),n(2,I=await A()),n(0,w=await k()),n(1,E=await N()),m(),g()}));const A=async()=>{let t=`${s}-${o}-page-${u}`,e=_g(t);if(e.cachedData&&!e.expired)return document.getElementById("prev-btn").disabled=!1,document.getElementById("next-btn").disabled=!1,e.cachedData.data;{let e=await S.get().then((t=>t.docs.map((t=>t.data()))));return await C(e),Tg(t,e),e}},k=async()=>{let t="Seasons",e=_g(t);if(e.cachedData&&!e.expired)return e.cachedData.data;{let e=rg.collection(a).orderBy("order","asc");return await e.get().then((t=>{t.forEach((t=>{n(0,w=[...w,t.id])}))})),Tg(t,w),w}},N=async()=>{b(),g();let t=`${s}-Weeks`,e=_g(t);if(e.cachedData&&!e.expired)return n(1,E.length=0,E),n(1,E=e.cachedData.data),m(),v(),E;{n(1,E.length=0,E);const e=ig.httpsCallable("fetchSubCollections");return await e({year:a,season:s}).then((t=>{n(1,E=t.data)})),Tg(t,E),m(),v(),E}},D=async()=>{b(),g(),h(Qg,u=1,u);let t=`${s}-${o}-page-${u}`,e=_g(t);if(e.cachedData&&!e.expired)n(2,I.length=0,I),n(2,I=e.cachedData.data);else{let e=[];n(2,I.length=0,I),S=rg.collection(a).doc(s).collection(o).orderBy("rank","asc").limit(15);let r=await S.get().then((t=>t.docs.map((t=>t.data()))));await C(r);for(let t=0;t<r.length;t++)e={rank:r[t].rank,title:r[t].title,votes:r[t].votes,banner:r[t].banner,previousRank:r[t].previousRank,previousVotes:r[t].previousVotes,description:r[t].description,genres:r[t].genres,externalLinks:r[t].externalLinks},n(2,I=[...I,e]);Tg(t,r)}"Week-01"==o?(b(),v()):"Week-12"==o?(m(),g()):(m(),v())},C=async t=>{let e;for(let n=0;n<t.length;n++)e=await rg.collection("banners").doc(t[n].title).get().then((t=>t.data().banner)),t[n].banner=e};const x=Iy((()=>function(){let t=E.indexOf(o);r&&v(),1==t?(h(Hg,o=E[t-1],o),D(),b()):(h(Hg,o=E[t-1],o),D())}())),R=Iy((()=>function(){let t=E.indexOf(o);i&&m(),t+1==E.length-1?(h(Hg,o=E[t+1],o),D(),g()):(h(Hg,o=E[t+1],o),D())}()));return document.addEventListener("keydown",(t=>{T||(T=!0,"KeyA"!==t.code&&"ArrowLeft"!==t.code||i||x(),"KeyD"!==t.code&&"ArrowRight"!==t.code||r||R())})),document.addEventListener("keyup",(()=>{T=!1})),[w,E,I,_,r,i,o,s,c,p,y,async()=>{n(3,_=!0),h(Hg,o="Week-01",o),await D(),await N(),n(3,_=!1),b()},D,x,R,function(){s=P(this),Gg.set(s),n(0,w)},function(){o=P(this),Hg.set(o),n(1,E)}]}class Ty extends St{constructor(t){super(),Tt(this,t,_y,wy,a,{},null,[-1,-1])}}function Sy(e){let n;return{c(){n=T("footer"),n.innerHTML='<div class="footer svelte-7v7sya"><div class="vote svelte-7v7sya">Vote for next week on <a href="https://polls.animecorner.me/" target="_blank">polls.animecorner.me</a></div> \n\n    <div class="follow svelte-7v7sya">Follow Anime Corner on\n      <div><a class="icon svelte-7v7sya" href="https://www.facebook.com/AnimeCorner.Official" target="_blank" aria-label="Open Anime Corner&#39;s Facebook Page"><svg class="svg-icon svelte-7v7sya" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm3 8h-1.35c-.538 0-.65.221-.65.778v1.222h2l-.209 2h-1.791v7h-3v-7h-2v-2h2v-2.308c0-1.769.931-2.692 3.029-2.692h1.971v3z"></path></svg></a> \n\n        <a class="icon svelte-7v7sya" href="https://twitter.com/animecorner_ac" target="_blank" aria-label="Open Anime Corner&#39;s Twitter Page"><svg class="svg-icon svelte-7v7sya" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path></svg></a> \n\n        <a class="icon svelte-7v7sya" href="https://www.instagram.com/animecorner_ac/" target="_blank" aria-label="Open Anime Corner&#39;s Instagram Page"><svg class="svg-icon svelte-7v7sya" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path></svg></a> \n\n        <a class="icon svelte-7v7sya" href="https://discord.gg/RcXTHqByGP" target="_blank" aria-label="Open Anime Corner&#39;s Discord Group"><svg class="svg-icon svelte-7v7sya" width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd"><path d="M19.54 0c1.356 0 2.46 1.104 2.46 2.472v21.528l-2.58-2.28-1.452-1.344-1.536-1.428.636 2.22h-13.608c-1.356 0-2.46-1.104-2.46-2.472v-16.224c0-1.368 1.104-2.472 2.46-2.472h16.08zm-4.632 15.672c2.652-.084 3.672-1.824 3.672-1.824 0-3.864-1.728-6.996-1.728-6.996-1.728-1.296-3.372-1.26-3.372-1.26l-.168.192c2.04.624 2.988 1.524 2.988 1.524-1.248-.684-2.472-1.02-3.612-1.152-.864-.096-1.692-.072-2.424.024l-.204.024c-.42.036-1.44.192-2.724.756-.444.204-.708.348-.708.348s.996-.948 3.156-1.572l-.12-.144s-1.644-.036-3.372 1.26c0 0-1.728 3.132-1.728 6.996 0 0 1.008 1.74 3.66 1.824 0 0 .444-.54.804-.996-1.524-.456-2.1-1.416-2.1-1.416l.336.204.048.036.047.027.014.006.047.027c.3.168.6.3.876.408.492.192 1.08.384 1.764.516.9.168 1.956.228 3.108.012.564-.096 1.14-.264 1.74-.516.42-.156.888-.384 1.38-.708 0 0-.6.984-2.172 1.428.36.456.792.972.792.972zm-5.58-5.604c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332.012-.732-.54-1.332-1.224-1.332zm4.38 0c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332 0-.732-.54-1.332-1.224-1.332z"></path></svg></a></div></div></div>',x(n,"class","svelte-7v7sya")},m(t,e){E(t,n,e)},p:t,i:t,o:t,d(t){t&&I(n)}}}class Ay extends St{constructor(t){super(),Tt(this,t,null,Sy,a,{})}}const{window:ky}=gt;function Ny(t){let e,n,r,i,s,a,u,c,l,h,f,d,p;return a=new Ty({}),h=new Ay({}),{c(){e=T("main"),n=T("h1"),n.innerHTML='<a href="https://animecorner.me/" target="_blank" class="svelte-1nth4er">animecorner.me rankings</a>',r=k(),i=T("p"),i.textContent="A web representation of anime corner's anime of the week.",s=k(),wt(a.$$.fragment),u=k(),c=T("button"),c.innerHTML='<svg id="arrow" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 16.67l2.829 2.83 9.175-9.339 9.167 9.339 2.829-2.83-11.996-12.17z"></path></svg>',l=k(),wt(h.$$.fragment),x(n,"class","svelte-1nth4er"),x(e,"class","svelte-1nth4er"),x(c,"class","svelte-1nth4er"),M(c,"hidden",t[0])},m(o,v){E(o,e,v),m(e,n),m(e,r),m(e,i),m(e,s),Et(a,e,null),E(o,u,v),E(o,c,v),E(o,l,v),Et(h,o,v),f=!0,d||(p=[D(ky,"scroll",t[1]),D(c,"click",Dy)],d=!0)},p(t,[e]){1&e&&M(c,"hidden",t[0])},i(t){f||(lt(a.$$.fragment,t),lt(h.$$.fragment,t),f=!0)},o(t){ht(a.$$.fragment,t),ht(h.$$.fragment,t),f=!1},d(t){t&&I(e),It(a),t&&I(u),t&&I(c),t&&I(l),It(h,t),d=!1,o(p)}}}function Dy(){window.scrollTo(0,0)}function Cy(){return document.documentElement||document.body}function xy(t,e,n){let r=!0;return[r,function(){Cy()&&(Cy().scrollTop>200?n(0,r=!1):n(0,r=!0))}]}return new class extends St{constructor(t){super(),Tt(this,t,xy,Ny,a,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
