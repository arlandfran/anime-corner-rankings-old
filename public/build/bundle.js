var app=function(){"use strict";function t(){}const e=t=>t;function n(t,e){for(const n in e)t[n]=e[n];return t}function r(t){return t()}function i(){return Object.create(null)}function o(t){t.forEach(r)}function s(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let u;function c(t,e){return u||(u=document.createElement("a")),u.href=e,t===u.href}function l(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function h(t,e,n){return t.set(n),e}const f="undefined"!=typeof window;let d=f?()=>window.performance.now():()=>Date.now(),p=f?t=>requestAnimationFrame(t):t;const v=new Set;function g(t){v.forEach((e=>{e.c(t)||(v.delete(e),e.f())})),0!==v.size&&p(g)}function y(t){let e;return 0===v.size&&p(g),{promise:new Promise((n=>{v.add(e={c:t,f:n})})),abort(){v.delete(e)}}}function m(t,e){t.appendChild(e)}function b(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e.host?e:document}function w(t){const e=T("style");return function(t,e){m(t.head||t,e)}(b(t),e),e}function E(t,e,n){t.insertBefore(e,n||null)}function I(t){t.parentNode.removeChild(t)}function _(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function T(t){return document.createElement(t)}function S(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function A(t){return document.createTextNode(t)}function k(){return A(" ")}function N(){return A("")}function D(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function C(t){return function(e){return e.preventDefault(),t.call(this,e)}}function x(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function R(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function O(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function L(t,e){for(let n=0;n<t.options.length;n+=1){const r=t.options[n];if(r.__value===e)return void(r.selected=!0)}}function P(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function M(t,e,n){t.classList[n?"add":"remove"](e)}class F{constructor(){this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){this.e||(this.e=T(e.nodeName),this.t=e,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)E(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(I)}}const V=new Set;let U,q=0;function j(t,e,n,r,i,o,s,a=0){const u=16.666/r;let c="{\n";for(let t=0;t<=1;t+=u){const r=e+(n-e)*o(t);c+=100*t+`%{${s(r,1-r)}}\n`}const l=c+`100% {${s(n,1-n)}}\n}`,h=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(l)}_${a}`,f=b(t);V.add(f);const d=f.__svelte_stylesheet||(f.__svelte_stylesheet=w(t).sheet),p=f.__svelte_rules||(f.__svelte_rules={});p[h]||(p[h]=!0,d.insertRule(`@keyframes ${h} ${l}`,d.cssRules.length));const v=t.style.animation||"";return t.style.animation=`${v?`${v}, `:""}${h} ${r}ms linear ${i}ms 1 both`,q+=1,h}function B(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-r.length;i&&(t.style.animation=r.join(", "),q-=i,q||p((()=>{q||(V.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),V.clear())})))}function $(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const r=getComputedStyle(t),i="none"===r.transform?"":r.transform;t.style.transform=`${i} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}function z(t){U=t}function K(){if(!U)throw new Error("Function called outside component initialization");return U}const G=[],H=[],Q=[],W=[],Y=Promise.resolve();let X=!1;function J(t){Q.push(t)}let Z=!1;const tt=new Set;function et(){if(!Z){Z=!0;do{for(let t=0;t<G.length;t+=1){const e=G[t];z(e),nt(e.$$)}for(z(null),G.length=0;H.length;)H.pop()();for(let t=0;t<Q.length;t+=1){const e=Q[t];tt.has(e)||(tt.add(e),e())}Q.length=0}while(G.length);for(;W.length;)W.pop()();X=!1,Z=!1,tt.clear()}}function nt(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(J)}}let rt;function it(){return rt||(rt=Promise.resolve(),rt.then((()=>{rt=null}))),rt}function ot(t,e,n){t.dispatchEvent(function(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}(`${e?"intro":"outro"}${n}`))}const st=new Set;let at;function ut(){at={r:0,c:[],p:at}}function ct(){at.r||o(at.c),at=at.p}function lt(t,e){t&&t.i&&(st.delete(t),t.i(e))}function ht(t,e,n,r){if(t&&t.o){if(st.has(t))return;st.add(t),at.c.push((()=>{st.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}const ft={duration:0};function dt(n,r,i,a){let u=r(n,i),c=a?0:1,l=null,h=null,f=null;function p(){f&&B(n,f)}function v(t,e){const n=t.b-c;return e*=Math.abs(n),{a:c,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function g(r){const{delay:i=0,duration:s=300,easing:a=e,tick:g=t,css:m}=u||ft,b={start:d()+i,b:r};r||(b.group=at,at.r+=1),l||h?h=b:(m&&(p(),f=j(n,c,r,s,i,a,m)),r&&g(0,1),l=v(b,s),J((()=>ot(n,r,"start"))),y((t=>{if(h&&t>h.start&&(l=v(h,s),h=null,ot(n,l.b,"start"),m&&(p(),f=j(n,c,l.b,l.duration,0,a,u.css))),l)if(t>=l.end)g(c=l.b,1-c),ot(n,l.b,"end"),h||(l.b?p():--l.group.r||o(l.group.c)),l=null;else if(t>=l.start){const e=t-l.start;c=l.a+l.d*a(e/l.duration),g(c,1-c)}return!(!l&&!h)})))}return{run(t){s(u)?it().then((()=>{u=u(),g(t)})):g(t)},end(){p(),l=h=null}}}function pt(t,e){const n=e.token={};function r(t,r,i,o){if(e.token!==n)return;e.resolved=o;let s=e.ctx;void 0!==i&&(s=s.slice(),s[i]=o);const a=t&&(e.current=t)(s);let u=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(ut(),ht(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),ct())})):e.block.d(1),a.c(),lt(a,1),a.m(e.mount(),e.anchor),u=!0),e.block=a,e.blocks&&(e.blocks[r]=a),u&&et()}if((i=t)&&"object"==typeof i&&"function"==typeof i.then){const n=K();if(t.then((t=>{z(n),r(e.then,1,e.value,t),z(null)}),(t=>{if(z(n),r(e.catch,2,e.error,t),z(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var i}function vt(t,e,n){const r=e.slice(),{resolved:i}=t;t.current===t.then&&(r[t.value]=i),t.current===t.catch&&(r[t.error]=i),t.block.p(r,n)}const gt="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function yt(t,e){ht(t,1,1,(()=>{e.delete(t.key)}))}function mt(t,e){t.f(),yt(t,e)}function bt(t,e,n,r,i,o,s,a,u,c,l,h){let f=t.length,d=o.length,p=f;const v={};for(;p--;)v[t[p].key]=p;const g=[],y=new Map,m=new Map;for(p=d;p--;){const t=h(i,o,p),a=n(t);let u=s.get(a);u?r&&u.p(t,e):(u=c(a,t),u.c()),y.set(a,g[p]=u),a in v&&m.set(a,Math.abs(p-v[a]))}const b=new Set,w=new Set;function E(t){lt(t,1),t.m(a,l),s.set(t.key,t),l=t.first,d--}for(;f&&d;){const e=g[d-1],n=t[f-1],r=e.key,i=n.key;e===n?(l=e.first,f--,d--):y.has(i)?!s.has(r)||b.has(r)?E(e):w.has(i)?f--:m.get(r)>m.get(i)?(w.add(r),E(e)):(b.add(i),f--):(u(n,s),f--)}for(;f--;){const e=t[f];y.has(e.key)||u(e,s)}for(;d;)E(g[d-1]);return g}function wt(t,e){const n={},r={},i={$$scope:1};let o=t.length;for(;o--;){const s=t[o],a=e[o];if(a){for(const t in s)t in a||(r[t]=1);for(const t in a)i[t]||(n[t]=a[t],i[t]=1);t[o]=a}else for(const t in s)i[t]=1}for(const t in r)t in n||(n[t]=void 0);return n}function Et(t){return"object"==typeof t&&null!==t?t:{}}function It(t){t&&t.c()}function _t(t,e,n,i){const{fragment:a,on_mount:u,on_destroy:c,after_update:l}=t.$$;a&&a.m(e,n),i||J((()=>{const e=u.map(r).filter(s);c?c.push(...e):o(e),t.$$.on_mount=[]})),l.forEach(J)}function Tt(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function St(t,e){-1===t.$$.dirty[0]&&(G.push(t),X||(X=!0,Y.then(et)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function At(e,n,r,s,a,u,c,l=[-1]){const h=U;z(e);const f=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:n.context||[]),callbacks:i(),dirty:l,skip_bound:!1,root:n.target||h.$$.root};c&&c(f.root);let d=!1;if(f.ctx=r?r(e,n.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return f.ctx&&a(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),d&&St(e,t)),n})):[],f.update(),d=!0,o(f.before_update),f.fragment=!!s&&s(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(I)}else f.fragment&&f.fragment.c();n.intro&&lt(e.$$.fragment),_t(e,n.target,n.anchor,n.customElement),et()}z(h)}class kt{$destroy(){Tt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Nt(t){const e=t-1;return e*e*e+1}function Dt(t,{delay:n=0,duration:r=400,easing:i=e}={}){const o=+getComputedStyle(t).opacity;return{delay:n,duration:r,easing:i,css:t=>"opacity: "+t*o}}function Ct(t,{delay:e=0,duration:n=400,easing:r=Nt,x:i=0,y:o=0,opacity:s=0}={}){const a=getComputedStyle(t),u=+a.opacity,c="none"===a.transform?"":a.transform,l=u*(1-s);return{delay:e,duration:n,easing:r,css:(t,e)=>`\n\t\t\ttransform: ${c} translate(${(1-t)*i}px, ${(1-t)*o}px);\n\t\t\topacity: ${u-l*e}`}}function xt(t,{delay:e=0,duration:n=400,easing:r=Nt}={}){const i=getComputedStyle(t),o=+i.opacity,s=parseFloat(i.height),a=parseFloat(i.paddingTop),u=parseFloat(i.paddingBottom),c=parseFloat(i.marginTop),l=parseFloat(i.marginBottom),h=parseFloat(i.borderTopWidth),f=parseFloat(i.borderBottomWidth);return{delay:e,duration:n,easing:r,css:t=>`overflow: hidden;opacity: ${Math.min(20*t,1)*o};height: ${t*s}px;padding-top: ${t*a}px;padding-bottom: ${t*u}px;margin-top: ${t*c}px;margin-bottom: ${t*l}px;border-top-width: ${t*h}px;border-bottom-width: ${t*f}px;`}}function Rt(t,e,n={}){const r=getComputedStyle(t),i="none"===r.transform?"":r.transform,o=e.from.width/t.clientWidth,a=e.from.height/t.clientHeight,u=(e.from.left-e.to.left)/o,c=(e.from.top-e.to.top)/a,l=Math.sqrt(u*u+c*c),{delay:h=0,duration:f=(t=>120*Math.sqrt(t)),easing:d=Nt}=n;return{delay:h,duration:s(f)?f(l):f,easing:d,css:(t,e)=>`transform: ${i} translate(${e*u}px, ${e*c}px);`}}const Ot=[];function Lt(e,n=t){let r;const i=new Set;function o(t){if(a(e,t)&&(e=t,r)){const t=!Ot.length;for(const t of i)t[1](),Ot.push(t,e);if(t){for(let t=0;t<Ot.length;t+=2)Ot[t][0](Ot[t+1]);Ot.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const u=[s,a];return i.add(u),1===i.size&&(r=n(o)||t),s(e),()=>{i.delete(u),0===i.size&&(r(),r=null)}}}}const Pt=function(t){return Lt({},(e=>{if("undefined"==typeof window)return;let n={},r=()=>e(function(t){let e={classNames:""},n=[];for(let r in t)e[r]=t[r].matches,e[r]&&n.push("media-"+r);return e.classNames=n.join(" "),e}(n));for(let e in t){let i=window.matchMedia(t[e]);n[e]=i,n[e].addListener(r)}return r(),()=>{for(let t in n)n[t].removeListener(r)}}))}({mobile:"(max-width: 1440px)",desktop:"(min-width: 1440px)",noanimations:"(prefers-reduced-motion: reduce)"}),Mt=Lt("2021"),Ft=Lt("Summer"),Vt=Lt("Week-07"),Ut=Lt(1),qt=Lt(!1),jt=Lt([{question:"What is Anime Corner Rankings?",answer:"This site tracks the weekly rankings released by Anime Corner, an online community that provides news, highlights and articles on the anime industry. In particular the site displays their list in an interactive leaderboard that can expand to show you more information about a show if it catches your interest."},{question:"Where does the data come from?",answer:"The poll data is collected by Anime Corner and published on their <a href='https://animecorner.me/category/anime-corner/rankings/anime-of-the-week/' target='_blank'>website</a>. If you're curious about how the data is collected and calculated you can learn more about it <a href='https://animecorner.me/polls/' target='_blank'>here</a>.<br /><br />Data about each anime is provided by <a href='https://anilist.co/' target='_blank'>Anilist</a> & <a href='https://kitsu.io/' target='_blank'>Kitsu</a>."},{question:"How often are the rankings updated?",answer:"The rankings are updated every Friday at approximately 13:00pm UTC."},{question:"How can I vote?",answer:"You can cast your vote over at <a href='https://polls.animecorner.me/' target='_blank'>polls.animecorner.me</a>"},{question:"Are there similar rankings out there?",answer:"Yes this site was actually inspired by some of these sites here:<br /><ul><li><a href='https://animekarmalist.com/' target='_blank'>animekarmalist.com</a></li><li><a href='https://animekarmawatch.com/' target='_blank'>animekarmawatch.com</a></li><li><a href='https://animetrics.co/' target='_blank'>animetrics.co</a></li><li><a href='https://anitrendz.net/' target='_blank'>anitrendz.net</a></li></ul>"},{question:"How can I contact you?",answer:"If you have any have questions, feedback or suggestions about the site, please feel free and create an issue on the <a href='https://github.com/arlandfran/anime-corner-rankings/issues' target=''_blank>project repository</a> or even better make a PR yourself!"}]);function Bt(e){let n;return{c(){n=T("div"),x(n,"class","circle svelte-14upwad"),O(n,"--size",e[3]+e[1]),O(n,"--color",e[0]),O(n,"--duration",e[2])},m(t,e){E(t,n,e)},p(t,[e]){10&e&&O(n,"--size",t[3]+t[1]),1&e&&O(n,"--color",t[0]),4&e&&O(n,"--duration",t[2])},i:t,o:t,d(t){t&&I(n)}}}function $t(t,e,n){let{color:r="#FF3E00"}=e,{unit:i="px"}=e,{duration:o="0.75s"}=e,{size:s="60"}=e;return t.$$set=t=>{"color"in t&&n(0,r=t.color),"unit"in t&&n(1,i=t.unit),"duration"in t&&n(2,o=t.duration),"size"in t&&n(3,s=t.size)},[r,i,o,s]}class zt extends kt{constructor(t){super(),At(this,t,$t,Bt,a,{color:0,unit:1,duration:2,size:3})}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var Kt=function(t,e){return(Kt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Gt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Kt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Ht=function(){return(Ht=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Qt(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function Wt(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function Yt(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Xt(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function Jt(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Zt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,d=63&c;u||(d=64,s||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var l=s<<4&240|a>>2;if(r.push(l),64!==u){var h=a<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};function te(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=te(t[n],e[n]));return t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var ee=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function ne(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function re(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var ie=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,oe.prototype.create),o}return Gt(e,t),e}(Error),oe=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?se(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new ie(i,a,r);return u},t}();function se(t,e){return t.replace(ae,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var ae=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ue(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ce(t,e){var n=new le(t,e);return n.subscribe.bind(n)}var le=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=he),void 0===r.error&&(r.error=he),void 0===r.complete&&(r.complete=he);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function he(){}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function fe(t){return t&&t._delegate?t._delegate:t}var de=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),pe="[DEFAULT]",ve=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new ee;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t))try{this.getOrInitializeService({instanceIdentifier:pe})}catch(t){}try{for(var r=Yt(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=Xt(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService({instanceIdentifier:u});a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=pe),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Qt(this,void 0,void 0,(function(){var t;return Wt(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(Jt(Jt([],Xt(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),Xt(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=pe),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var a=Yt(this.instancesDeferred.entries()),u=a.next();!u.done;u=a.next()){var c=Xt(u.value,2),l=c[0],h=c[1];o===this.normalizeInstanceIdentifier(l)&&h.resolve(s)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return s},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var o=Yt(i),s=o.next();!s.done;s=o.next()){var a=s.value;try{a(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===pe?void 0:e),options:i}),this.instances.set(n,o),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=pe),this.component?this.component.multipleInstances?t:pe:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ge,ye=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new ve(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function me(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var be,we=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(be||(be={}));var Ee,Ie={debug:be.DEBUG,verbose:be.VERBOSE,info:be.INFO,warn:be.WARN,error:be.ERROR,silent:be.SILENT},_e=be.INFO,Te=((ge={})[be.DEBUG]="log",ge[be.VERBOSE]="log",ge[be.INFO]="info",ge[be.WARN]="warn",ge[be.ERROR]="error",ge),Se=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=Te[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,me(["["+i+"]  "+t.name+":"],n))}},Ae=function(){function t(t){this.name=t,this._logLevel=_e,this._logHandler=Se,this._userLogHandler=null,we.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in be))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?Ie[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,me([this,be.DEBUG],t)),this._logHandler.apply(this,me([this,be.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,me([this,be.VERBOSE],t)),this._logHandler.apply(this,me([this,be.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,me([this,be.INFO],t)),this._logHandler.apply(this,me([this,be.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,me([this,be.WARN],t)),this._logHandler.apply(this,me([this,be.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,me([this,be.ERROR],t)),this._logHandler.apply(this,me([this,be.ERROR],t))},t}();function ke(t){we.forEach((function(e){e.setLogLevel(t)}))}var Ne,De=((Ee={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",Ee["bad-app-name"]="Illegal App name: '{$appName}",Ee["duplicate-app"]="Firebase App named '{$appName}' already exists",Ee["app-deleted"]="Firebase App named '{$appName}' already deleted",Ee["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",Ee["invalid-log-argument"]="First argument to `onLog` must be null or a function.",Ee),Ce=new oe("app","Firebase",De),xe="@firebase/app",Re="[DEFAULT]",Oe=((Ne={})[xe]="fire-core",Ne["@firebase/analytics"]="fire-analytics",Ne["@firebase/app-check"]="fire-app-check",Ne["@firebase/auth"]="fire-auth",Ne["@firebase/database"]="fire-rtdb",Ne["@firebase/functions"]="fire-fn",Ne["@firebase/installations"]="fire-iid",Ne["@firebase/messaging"]="fire-fcm",Ne["@firebase/performance"]="fire-perf",Ne["@firebase/remote-config"]="fire-rc",Ne["@firebase/storage"]="fire-gcs",Ne["@firebase/firestore"]="fire-fst",Ne["fire-js"]="fire-js",Ne["firebase-wrapper"]="fire-js-all",Ne),Le=new Ae("@firebase/app"),Pe=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=te(void 0,t),this.container=new ye(e.name),this._addComponent(new de("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=Re),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=Re),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){Le.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw Ce.create("app-deleted",{appName:this.name_})},t}();Pe.prototype.name&&Pe.prototype.options||Pe.prototype.delete||console.log("dc");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Me(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name=Re);var s=o.name;if("string"!=typeof s||!s)throw Ce.create("bad-app-name",{appName:String(s)});if(ue(e,s))throw Ce.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=Oe[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void Le.warn(u.join(" "))}o(new de(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:ke,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw Ce.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=Ie[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:be[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=we;r<i.length;r++)n(i[r])}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t,e)},apps:null,SDK_VERSION:"8.7.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!ue(e,t=t||Re))throw Ce.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return Le.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw Ce.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&te(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var l=c[u];e[l]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Fe=function t(){var e=Me(Pe);return e.INTERNAL=Ht(Ht({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){te(e,t)},createSubscribe:ce,ErrorFactory:oe,deepExtend:te}),e}(),Ve=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){Le.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Ue=self.firebase.SDK_VERSION;Ue&&Ue.indexOf("LITE")>=0&&Le.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var qe=Fe.initializeApp;Fe.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return re()&&Le.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),qe.apply(void 0,t)};var je=Fe;!function(t,e){t.INTERNAL.registerComponent(new de("platform-logger",(function(t){return new Ve(t)}),"PRIVATE")),t.registerVersion(xe,"0.6.28",e),t.registerVersion("fire-js","")}(je);var Be="8.8.0";
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
je.registerVersion("firebase",Be,"app"),je.SDK_VERSION=Be;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var $e=function(t,e){return($e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function ze(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Ke,Ge="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},He=He||{},Qe=Ge||self;function We(){}function Ye(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Xe(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Je="closure_uid_"+(1e9*Math.random()>>>0),Ze=0;function tn(t,e,n){return t.call.apply(t.bind,arguments)}function en(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function nn(t,e,n){return(nn=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?tn:en).apply(null,arguments)}function rn(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function on(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function sn(){this.s=this.s,this.o=this.o}var an={};sn.prototype.s=!1,sn.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,Je)&&t[Je]||(t[Je]=++Ze)}(this);delete an[t]}},sn.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var un=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},cn=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function ln(t){return Array.prototype.concat.apply([],arguments)}function hn(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function fn(t){return/^[\s\xa0]*$/.test(t)}var dn,pn=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function vn(t,e){return-1!=t.indexOf(e)}function gn(t,e){return t<e?-1:t>e?1:0}t:{var yn=Qe.navigator;if(yn){var mn=yn.userAgent;if(mn){dn=mn;break t}}dn=""}function bn(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function wn(t){var e={};for(var n in t)e[n]=t[n];return e}var En="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function In(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<En.length;o++)n=En[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function _n(t){return _n[" "](t),t}_n[" "]=We;var Tn,Sn,An=vn(dn,"Opera"),kn=vn(dn,"Trident")||vn(dn,"MSIE"),Nn=vn(dn,"Edge"),Dn=Nn||kn,Cn=vn(dn,"Gecko")&&!(vn(dn.toLowerCase(),"webkit")&&!vn(dn,"Edge"))&&!(vn(dn,"Trident")||vn(dn,"MSIE"))&&!vn(dn,"Edge"),xn=vn(dn.toLowerCase(),"webkit")&&!vn(dn,"Edge");function Rn(){var t=Qe.document;return t?t.documentMode:void 0}t:{var On="",Ln=(Sn=dn,Cn?/rv:([^\);]+)(\)|;)/.exec(Sn):Nn?/Edge\/([\d\.]+)/.exec(Sn):kn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Sn):xn?/WebKit\/(\S+)/.exec(Sn):An?/(?:Version)[ \/]?(\S+)/.exec(Sn):void 0);if(Ln&&(On=Ln?Ln[1]:""),kn){var Pn=Rn();if(null!=Pn&&Pn>parseFloat(On)){Tn=String(Pn);break t}}Tn=On}var Mn,Fn={};function Vn(){return function(t){var e=Fn;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=pn(String(Tn)).split("."),n=pn("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=gn(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||gn(0==o[2].length,0==s[2].length)||gn(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}))}if(Qe.document&&kn){var Un=Rn();Mn=Un||(parseInt(Tn,10)||void 0)}else Mn=void 0;var qn=Mn,jn=function(){if(!Qe.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Qe.addEventListener("test",We,e),Qe.removeEventListener("test",We,e)}catch(t){}return t}();function Bn(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function $n(t,e){if(Bn.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Cn){t:{try{_n(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:zn[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&$n.Z.h.call(this)}}Bn.prototype.h=function(){this.defaultPrevented=!0},on($n,Bn);var zn={2:"touch",3:"pen",4:"mouse"};$n.prototype.h=function(){$n.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Kn="closure_listenable_"+(1e6*Math.random()|0),Gn=0;function Hn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++Gn,this.ca=this.fa=!1}function Qn(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Wn(t){this.src=t,this.g={},this.h=0}function Yn(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=un(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Qn(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Xn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}Wn.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=Xn(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new Hn(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var Jn="closure_lm_"+(1e6*Math.random()|0),Zn={};function tr(t,e,n,r,i){if(r&&r.once)return nr(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)tr(t,e[o],n,r,i);return null}return n=cr(n),t&&t[Kn]?t.N(e,n,Xe(r)?!!r.capture:!!r,i):er(t,e,n,!1,r,i)}function er(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=Xe(i)?!!i.capture:!!i,a=ar(t);if(a||(t[Jn]=a=new Wn(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=sr;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)jn||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(or(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function nr(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)nr(t,e[o],n,r,i);return null}return n=cr(n),t&&t[Kn]?t.O(e,n,Xe(r)?!!r.capture:!!r,i):er(t,e,n,!0,r,i)}function rr(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)rr(t,e[o],n,r,i);else r=Xe(r)?!!r.capture:!!r,n=cr(n),t&&t[Kn]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=Xn(o=t.g[e],n,r,i))&&(Qn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=ar(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Xn(e,n,r,i)),(n=-1<t?e[t]:null)&&ir(n))}function ir(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Kn])Yn(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(or(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ar(e))?(Yn(n,t),0==n.h&&(n.src=null,e[Jn]=null)):Qn(t)}}}function or(t){return t in Zn?Zn[t]:Zn[t]="on"+t}function sr(t,e){if(t.ca)t=!0;else{e=new $n(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&ir(t),t=n.call(r,e)}return t}function ar(t){return(t=t[Jn])instanceof Wn?t:null}var ur="__closure_events_fn_"+(1e9*Math.random()>>>0);function cr(t){return"function"==typeof t?t:(t[ur]||(t[ur]=function(e){return t.handleEvent(e)}),t[ur])}function lr(){sn.call(this),this.i=new Wn(this),this.P=this,this.I=null}function hr(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new Bn(e,t);else if(e instanceof Bn)e.target=e.target||t;else{var i=e;In(e=new Bn(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=fr(s,r,!0,e)&&i}if(i=fr(s=e.g=t,r,!0,e)&&i,i=fr(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=fr(s=e.g=n[o],r,!1,e)&&i}function fr(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&Yn(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}on(lr,sn),lr.prototype[Kn]=!0,lr.prototype.removeEventListener=function(t,e,n,r){rr(this,t,e,n,r)},lr.prototype.M=function(){if(lr.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Qn(n[r]);delete e.g[t],e.h--}}this.I=null},lr.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},lr.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var dr=Qe.JSON.stringify;function pr(){var t=Ir,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var vr,gr=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=yr.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),yr=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new mr}),(function(t){return t.reset()})),mr=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function br(t){Qe.setTimeout((function(){throw t}),0)}function wr(t,e){vr||function(){var t=Qe.Promise.resolve(void 0);vr=function(){t.then(_r)}}(),Er||(vr(),Er=!0),Ir.add(t,e)}var Er=!1,Ir=new gr;function _r(){for(var t;t=pr();){try{t.h.call(t.g)}catch(t){br(t)}var e=yr;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Er=!1}function Tr(t,e){lr.call(this),this.h=t||1,this.g=e||Qe,this.j=nn(this.kb,this),this.l=Date.now()}function Sr(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Ar(t,e,n){if("function"==typeof t)n&&(t=nn(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=nn(t.handleEvent,t)}return 2147483647<Number(e)?-1:Qe.setTimeout(t,e||0)}function kr(t){t.g=Ar((function(){t.g=null,t.i&&(t.i=!1,kr(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}on(Tr,lr),(Ke=Tr.prototype).da=!1,Ke.S=null,Ke.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),hr(this,"tick"),this.da&&(Sr(this),this.start()))}},Ke.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ke.M=function(){Tr.Z.M.call(this),Sr(this),delete this.g};var Nr=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}$e(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:kr(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(Qe.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(sn);function Dr(t){sn.call(this),this.h=t,this.g={}}on(Dr,sn);var Cr=[];function xr(t,e,n,r){Array.isArray(n)||(n&&(Cr[0]=n.toString()),n=Cr);for(var i=0;i<n.length;i++){var o=tr(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function Rr(t){bn(t.g,(function(t,e){this.g.hasOwnProperty(e)&&ir(t)}),t),t.g={}}function Or(){this.g=!0}function Lr(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return dr(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}Dr.prototype.M=function(){Dr.Z.M.call(this),Rr(this)},Dr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Or.prototype.Aa=function(){this.g=!1},Or.prototype.info=function(){};var Pr={},Mr=null;function Fr(){return Mr=Mr||new lr}function Vr(t){Bn.call(this,Pr.Ma,t)}function Ur(t){var e=Fr();hr(e,new Vr(e,t))}function qr(t,e){Bn.call(this,Pr.STAT_EVENT,t),this.stat=e}function jr(t){var e=Fr();hr(e,new qr(e,t))}function Br(t,e){Bn.call(this,Pr.Na,t),this.size=e}function $r(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Qe.setTimeout((function(){t()}),e)}Pr.Ma="serverreachability",on(Vr,Bn),Pr.STAT_EVENT="statevent",on(qr,Bn),Pr.Na="timingevent",on(Br,Bn);var zr={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Kr={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Gr(){}function Hr(t){return t.h||(t.h=t.i())}function Qr(){}Gr.prototype.h=null;var Wr,Yr={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Xr(){Bn.call(this,"d")}function Jr(){Bn.call(this,"c")}function Zr(){}function ti(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new Dr(this),this.P=ni,t=Dn?125:void 0,this.W=new Tr(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new ei}function ei(){this.i=null,this.g="",this.h=!1}on(Xr,Bn),on(Jr,Bn),on(Zr,Gr),Zr.prototype.g=function(){return new XMLHttpRequest},Zr.prototype.i=function(){return{}},Wr=new Zr;var ni=45e3,ri={},ii={};function oi(t,e,n){t.K=1,t.v=Ni(Ii(e)),t.s=n,t.U=!0,si(t,null)}function si(t,e){t.F=Date.now(),li(t),t.A=Ii(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),ji(n.h,"t",r),t.C=0,n=t.l.H,t.h=new ei,t.g=$o(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Nr(nn(t.Ia,t,t.g),t.O)),xr(t.V,t.g,"readystatechange",t.gb),e=t.H?wn(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Ur(1),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");s=2<=h.length&&"type"==h[1]?s+(l+"=")+c+"&":s+(l+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function ai(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function ui(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=ci(t,n))==ii){4==e&&(t.o=4,jr(14),i=!1),Lr(t.j,t.m,null,"[Incomplete Response]");break}if(r==ri){t.o=4,jr(15),Lr(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}Lr(t.j,t.m,r,null),vi(t,r)}ai(t)&&r!=ii&&r!=ri&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,jr(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Po(e),e.L=!0,jr(11))):(Lr(t.j,t.m,n,"[Invalid Chunked Response]"),pi(t),di(t))}function ci(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?ii:(n=Number(e.substring(n,r)),isNaN(n)?ri:(r+=1)+n>e.length?ii:(e=e.substr(r,n),t.C=r+n,e))}function li(t){t.Y=Date.now()+t.P,hi(t,t.P)}function hi(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=$r(nn(t.eb,t),e)}function fi(t){t.B&&(Qe.clearTimeout(t.B),t.B=null)}function di(t){0==t.l.G||t.I||Vo(t.l,t)}function pi(t){fi(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Sr(t.W),Rr(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function vi(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Qi(n.i,t)))if(n.I=t.N,!t.J&&Qi(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Fo(n),Ao(n)}Lo(n),jr(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=$r(nn(n.ab,n),6e3));if(1>=Hi(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else qo(n,11)}else if((t.J||n.g==t)&&Fo(n),!fn(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(vn(l,"spdy")||vn(l,"quic")||vn(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(Wi(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,ki(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=t;if((r=n).oa=Bo(r,r.H?r.la:null,r.W),d.J){Yi(r.i,d);var p=d,v=r.K;v&&p.setTimeout(v),p.B&&(fi(p),li(p)),r.g=d}else Oo(r);0<n.l.length&&Do(n)}else"stop"!=o[0]&&"close"!=o[0]||qo(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?qo(n,7):So(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}Ur(4)}catch(o){}}function gi(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Ye(t)||"string"==typeof t)cn(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(Ye(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(Ye(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function yi(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof yi)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function mi(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];bi(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)bi(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function bi(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(Ke=ti.prototype).setTimeout=function(t){this.P=t},Ke.gb=function(t){t=t.target;var e=this.L;e&&3==wo(t)?e.l():this.Ia(t)},Ke.Ia=function(t){try{if(t==this.g)t:{var e=wo(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||Dn||this.g&&(this.h.h||this.g.ga()||Eo(this.g)))){this.I||4!=e||7==n||Ur(8==n||0>=r?3:2),fi(this);var i=this.g.ba();this.N=i;e:if(ai(this)){var o=Eo(this.g);t="";var s=o.length,a=4==wo(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){pi(this),di(this);var u="";break e}this.h.i=new Qe.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!fn(c)){var h=c;break e}}h=null}if(!(i=h)){this.i=!1,this.o=3,jr(12),pi(this),di(this);break t}Lr(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,vi(this,i)}this.U?(ui(this,e,u),Dn&&this.i&&3==e&&(xr(this.V,this.W,"tick",this.fb),this.W.start())):(Lr(this.j,this.m,u,null),vi(this,u)),4==e&&pi(this),this.i&&!this.I&&(4==e?Vo(this.l,this):(this.i=!1,li(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,jr(12)):(this.o=0,jr(13)),pi(this),di(this)}}}catch(e){}},Ke.fb=function(){if(this.g){var t=wo(this.g),e=this.g.ga();this.C<e.length&&(fi(this),ui(this,t,e),this.i&&4!=t&&li(this))}},Ke.cancel=function(){this.I=!0,pi(this)},Ke.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Ur(3),jr(17)),pi(this),this.o=2,di(this)):hi(this,this.Y-t)},(Ke=yi.prototype).R=function(){mi(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},Ke.T=function(){return mi(this),this.g.concat()},Ke.get=function(t,e){return bi(this.h,t)?this.h[t]:e},Ke.set=function(t,e){bi(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},Ke.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var wi=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ei(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Ei){this.g=void 0!==e?e:t.g,_i(this,t.j),this.s=t.s,Ti(this,t.i),Si(this,t.m),this.l=t.l,e=t.h;var n=new Fi;n.i=e.i,e.g&&(n.g=new yi(e.g),n.h=e.h),Ai(this,n),this.o=t.o}else t&&(n=String(t).match(wi))?(this.g=!!e,_i(this,n[1]||"",!0),this.s=Di(n[2]||""),Ti(this,n[3]||"",!0),Si(this,n[4]),this.l=Di(n[5]||"",!0),Ai(this,n[6]||"",!0),this.o=Di(n[7]||"")):(this.g=!!e,this.h=new Fi(null,this.g))}function Ii(t){return new Ei(t)}function _i(t,e,n){t.j=n?Di(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Ti(t,e,n){t.i=n?Di(e,!0):e}function Si(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Ai(t,e,n){e instanceof Fi?(t.h=e,function(t,e){e&&!t.j&&(Vi(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Ui(this,e),ji(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=Ci(e,Pi)),t.h=new Fi(e,t.g))}function ki(t,e,n){t.h.set(e,n)}function Ni(t){return ki(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Di(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ci(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,xi),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function xi(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ei.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Ci(e,Ri,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Ci(e,Ri,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ci(n,"/"==n.charAt(0)?Li:Oi,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Ci(n,Mi)),t.join("")};var Ri=/[#\/\?@]/g,Oi=/[#\?:]/g,Li=/[#\?]/g,Pi=/[#\?@]/g,Mi=/#/g;function Fi(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Vi(t){t.g||(t.g=new yi,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Ui(t,e){Vi(t),e=Bi(t,e),bi(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,bi((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&mi(t)))}function qi(t,e){return Vi(t),e=Bi(t,e),bi(t.g.h,e)}function ji(t,e,n){Ui(t,e),0<n.length&&(t.i=null,t.g.set(Bi(t,e),hn(n)),t.h+=n.length)}function Bi(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(Ke=Fi.prototype).add=function(t,e){Vi(this),this.i=null,t=Bi(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Ke.forEach=function(t,e){Vi(this),this.g.forEach((function(n,r){cn(n,(function(n){t.call(e,n,r,this)}),this)}),this)},Ke.T=function(){Vi(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Ke.R=function(t){Vi(this);var e=[];if("string"==typeof t)qi(this,t)&&(e=ln(e,this.g.get(Bi(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=ln(e,t[n])}return e},Ke.set=function(t,e){return Vi(this),this.i=null,qi(this,t=Bi(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Ke.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},Ke.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var $i=function(t,e){this.h=t,this.g=e};function zi(t){this.l=t||Ki,Qe.PerformanceNavigationTiming?t=0<(t=Qe.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(Qe.g&&Qe.g.Ea&&Qe.g.Ea()&&Qe.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Ki=10;function Gi(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Hi(t){return t.h?1:t.g?t.g.size:0}function Qi(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Wi(t,e){t.g?t.g.add(e):t.h=e}function Yi(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Xi(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=ze(t.g.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return hn(t.i)}function Ji(){}function Zi(){this.g=new Ji}function to(t,e,n){var r=n||"";try{gi(t,(function(t,n){var i=t;Xe(t)&&(i=dr(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function eo(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function no(t){this.l=t.$b||null,this.j=t.ib||!1}function ro(t,e){lr.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=io,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}zi.prototype.cancel=function(){var t,e;if(this.i=Xi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=ze(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},Ji.prototype.stringify=function(t){return Qe.JSON.stringify(t,void 0)},Ji.prototype.parse=function(t){return Qe.JSON.parse(t,void 0)},on(no,Gr),no.prototype.g=function(){return new ro(this.l,this.j)},no.prototype.i=function(t){return function(){return t}}({}),on(ro,lr);var io=0;function oo(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function so(t){t.readyState=4,t.l=null,t.j=null,t.A=null,ao(t)}function ao(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Ke=ro.prototype).open=function(t,e){if(this.readyState!=io)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,ao(this)},Ke.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Qe).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},Ke.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,so(this)),this.readyState=io},Ke.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,ao(this)),this.g&&(this.readyState=3,ao(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Qe.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;oo(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},Ke.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?so(this):ao(this),3==this.readyState&&oo(this)}},Ke.Ua=function(t){this.g&&(this.response=this.responseText=t,so(this))},Ke.Ta=function(t){this.g&&(this.response=t,so(this))},Ke.ha=function(){this.g&&so(this)},Ke.setRequestHeader=function(t,e){this.v.append(t,e)},Ke.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Ke.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ro.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var uo=Qe.JSON.parse;function co(t){lr.call(this),this.headers=new yi,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=lo,this.K=this.L=!1}on(co,lr);var lo="",ho=/^https?$/i,fo=["POST","PUT"];function po(t){return"content-type"==t.toLowerCase()}function vo(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,go(t),mo(t)}function go(t){t.D||(t.D=!0,hr(t,"complete"),hr(t,"error"))}function yo(t){if(t.h&&void 0!==He&&(!t.C[1]||4!=wo(t)||2!=t.ba()))if(t.v&&4==wo(t))Ar(t.Fa,0,t);else if(hr(t,"readystatechange"),4==wo(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(wi)[1]||null;if(!o&&Qe.self&&Qe.self.location){var s=Qe.self.location.protocol;o=s.substr(0,s.length-1)}i=!ho.test(o?o.toLowerCase():"")}e=i}if(e)hr(t,"complete"),hr(t,"success");else{t.m=6;try{var a=2<wo(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.ba()+"]",go(t)}}finally{mo(t)}}}function mo(t,e){if(t.g){bo(t);var n=t.g,r=t.C[0]?We:null;t.g=null,t.C=null,e||hr(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function bo(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Qe.clearTimeout(t.A),t.A=null)}function wo(t){return t.g?t.g.readyState:0}function Eo(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case lo:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Io(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return bn(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):ki(t,e,n))}function _o(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function To(t){this.za=0,this.l=[],this.h=new Or,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=_o("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=_o("baseRetryDelayMs",5e3,t),this.$a=_o("retryDelaySeedMs",1e4,t),this.Ya=_o("forwardChannelMaxRetries",2,t),this.ra=_o("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new zi(t&&t.concurrentRequestLimit),this.Ca=new Zi,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function So(t){if(ko(t),3==t.G){var e=t.V++,n=Ii(t.F);ki(n,"SID",t.J),ki(n,"RID",e),ki(n,"TYPE","terminate"),xo(t,n),(e=new ti(t,t.h,e,void 0)).K=2,e.v=Ni(Ii(n)),n=!1,Qe.navigator&&Qe.navigator.sendBeacon&&(n=Qe.navigator.sendBeacon(e.v.toString(),"")),!n&&Qe.Image&&((new Image).src=e.v,n=!0),n||(e.g=$o(e.l,null),e.g.ea(e.v)),e.F=Date.now(),li(e)}jo(t)}function Ao(t){t.g&&(Po(t),t.g.cancel(),t.g=null)}function ko(t){Ao(t),t.u&&(Qe.clearTimeout(t.u),t.u=null),Fo(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Qe.clearTimeout(t.m),t.m=null)}function No(t,e){t.l.push(new $i(t.Za++,e)),3==t.G&&Do(t)}function Do(t){Gi(t.i)||t.m||(t.m=!0,wr(t.Ha,t),t.C=0)}function Co(t,e){var n;n=e?e.m:t.V++;var r=Ii(t.F);ki(r,"SID",t.J),ki(r,"RID",n),ki(r,"AID",t.U),xo(t,r),t.o&&t.s&&Io(r,t.o,t.s),n=new ti(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=Ro(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Wi(t.i,n),oi(n,r,e)}function xo(t,e){t.j&&gi({},(function(t,n){ki(e,n,t)}))}function Ro(t,e,n){n=Math.min(t.l.length,n);var r=t.j?nn(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].h,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{to(l,s,"req"+c+"_")}catch(t){r&&r(l)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function Oo(t){t.g||t.u||(t.Y=1,wr(t.Ga,t),t.A=0)}function Lo(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=$r(nn(t.Ga,t),Uo(t,t.A)),t.A++,!0)}function Po(t){null!=t.B&&(Qe.clearTimeout(t.B),t.B=null)}function Mo(t){t.g=new ti(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Ii(t.oa);ki(e,"RID","rpc"),ki(e,"SID",t.J),ki(e,"CI",t.N?"0":"1"),ki(e,"AID",t.U),xo(t,e),ki(e,"TYPE","xmlhttp"),t.o&&t.s&&Io(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Ni(Ii(e)),n.s=null,n.U=!0,si(n,t)}function Fo(t){null!=t.v&&(Qe.clearTimeout(t.v),t.v=null)}function Vo(t,e){var n=null;if(t.g==e){Fo(t),Po(t),t.g=null;var r=2}else{if(!Qi(t.i,e))return;n=e.D,Yi(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;hr(r=Fr(),new Br(r,n,e,i)),Do(t)}else Oo(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Hi(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=$r(nn(t.Ha,t,e),Uo(t,t.C)),t.C++,0)))}(t,e)||2==r&&Lo(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:qo(t,5);break;case 4:qo(t,10);break;case 3:qo(t,6);break;default:qo(t,2)}}function Uo(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function qo(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=nn(t.jb,t);n||(n=new Ei("//www.google.com/images/cleardot.gif"),Qe.location&&"http"==Qe.location.protocol||_i(n,"https"),Ni(n)),function(t,e){var n=new Or;if(Qe.Image){var r=new Image;r.onload=rn(eo,n,r,"TestLoadImage: loaded",!0,e),r.onerror=rn(eo,n,r,"TestLoadImage: error",!1,e),r.onabort=rn(eo,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=rn(eo,n,r,"TestLoadImage: timeout",!1,e),Qe.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else jr(2);t.G=0,t.j&&t.j.va(e),jo(t),ko(t)}function jo(t){t.G=0,t.I=-1,t.j&&(0==Xi(t.i).length&&0==t.l.length||(t.i.i.length=0,hn(t.l),t.l.length=0),t.j.ua())}function Bo(t,e,n){var r=function(t){return t instanceof Ei?Ii(t):new Ei(t,void 0)}(n);if(""!=r.i)e&&Ti(r,e+"."+r.i),Si(r,r.m);else{var i=Qe.location;r=function(t,e,n,r){var i=new Ei(null,void 0);return t&&_i(i,t),e&&Ti(i,e),n&&Si(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&bn(t.aa,(function(t,e){ki(r,e,t)})),e=t.D,n=t.sa,e&&n&&ki(r,e,n),ki(r,"VER",t.ma),xo(t,r),r}function $o(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new co(new no({ib:!0})):new co(t.qa)).L=t.H,e}function zo(){}function Ko(){if(kn&&!(10<=Number(qn)))throw Error("Environmental error: no available transport.")}function Go(t,e){lr.call(this),this.g=new To(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!fn(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!fn(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Wo(this)}function Ho(t){Xr.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Qo(){Jr.call(this),this.status=1}function Wo(t){this.g=t}(Ke=co.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Wr.g(),this.C=this.u?Hr(this.u):Hr(Wr),this.g.onreadystatechange=nn(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void vo(this,t)}t=n||"";var i=new yi(this.headers);r&&gi(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=po,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=Qe.FormData&&t instanceof Qe.FormData,!(0<=un(fo,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{bo(this),0<this.B&&((this.K=function(t){return kn&&Vn()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=nn(this.pa,this)):this.A=Ar(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){vo(this,t)}},Ke.pa=function(){void 0!==He&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,hr(this,"timeout"),this.abort(8))},Ke.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,hr(this,"complete"),hr(this,"abort"),mo(this))},Ke.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),mo(this,!0)),co.Z.M.call(this)},Ke.Fa=function(){this.s||(this.F||this.v||this.l?yo(this):this.cb())},Ke.cb=function(){yo(this)},Ke.ba=function(){try{return 2<wo(this)?this.g.status:-1}catch(t){return-1}},Ke.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Ke.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),uo(e)}},Ke.Da=function(){return this.m},Ke.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ke=To.prototype).ma=8,Ke.G=1,Ke.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},Ke.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new ti(this,this.h,t,void 0),n=this.s;if(this.P&&(n?In(n=wn(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=Ro(this,e,r),ki(i=Ii(this.F),"RID",t),ki(i,"CVER",22),this.D&&ki(i,"X-HTTP-Session-Id",this.D),xo(this,i),this.o&&n&&Io(i,this.o,n),Wi(this.i,e),this.Ra&&ki(i,"TYPE","init"),this.ja?(ki(i,"$req",r),ki(i,"SID","null"),e.$=!0,oi(e,i,null)):oi(e,i,r),this.G=2}}else 3==this.G&&(t?Co(this,t):0==this.l.length||Gi(this.i)||Co(this))},Ke.Ga=function(){if(this.u=null,Mo(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=$r(nn(this.bb,this),t)}},Ke.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,jr(10),Ao(this),Mo(this))},Ke.ab=function(){null!=this.v&&(this.v=null,Ao(this),Lo(this),jr(19))},Ke.jb=function(t){t?(this.h.info("Successfully pinged google.com"),jr(2)):(this.h.info("Failed to ping google.com"),jr(1))},(Ke=zo.prototype).xa=function(){},Ke.wa=function(){},Ke.va=function(){},Ke.ua=function(){},Ke.Oa=function(){},Ko.prototype.g=function(t,e){return new Go(t,e)},on(Go,lr),Go.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),wr(nn(t.hb,t,e))),jr(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=Bo(t,null,t.W),Do(t)},Go.prototype.close=function(){So(this.g)},Go.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,No(this.g,e)}else this.v?((e={}).__data__=dr(t),No(this.g,e)):No(this.g,t)},Go.prototype.M=function(){this.g.j=null,delete this.j,So(this.g),delete this.g,Go.Z.M.call(this)},on(Ho,Xr),on(Qo,Jr),on(Wo,zo),Wo.prototype.xa=function(){hr(this.g,"a")},Wo.prototype.wa=function(t){hr(this.g,new Ho(t))},Wo.prototype.va=function(t){hr(this.g,new Qo(t))},Wo.prototype.ua=function(){hr(this.g,"b")},Ko.prototype.createWebChannel=Ko.prototype.g,Go.prototype.send=Go.prototype.u,Go.prototype.open=Go.prototype.m,Go.prototype.close=Go.prototype.close,zr.NO_ERROR=0,zr.TIMEOUT=8,zr.HTTP_ERROR=6,Kr.COMPLETE="complete",Qr.EventType=Yr,Yr.OPEN="a",Yr.CLOSE="b",Yr.ERROR="c",Yr.MESSAGE="d",lr.prototype.listen=lr.prototype.N,co.prototype.listenOnce=co.prototype.O,co.prototype.getLastError=co.prototype.La,co.prototype.getLastErrorCode=co.prototype.Da,co.prototype.getStatus=co.prototype.ba,co.prototype.getResponseJson=co.prototype.Qa,co.prototype.getResponseText=co.prototype.ga,co.prototype.send=co.prototype.ea;var Yo=zr,Xo=Kr,Jo=Pr,Zo=10,ts=11,es=no,ns=Qr,rs=co,is=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();is.o=-1;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var os={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ss=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Gt(e,t),e}(Error),as=new Ae("@firebase/firestore");function us(){return as.logLevel}function cs(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(as.logLevel<=be.DEBUG){var r=e.map(fs);as.debug.apply(as,Jt(["Firestore (8.8.0): "+t],r))}}function ls(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(as.logLevel<=be.ERROR){var r=e.map(fs);as.error.apply(as,Jt(["Firestore (8.8.0): "+t],r))}}function hs(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(as.logLevel<=be.WARN){var r=e.map(fs);as.warn.apply(as,Jt(["Firestore (8.8.0): "+t],r))}}function fs(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ds(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.8.0) INTERNAL ASSERTION FAILED: "+t;throw ls(e),new Error(e)}function ps(t,e){t||ds()}function vs(t,e){return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function gs(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ys=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=gs(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function ms(t,e){return t<e?-1:t>e?1:0}function bs(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function ws(t){return t+"\0"}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Es=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new ss(os.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new ss(os.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new ss(os.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new ss(os.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?ms(this.nanoseconds,t.nanoseconds):ms(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Is=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new Es(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function _s(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ts(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ss(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var As=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&ds(),void 0===n?n=t.length-e:n>t.length-e&&ds(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),ks=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Gt(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new ss(os.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(As),Ns=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ds=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Gt(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return Ns.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new ss(os.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new ss(os.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new ss(os.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new ss(os.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(As),Cs=function(){function t(t){this.fields=t,t.sort(Ds.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return bs(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),xs=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return ms(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();xs.EMPTY_BYTE_STRING=new xs("");var Rs=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Os(t){if(ps(!!t),"string"==typeof t){var e=0,n=Rs.exec(t);if(ps(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ls(t.seconds),nanos:Ls(t.nanos)}}function Ls(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ps(t){return"string"==typeof t?xs.fromBase64String(t):xs.fromUint8Array(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ms(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Fs(t){var e=t.mapValue.fields.__previous_value__;return Ms(e)?Fs(e):e}function Vs(t){var e=Os(t.mapValue.fields.__local_write_time__.timestampValue);return new Es(e.seconds,e.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Us(t){return null==t}function qs(t){return 0===t&&1/t==-1/0}function js(t){return"number"==typeof t&&Number.isInteger(t)&&!qs(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Bs=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(ks.fromString(e))},t.fromName=function(e){return new t(ks.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===ks.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return ks.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new ks(e.slice()))},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function $s(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ms(t)?4:10:ds()}function zs(t,e){var n=$s(t);if(n!==$s(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Vs(t).isEqual(Vs(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Os(t.timestampValue),r=Os(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Ps(t.bytesValue).isEqual(Ps(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Ls(t.geoPointValue.latitude)===Ls(e.geoPointValue.latitude)&&Ls(t.geoPointValue.longitude)===Ls(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ls(t.integerValue)===Ls(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Ls(t.doubleValue),r=Ls(e.doubleValue);return n===r?qs(n)===qs(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return bs(t.arrayValue.values||[],e.arrayValue.values||[],zs);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(_s(n)!==_s(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!zs(n[i],r[i])))return!1;return!0}(t,e);default:return ds()}}function Ks(t,e){return void 0!==(t.values||[]).find((function(t){return zs(t,e)}))}function Gs(t,e){var n=$s(t),r=$s(e);if(n!==r)return ms(n,r);switch(n){case 0:return 0;case 1:return ms(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Ls(t.integerValue||t.doubleValue),r=Ls(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Hs(t.timestampValue,e.timestampValue);case 4:return Hs(Vs(t),Vs(e));case 5:return ms(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Ps(t),r=Ps(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ms(n[i],r[i]);if(0!==o)return o}return ms(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=ms(Ls(t.latitude),Ls(e.latitude));return 0!==n?n:ms(Ls(t.longitude),Ls(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Gs(n[i],r[i]);if(o)return o}return ms(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=ms(r[s],o[s]);if(0!==a)return a;var u=Gs(n[r[s]],i[o[s]]);if(0!==u)return u}return ms(r.length,o.length)}(t.mapValue,e.mapValue);default:throw ds()}}function Hs(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ms(t,e);var n=Os(t),r=Os(e),i=ms(n.seconds,r.seconds);return 0!==i?i:ms(n.nanos,r.nanos)}function Qs(t){return Ws(t)}function Ws(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Os(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Ps(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Bs.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Ws(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Ws(t.fields[o])}return e+"}"}(t.mapValue):ds();var e,n}function Ys(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Xs(t){return!!t&&"integerValue"in t}function Js(t){return!!t&&"arrayValue"in t}function Zs(t){return!!t&&"nullValue"in t}function ta(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ea(t){return!!t&&"mapValue"in t}function na(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return Ts(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=na(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=na(t.arrayValue.values[r]);return n}return Object.assign({},t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ra=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!ea(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=na(e)},t.prototype.setAll=function(t){var e=this,n=Ds.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=na(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());ea(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return zs(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];ea(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){Ts(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(na(this.value))},t}();function ia(t){var e=[];return Ts(t.fields,(function(t,n){var r=new Ds([t]);if(ea(n)){var i=ia(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new Cs(e)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var oa=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,Is.min(),ra.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,ra.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,ra.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=ra.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=ra.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),sa=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function aa(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new sa(t,e,n,r,i,o,s)}function ua(t){var e=vs(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Qs(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),Us(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Ea(e.startAt)),e.endAt&&(n+="|ub:",n+=Ea(e.endAt)),e.h=n}return e.h}function ca(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!_a(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!zs(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Sa(t.startAt,e.startAt)&&Sa(t.endAt,e.endAt)}function la(t){return Bs.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var ha=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Gt(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new fa(t,n,r):"array-contains"===n?new ga(t,r):"in"===n?new ya(t,r):"not-in"===n?new ma(t,r):"array-contains-any"===n?new ba(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new da(t,n):new pa(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Gs(e,this.value)):null!==e&&$s(this.value)===$s(e)&&this.m(Gs(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ds()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),fa=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Bs.fromName(r.referenceValue),i}return Gt(e,t),e.prototype.matches=function(t){var e=Bs.comparator(t.key,this.key);return this.m(e)},e}(ha),da=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=va("in",n),r}return Gt(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(ha),pa=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=va("not-in",n),r}return Gt(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(ha);function va(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Bs.fromName(t.referenceValue)}))}var ga=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Gt(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Js(e)&&Ks(e.arrayValue,this.value)},e}(ha),ya=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Gt(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Ks(this.value.arrayValue,e)},e}(ha),ma=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Gt(e,t),e.prototype.matches=function(t){if(Ks(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Ks(this.value.arrayValue,e)},e}(ha),ba=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Gt(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Js(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Ks(e.value.arrayValue,t)}))},e}(ha),wa=function(t,e){this.position=t,this.before=e};function Ea(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Qs(t)})).join(",")}var Ia=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function _a(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Ta(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Bs.comparator(Bs.fromName(s.referenceValue),n.key):Gs(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Sa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!zs(t.position[n],e.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Aa=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function ka(t,e,n,r,i,o,s,a){return new Aa(t,e,n,r,i,o,s,a)}function Na(t){return new Aa(t)}function Da(t){return!Us(t.limit)&&"F"===t.limitType}function Ca(t){return!Us(t.limit)&&"L"===t.limitType}function xa(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Ra(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Oa(t){return null!==t.collectionGroup}function La(t){var e=vs(t);if(null===e.p){e.p=[];var n=Ra(e),r=xa(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new Ia(n)),e.p.push(new Ia(Ds.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new Ia(Ds.keyField(),u))}}}return e.p}function Pa(t){var e=vs(t);if(!e.T)if("F"===e.limitType)e.T=aa(e.path,e.collectionGroup,La(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=La(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Ia(o.field,s))}var a=e.endAt?new wa(e.endAt.position,!e.endAt.before):null,u=e.startAt?new wa(e.startAt.position,!e.startAt.before):null;e.T=aa(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function Ma(t,e,n){return new Aa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Fa(t,e){return ca(Pa(t),Pa(e))&&t.limitType===e.limitType}function Va(t){return ua(Pa(t))+"|lt:"+t.limitType}function Ua(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Qs(e.value);var e})).join(", ")+"]"),Us(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Ea(t.startAt)),t.endAt&&(e+=", endAt: "+Ea(t.endAt)),"Target("+e+")"}(Pa(t))+"; limitType="+t.limitType+")"}function qa(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Bs.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Ta(t.startAt,La(t),e)||t.endAt&&Ta(t.endAt,La(t),e))}(t,e)}function ja(t){return function(e,n){for(var r=!1,i=0,o=La(t);i<o.length;i++){var s=o[i],a=Ba(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function Ba(t,e,n){var r=t.field.isKeyField()?Bs.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Gs(r,i):ds()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ds()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function $a(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qs(e)?"-0":e}}function za(t){return{integerValue:""+t}}function Ka(t,e){return js(e)?za(e):$a(t,e)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ga=function(){this._=void 0};function Ha(t,e,n){return t instanceof Ya?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Xa?Ja(t,e):t instanceof Za?tu(t,e):function(t,e){var n=Wa(t,e),r=nu(n)+nu(t.A);return Xs(n)&&Xs(t.A)?za(r):$a(t.R,r)}(t,e)}function Qa(t,e,n){return t instanceof Xa?Ja(t,e):t instanceof Za?tu(t,e):n}function Wa(t,e){return t instanceof eu?Xs(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Ya=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Gt(e,t),e}(Ga),Xa=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Gt(e,t),e}(Ga);function Ja(t,e){for(var n=ru(e),r=function(t){n.some((function(e){return zs(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Za=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Gt(e,t),e}(Ga);function tu(t,e){for(var n=ru(e),r=function(t){n=n.filter((function(e){return!zs(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var eu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return Gt(e,t),e}(Ga);function nu(t){return Ls(t.integerValue||t.doubleValue)}function ru(t){return Js(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var iu=function(t,e){this.field=t,this.transform=e},ou=function(t,e){this.version=t,this.transformResults=e},su=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function au(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var uu=function(){};function cu(t,e,n){t instanceof pu?function(t,e,n){var r=t.value.clone(),i=yu(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof vu?function(t,e,n){if(au(t.precondition,e)){var r=yu(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(gu(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function lu(t,e,n){t instanceof pu?function(t,e,n){if(au(t.precondition,e)){var r=t.value.clone(),i=mu(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(du(e),r).setHasLocalMutations()}}(t,e,n):t instanceof vu?function(t,e,n){if(au(t.precondition,e)){var r=mu(t.fieldTransforms,n,e),i=e.data;i.setAll(gu(t)),i.setAll(r),e.convertToFoundDocument(du(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){au(t.precondition,e)&&e.convertToNoDocument(Is.min())}(t,e)}function hu(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=Wa(o.transform,s||null);null!=a&&(null==n&&(n=ra.empty()),n.set(o.field,a))}return n||null}function fu(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&bs(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Xa&&e instanceof Xa||t instanceof Za&&e instanceof Za?bs(t.elements,e.elements,zs):t instanceof eu&&e instanceof eu?zs(t.A,e.A):t instanceof Ya&&e instanceof Ya}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function du(t){return t.isFoundDocument()?t.version:Is.min()}var pu=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Gt(e,t),e}(uu),vu=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return Gt(e,t),e}(uu);function gu(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function yu(t,e,n){var r=new Map;ps(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,Qa(s,a,n[i]))}return r}function mu(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,Ha(a,u,e))}return r}var bu,wu,Eu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Gt(e,t),e}(uu),Iu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Gt(e,t),e}(uu),_u=function(t){this.count=t};function Tu(t){switch(t){case os.OK:return ds();case os.CANCELLED:case os.UNKNOWN:case os.DEADLINE_EXCEEDED:case os.RESOURCE_EXHAUSTED:case os.INTERNAL:case os.UNAVAILABLE:case os.UNAUTHENTICATED:return!1;case os.INVALID_ARGUMENT:case os.NOT_FOUND:case os.ALREADY_EXISTS:case os.PERMISSION_DENIED:case os.FAILED_PRECONDITION:case os.ABORTED:case os.OUT_OF_RANGE:case os.UNIMPLEMENTED:case os.DATA_LOSS:return!0;default:return ds()}}function Su(t){if(void 0===t)return ls("GRPC error has no .code"),os.UNKNOWN;switch(t){case bu.OK:return os.OK;case bu.CANCELLED:return os.CANCELLED;case bu.UNKNOWN:return os.UNKNOWN;case bu.DEADLINE_EXCEEDED:return os.DEADLINE_EXCEEDED;case bu.RESOURCE_EXHAUSTED:return os.RESOURCE_EXHAUSTED;case bu.INTERNAL:return os.INTERNAL;case bu.UNAVAILABLE:return os.UNAVAILABLE;case bu.UNAUTHENTICATED:return os.UNAUTHENTICATED;case bu.INVALID_ARGUMENT:return os.INVALID_ARGUMENT;case bu.NOT_FOUND:return os.NOT_FOUND;case bu.ALREADY_EXISTS:return os.ALREADY_EXISTS;case bu.PERMISSION_DENIED:return os.PERMISSION_DENIED;case bu.FAILED_PRECONDITION:return os.FAILED_PRECONDITION;case bu.ABORTED:return os.ABORTED;case bu.OUT_OF_RANGE:return os.OUT_OF_RANGE;case bu.UNIMPLEMENTED:return os.UNIMPLEMENTED;case bu.DATA_LOSS:return os.DATA_LOSS;default:return ds()}}(wu=bu||(bu={}))[wu.OK=0]="OK",wu[wu.CANCELLED=1]="CANCELLED",wu[wu.UNKNOWN=2]="UNKNOWN",wu[wu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wu[wu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wu[wu.NOT_FOUND=5]="NOT_FOUND",wu[wu.ALREADY_EXISTS=6]="ALREADY_EXISTS",wu[wu.PERMISSION_DENIED=7]="PERMISSION_DENIED",wu[wu.UNAUTHENTICATED=16]="UNAUTHENTICATED",wu[wu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wu[wu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wu[wu.ABORTED=10]="ABORTED",wu[wu.OUT_OF_RANGE=11]="OUT_OF_RANGE",wu[wu.UNIMPLEMENTED=12]="UNIMPLEMENTED",wu[wu.INTERNAL=13]="INTERNAL",wu[wu.UNAVAILABLE=14]="UNAVAILABLE",wu[wu.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Au=function(){function t(t,e){this.comparator=t,this.root=e||Nu.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Nu.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Nu.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new ku(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new ku(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new ku(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new ku(this.root,t,this.comparator,!0)},t}(),ku=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Nu=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw ds();if(this.right.isRed())throw ds();var t=this.left.check();if(t!==this.right.check())throw ds();return t+(this.isRed()?0:1)},t}();Nu.EMPTY=null,Nu.RED=!0,Nu.BLACK=!1,Nu.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw ds()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw ds()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw ds()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw ds()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw ds()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Nu(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Du=function(){function t(t){this.comparator=t,this.data=new Au(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Cu(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Cu(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Cu=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),xu=new Au(Bs.comparator);function Ru(){return xu}var Ou=new Au(Bs.comparator);function Lu(){return Ou}var Pu=new Au(Bs.comparator);var Mu=new Du(Bs.comparator);function Fu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Mu,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Vu=new Du(ms);function Uu(){return Vu}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var qu=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,ju.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(Is.min(),r,Uu(),Ru(),Fu())},t}(),ju=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(xs.EMPTY_BYTE_STRING,n,Fu(),Fu(),Fu())},t}(),Bu=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},$u=function(t,e){this.targetId=t,this.V=e},zu=function(t,e,n,r){void 0===n&&(n=xs.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ku=function(){function t(){this.S=0,this.D=Qu(),this.C=xs.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=Fu(),e=Fu(),n=Fu();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:ds()}})),new ju(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=Qu()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),Gu=function(){function t(t){this.W=t,this.G=new Map,this.H=Ru(),this.J=Hu(),this.Y=new Du(ms)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:ds()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(la(i))if(0===n){var o=new Bs(i.path);this.tt(e,o,oa.newNoDocument(o,Is.min()))}else ps(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&la(o.target)){var s=new Bs(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,oa.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=Fu();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new qu(t,n,this.Y,this.H,r);return this.H=Ru(),this.J=Hu(),this.Y=new Du(ms),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Ku,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Du(ms),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||cs("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Ku),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Hu(){return new Au(Bs.comparator)}function Qu(){return new Au(Bs.comparator)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Wu={asc:"ASCENDING",desc:"DESCENDING"},Yu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Xu=function(t,e){this.databaseId=t,this.I=e};function Ju(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Zu(t,e){return t.I?e.toBase64():e.toUint8Array()}function tc(t,e){return Ju(t,e.toTimestamp())}function ec(t){return ps(!!t),Is.fromTimestamp(function(t){var e=Os(t);return new Es(e.seconds,e.nanos)}(t))}function nc(t,e){return function(t){return new ks(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function rc(t){var e=ks.fromString(t);return ps(Ac(e)),e}function ic(t,e){return nc(t.databaseId,e.path)}function oc(t,e){var n=rc(e);if(n.get(1)!==t.databaseId.projectId)throw new ss(os.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ss(os.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Bs(cc(n))}function sc(t,e){return nc(t.databaseId,e)}function ac(t){var e=rc(t);return 4===e.length?ks.emptyPath():cc(e)}function uc(t){return new ks(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function cc(t){return ps(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function lc(t,e,n){return{name:ic(t,e),fields:n.value.mapValue.fields}}function hc(t,e){var n;if(e instanceof pu)n={update:lc(t,e.key,e.value)};else if(e instanceof Eu)n={delete:ic(t,e.key)};else if(e instanceof vu)n={update:lc(t,e.key,e.data),updateMask:Sc(e.fieldMask)};else{if(!(e instanceof Iu))return ds();n={verify:ic(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Ya)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Xa)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Za)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof eu)return{fieldPath:e.field.canonicalString(),increment:n.A};throw ds()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:tc(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:ds()}(t,e.precondition)),n}function fc(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?su.updateTime(ec(t.updateTime)):void 0!==t.exists?su.exists(t.exists):su.none()}(e.currentDocument):su.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)ps("REQUEST_TIME"===e.setToServerValue),n=new Ya;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new Xa(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Za(i)}else"increment"in e?n=new eu(t,e.increment):ds();var o=Ds.fromServerFormat(e.fieldPath);return new iu(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=oc(t,e.update.name),o=new ra({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new Cs(e.map((function(t){return Ds.fromServerFormat(t)})))}(e.updateMask);return new vu(i,o,s,n,r)}return new pu(i,o,n,r)}if(e.delete){var a=oc(t,e.delete);return new Eu(a,n)}if(e.verify){var u=oc(t,e.verify);return new Iu(u,n)}return ds()}function dc(t,e){return{documents:[sc(t,e.path)]}}function pc(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=sc(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=sc(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(ta(t.value))return{unaryFilter:{field:Ec(t.field),op:"IS_NAN"}};if(Zs(t.value))return{unaryFilter:{field:Ec(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ta(t.value))return{unaryFilter:{field:Ec(t.field),op:"IS_NOT_NAN"}};if(Zs(t.value))return{unaryFilter:{field:Ec(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ec(t.field),op:wc(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Ec(t.field),direction:bc(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||Us(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=yc(e.startAt)),e.endAt&&(n.structuredQuery.endAt=yc(e.endAt)),n}function vc(t){var e=ac(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){ps(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=gc(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new Ia(Ic(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return Us(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=mc(n.startAt));var l=null;return n.endAt&&(l=mc(n.endAt)),ka(e,i,a,s,u,"F",c,l)}function gc(t){return t?void 0!==t.unaryFilter?[Tc(t)]:void 0!==t.fieldFilter?[_c(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return gc(t)})).reduce((function(t,e){return t.concat(e)})):ds():[]}function yc(t){return{before:t.before,values:t.position}}function mc(t){var e=!!t.before,n=t.values||[];return new wa(n,e)}function bc(t){return Wu[t]}function wc(t){return Yu[t]}function Ec(t){return{fieldPath:t.canonicalString()}}function Ic(t){return Ds.fromServerFormat(t.fieldPath)}function _c(t){return ha.create(Ic(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return ds()}}(t.fieldFilter.op),t.fieldFilter.value)}function Tc(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ic(t.unaryFilter.field);return ha.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ic(t.unaryFilter.field);return ha.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ic(t.unaryFilter.field);return ha.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ic(t.unaryFilter.field);return ha.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return ds()}}function Sc(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function Ac(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function kc(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Dc(e)),e=Nc(t.get(n),e);return Dc(e)}function Nc(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Dc(t){return t+""}function Cc(t){var e=t.length;if(ps(e>=2),2===e)return ps(""===t.charAt(0)&&""===t.charAt(1)),ks.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&ds(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:ds()}o=s+2}return new ks(r)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var xc=function(t,e){this.seconds=t,this.nanoseconds=e},Rc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Rc.store="owner",Rc.key="owner";var Oc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Oc.store="mutationQueues",Oc.keyPath="userId";var Lc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Lc.store="mutations",Lc.keyPath="batchId",Lc.userMutationsIndex="userMutationsIndex",Lc.userMutationsKeyPath=["userId","batchId"];var Pc=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,kc(e)]},t.key=function(t,e,n){return[t,kc(e),n]},t}();Pc.store="documentMutations",Pc.PLACEHOLDER=new Pc;var Mc=function(t,e){this.path=t,this.readTime=e},Fc=function(t,e){this.path=t,this.version=e},Vc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Vc.store="remoteDocuments",Vc.readTimeIndex="readTimeIndex",Vc.readTimeIndexPath="readTime",Vc.collectionReadTimeIndex="collectionReadTimeIndex",Vc.collectionReadTimeIndexPath=["parentPath","readTime"];var Uc=function(t){this.byteSize=t};Uc.store="remoteDocumentGlobal",Uc.key="remoteDocumentGlobalKey";var qc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};qc.store="targets",qc.keyPath="targetId",qc.queryTargetsIndexName="queryTargetsIndex",qc.queryTargetsKeyPath=["canonicalId","targetId"];var jc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};jc.store="targetDocuments",jc.keyPath=["targetId","path"],jc.documentTargetsIndex="documentTargetsIndex",jc.documentTargetsKeyPath=["path","targetId"];var Bc=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Bc.key="targetGlobalKey",Bc.store="targetGlobal";var $c=function(t,e){this.collectionId=t,this.parent=e};$c.store="collectionParents",$c.keyPath=["collectionId","parent"];var zc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};zc.store="clientMetadata",zc.keyPath="clientId";var Kc=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Kc.store="bundles",Kc.keyPath="bundleId";var Gc=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Gc.store="namedQueries",Gc.keyPath="name";var Hc=Jt(Jt([],Jt(Jt([],Jt(Jt([],Jt(Jt([],[Oc.store,Lc.store,Pc.store,Vc.store,qc.store,Rc.store,Bc.store,jc.store]),[zc.store])),[Uc.store])),[$c.store])),[Kc.store,Gc.store]),Qc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Wc=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),Yc=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Xc=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&ds(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),Jc=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Yc,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new el(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=sl(e.target.error);n.ft.reject(new el(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new el(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(cs("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new rl(e)},t}(),Zc=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(ne())&&ls("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return cs("SimpleDb","Removing database:",t),il(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=ne(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Qt(this,void 0,void 0,(function(){var e,n=this;return Wt(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(cs("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new el(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new ss(os.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new el(t,n))},i.onupgradeneeded=function(t){cs("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){cs("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Qt(this,void 0,void 0,(function(){var i,o,s,a,u;return Wt(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,l;return Wt(this,(function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=h.sent(),e=Jc.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),Xc.reject(t)})).toPromise(),u={},s.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(h.sent(),s),u)];case 4:return c=h.sent(),l="FirebaseError"!==c.name&&o<3,cs("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),a.close(),l?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),tl=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return il(this.Pt.delete())},t}(),el=function(t){function e(e,n){var r=this;return(r=t.call(this,os.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Gt(e,t),e}(ss);function nl(t){return"IndexedDbTransactionError"===t.name}var rl=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(cs("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(cs("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),il(n)},t.prototype.add=function(t){return cs("SimpleDb","ADD",this.store.name,t,t),il(this.store.add(t))},t.prototype.get=function(t){var e=this;return il(this.store.get(t)).next((function(n){return void 0===n&&(n=null),cs("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return cs("SimpleDb","DELETE",this.store.name,t),il(this.store.delete(t))},t.prototype.count=function(){return cs("SimpleDb","COUNT",this.store.name),il(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){cs("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Xc((function(n,r){e.onerror=function(t){var e=sl(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new Xc((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new tl(i),s=e(i.primaryKey,i.value,o);if(s instanceof Xc){var a=s.catch((function(t){return o.done(),Xc.reject(t)}));n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return Xc.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function il(t){return new Xc((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=sl(t.target.error);n(e)}}))}var ol=!1;function sl(t){var e=Zc._t(ne());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new ss("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ol||(ol=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var al=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return Gt(e,t),e}(Wc);function ul(t,e){var n=vs(t);return Zc.It(n.Mt,e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var cl=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&cu(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&lu(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&lu(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(Is.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Fu())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&bs(this.mutations,t.mutations,(function(t,e){return fu(t,e)}))&&bs(this.baseMutations,t.baseMutations,(function(t,e){return fu(t,e)}))},t}(),ll=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){ps(e.mutations.length===r.length);for(var i=Pu,o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),hl=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Is.min()),void 0===o&&(o=Is.min()),void 0===s&&(s=xs.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),fl=function(t){this.Lt=t};function dl(t,e){if(e.document)return function(t,e,n){var r=oc(t,e.name),i=ec(e.updateTime),o=new ra({mapValue:{fields:e.fields}}),s=oa.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Bs.fromSegments(e.noDocument.path),r=ml(e.noDocument.readTime),i=oa.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Bs.fromSegments(e.unknownDocument.path);return r=ml(e.unknownDocument.version),oa.newUnknownDocument(o,r)}return ds()}function pl(t,e,n){var r=vl(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:ic(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Ju(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new Vc(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=yl(e.version);return s=e.hasCommittedMutations,new Vc(null,new Mc(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),l=yl(e.version);return new Vc(new Fc(c,l),null,null,!0,r,i)}return ds()}function vl(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function gl(t){var e=new Es(t[0],t[1]);return Is.fromTimestamp(e)}function yl(t){var e=t.toTimestamp();return new xc(e.seconds,e.nanoseconds)}function ml(t){var e=new Es(t.seconds,t.nanoseconds);return Is.fromTimestamp(e)}function bl(t,e){for(var n=(e.baseMutations||[]).map((function(e){return fc(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return fc(t.Lt,e)})),a=Es.fromMillis(e.localWriteTimeMs);return new cl(e.batchId,a,n,s)}function wl(t){var e,n,r=ml(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?ml(t.lastLimboFreeSnapshotVersion):Is.min();return void 0!==t.query.documents?(ps(1===(n=t.query).documents.length),e=Pa(Na(ac(n.documents[0])))):e=function(t){return Pa(vc(t))}(t.query),new hl(e,t.targetId,0,t.lastListenSequenceNumber,r,i,xs.fromBase64String(t.resumeToken))}function El(t,e){var n,r=yl(e.snapshotVersion),i=yl(e.lastLimboFreeSnapshotVersion);n=la(e.target)?dc(t.Lt,e.target):pc(t.Lt,e.target);var o=e.resumeToken.toBase64();return new qc(e.targetId,ua(e.target),r,o,e.sequenceNumber,i,n)}function Il(t){var e=vc({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ma(e,e.limit,"L"):e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var _l=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return Tl(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:ml(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return Tl(t).put({bundleId:(n=e).id,createTime:yl(ec(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return Sl(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Il(e.bundledQuery),readTime:ml(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return Sl(t).put(function(t){return{name:t.name,readTime:yl(ec(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Tl(t){return ul(t,Kc.store)}function Sl(t){return ul(t,Gc.store)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Al=function(){function t(){this.Bt=new kl}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Xc.resolve()},t.prototype.getCollectionParents=function(t,e){return Xc.resolve(this.Bt.getEntries(e))},t}(),kl=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Du(ks.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Du(ks.comparator)).toArray()},t}(),Nl=function(){function t(){this.qt=new kl}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:kc(i)};return Dl(t).put(o)}return Xc.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[ws(e),""],!1,!0);return Dl(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Cc(o.parent))}return n}))},t}();function Dl(t){return ul(t,$c.store)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Cl={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},xl=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Rl(t,e,n){var r=t.store(Lc.store),i=t.store(Pc.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){ps(1===a)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],d=Pc.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return Xc.waitFor(o).next((function(){return c}))}function Ol(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ds();e=t.noDocument}return JSON.stringify(e).length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */xl.DEFAULT_COLLECTION_PERCENTILE=10,xl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xl.DEFAULT=new xl(41943040,xl.DEFAULT_COLLECTION_PERCENTILE,xl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xl.DISABLED=new xl(-1,0,0);var Ll=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return ps(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ml(t).$t({index:Lc.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Fl(t),s=Ml(t);return s.add({}).next((function(a){ps("number"==typeof a);for(var u=new cl(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return hc(t.Lt,e)})),i=n.mutations.map((function(e){return hc(t.Lt,e)}));return new Lc(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),l=[],h=new Du((function(t,e){return ms(t.canonicalString(),e.canonicalString())})),f=0,d=r;f<d.length;f++){var p=d[f],v=Pc.key(i.userId,p.key.path,a);h=h.add(p.key.path.popLast()),l.push(s.put(c)),l.push(o.put(v,Pc.PLACEHOLDER))}return h.forEach((function(e){l.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[a]=u.keys()})),Xc.waitFor(l).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Ml(t).get(e).next((function(t){return t?(ps(t.userId===n.userId),bl(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?Xc.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ml(t).$t({index:Lc.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(ps(e.batchId>=r),o=bl(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ml(t).$t({index:Lc.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ml(t).Nt(Lc.userMutationsIndex,n).next((function(t){return t.map((function(t){return bl(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Pc.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Fl(t).$t({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],l=Cc(u);if(a===n.userId&&e.path.isEqual(l))return Ml(t).get(c).next((function(t){if(!t)throw ds();ps(t.userId===n.userId),o.push(bl(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Du(ms),i=[];return e.forEach((function(e){var o=Pc.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Fl(t).$t({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=Cc(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),Xc.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Pc.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Du(ms);return Fl(t).$t({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],l=Cc(u);s===n.userId&&r.isPrefixOf(l)?l.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Wt(t,a)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Ml(t).get(e).next((function(t){if(null===t)throw ds();ps(t.userId===n.userId),r.push(bl(n.R,t))})))})),Xc.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return Rl(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),Xc.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return Xc.resolve();var r=IDBKeyRange.lowerBound(Pc.prefixForUser(e.userId)),i=[];return Fl(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Cc(t[1]);i.push(o)}else r.done()})).next((function(){ps(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return Pl(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return Vl(t).get(this.userId).next((function(t){return t||new Oc(e.userId,-1,"")}))},t}();function Pl(t,e,n){var r=Pc.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Fl(t).$t({range:o,kt:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function Ml(t){return ul(t,Lc.store)}function Fl(t){return ul(t,Pc.store)}function Vl(t){return ul(t,Oc.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ul=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),ql=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new Ul(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return Is.fromTimestamp(new Es(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return jl(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return ps(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return jl(t).$t((function(s,a){var u=wl(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return Xc.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return jl(t).$t((function(t,n){var r=wl(n);e(r)}))},t.prototype.Xt=function(t){return Bl(t).get(Bc.key).next((function(t){return ps(null!==t),t}))},t.prototype.Zt=function(t,e){return Bl(t).put(Bc.key,e)},t.prototype.te=function(t,e){return jl(t).put(El(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=ua(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return jl(t).$t({range:r,index:qc.queryTargetsIndexName},(function(t,n,r){var o=wl(n);ca(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=$l(t);return e.forEach((function(e){var s=kc(e.path);i.push(o.put(new jc(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),Xc.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=$l(t);return Xc.forEach(e,(function(e){var o=kc(e.path);return Xc.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=$l(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=$l(t),i=Fu();return r.$t({range:n,kt:!0},(function(t,e,n){var r=Cc(t[1]),o=new Bs(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=kc(e.path),r=IDBKeyRange.bound([n],[ws(n)],!1,!0),i=0;return $l(t).$t({index:jc.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return jl(t).get(e).next((function(t){return t?wl(t):null}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function jl(t){return ul(t,qc.store)}function Bl(t){return ul(t,Bc.store)}function $l(t){return ul(t,jc.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function zl(t){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(e){if(t.code!==os.FAILED_PRECONDITION||t.message!==Qc)throw t;return cs("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Kl(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=ms(n,i);return 0===s?ms(r,o):s}var Gl=function(){function t(t){this.ne=t,this.buffer=new Du(Kl),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Kl(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Hl=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;cs("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return Qt(e,void 0,void 0,(function(){var e;return Wt(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return nl(e=n.sent())?(cs("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,zl(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Ql=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Xc.resolve(is.o);var r=new Gl(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(cs("LruGarbageCollector","Garbage collection skipped; disabled"),Xc.resolve(Cl)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(cs("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Cl):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(cs("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),us()<=be.DEBUG&&cs("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-l)+"ms"),Xc.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),Wl=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Ql(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return Yl(t,n)},t.prototype.removeReference=function(t,e,n){return Yl(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Yl(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return Vl(t).Ot((function(r){return Pl(t,r,e).next((function(t){return t&&(n=!0),Xc.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,a){if(a<=e){var u=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),$l(t).delete([0,kc(s.path)])}))}));i.push(u)}})).next((function(){return Xc.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Yl(t,e)},t.prototype.we=function(t,e){var n,r=$l(t),i=is.o;return r.$t({index:jc.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var s=r.path,a=r.sequenceNumber;0===o?(i!==is.o&&e(new Bs(Cc(n)),i),i=a,n=s):i=is.o})).next((function(){i!==is.o&&e(new Bs(Cc(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Yl(t,e){return $l(t).put(function(t,e){return new jc(0,kc(t.path),e)}(e,t.currentSequenceNumber))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Xl=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Ts(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return Ss(this.inner)},t}(),Jl=function(){function t(){this.changes=new Xl((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:Is.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:oa.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Xc.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Zl=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return nh(t).put(rh(e),n)},t.prototype.removeEntry=function(t,e){var n=nh(t),r=rh(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return nh(t).get(rh(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return nh(t).get(rh(e)).next((function(t){return{document:n.ye(e,t),size:Ol(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=Ru();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=Ru(),i=new Au(Bs.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Ol(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Xc.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return nh(t).$t({range:r},(function(t,e,r){for(var s=Bs.fromSegments(t);o&&Bs.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=Ru(),o=e.path.length+1,s={};if(n.isEqual(Is.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=vl(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Vc.collectionReadTimeIndex}return nh(t).$t(s,(function(t,n,s){if(t.length===o){var a=dl(r.R,n);e.path.isPrefixOf(a.key.path)?qa(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new th(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return eh(t).get(Uc.key).next((function(t){return ps(!!t),t}))},t.prototype.me=function(t,e){return eh(t).put(Uc.key,e)},t.prototype.ye=function(t,e){if(e){var n=dl(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(Is.min()))return n}return oa.newInvalidDocument(t)},t}(),th=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Xl((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return Gt(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Du((function(t,e){return ms(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=pl(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Ol(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var l=pl(e.Ie.R,oa.newNoDocument(o,Is.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,l))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),Xc.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(Jl);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function eh(t){return ul(t,Uc.store)}function nh(t){return ul(t,Vc.store)}function rh(t){return t.path.toArray()}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ih=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;ps(n<r&&n>=0&&r<=11);var o=new Jc("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Rc.store)}(t),function(t){t.createObjectStore(Oc.store,{keyPath:Oc.keyPath}),t.createObjectStore(Lc.store,{keyPath:Lc.keyPath,autoIncrement:!0}).createIndex(Lc.userMutationsIndex,Lc.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Pc.store)}(t),oh(t),function(t){t.createObjectStore(Vc.store)}(t));var s=Xc.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(jc.store),t.deleteObjectStore(qc.store),t.deleteObjectStore(Bc.store)}(t),oh(t)),s=s.next((function(){return function(t){var e=t.store(Bc.store),n=new Bc(0,0,Is.min().toTimestamp(),0);return e.put(Bc.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Lc.store).Nt().next((function(n){t.deleteObjectStore(Lc.store),t.createObjectStore(Lc.store,{keyPath:Lc.keyPath,autoIncrement:!0}).createIndex(Lc.userMutationsIndex,Lc.userMutationsKeyPath,{unique:!0});var r=e.store(Lc.store),i=n.map((function(t){return r.put(t)}));return Xc.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(zc.store,{keyPath:zc.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Uc.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Vc.store);e.createIndex(Vc.readTimeIndex,Vc.readTimeIndexPath,{unique:!1}),e.createIndex(Vc.collectionReadTimeIndex,Vc.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Kc.store,{keyPath:Kc.keyPath})}(t),function(t){t.createObjectStore(Gc.store,{keyPath:Gc.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(Vc.store).$t((function(t,n){e+=Ol(n)})).next((function(){var n=new Uc(e);return t.store(Uc.store).put(Uc.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(Oc.store),r=t.store(Lc.store);return n.Nt().next((function(n){return Xc.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Lc.userMutationsIndex,i).next((function(r){return Xc.forEach(r,(function(r){ps(r.userId===n.userId);var i=bl(e.R,r);return Rl(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(jc.store),n=t.store(Vc.store);return t.store(Bc.store).get(Bc.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new ks(n),s=function(t){return[0,kc(t)]}(o);r.push(e.get(s).next((function(n){return n?Xc.resolve():function(n){return e.put(new jc(0,kc(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Xc.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore($c.store,{keyPath:$c.keyPath});var n=e.store($c.store),r=new kl,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:kc(i)})}};return e.store(Vc.store).$t({kt:!0},(function(t,e){var n=new ks(t);return i(n.popLast())})).next((function(){return e.store(Pc.store).$t({kt:!0},(function(t,e){t[0];var n=t[1];t[2];var r=Cc(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(qc.store);return n.$t((function(t,r){var i=wl(r),o=El(e.R,i);return n.put(o)}))},t}();function oh(t){t.createObjectStore(jc.store,{keyPath:jc.keyPath}).createIndex(jc.documentTargetsIndex,jc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(qc.store,{keyPath:qc.keyPath}).createIndex(qc.queryTargetsIndexName,qc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Bc.store)}var sh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ah=function(){function t(e,n,r,i,o,s,a,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=l,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new ss(os.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Wl(this,i),this.Le=n+"main",this.R=new fl(u),this.Be=new Zc(this.Le,11,new ih(this.R)),this.qe=new ql(this.referenceDelegate,this.R),this.Ut=new Nl,this.Ue=function(t,e){return new Zl(t,e)}(this.R,this.Ut),this.Ke=new _l,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===l&&ls("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new ss(os.FAILED_PRECONDITION,sh);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new is(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Qt(e,void 0,void 0,(function(){return Wt(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return Qt(e,void 0,void 0,(function(){return Wt(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return Qt(e,void 0,void 0,(function(){return Wt(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return ch(e).put(new zc(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(nl(e))return cs("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return cs("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return uh(t).get(Rc.key).next((function(t){return Xc.resolve(e.tn(t))}))},t.prototype.en=function(t){return ch(t).delete(this.clientId)},t.prototype.nn=function(){return Qt(this,void 0,void 0,(function(){var t,e,n,r,i=this;return Wt(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=ul(t,zc.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return Xc.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Xc.resolve(!0):uh(t).get(Rc.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new ss(os.FAILED_PRECONDITION,sh);return!1}}return!(!e.networkEnabled||!e.inForeground)||ch(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&cs("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return Qt(this,void 0,void 0,(function(){var t=this;return Wt(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Rc.store,zc.store],(function(e){var n=new al(e,is.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return ch(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Ll.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;cs("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,Hc,(function(o){return i=new al(o,r.Ne?r.Ne.next():is.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw ls("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new ss(os.FAILED_PRECONDITION,Qc);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return uh(t).get(Rc.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new ss(os.FAILED_PRECONDITION,sh)}))},t.prototype.Ze=function(t){var e=new Rc(this.clientId,this.allowTabSynchronization,Date.now());return uh(t).put(Rc.key,e)},t.yt=function(){return Zc.yt()},t.prototype.Xe=function(t){var e=this,n=uh(t);return n.get(Rc.key).next((function(t){return e.tn(t)?(cs("IndexedDbPersistence","Releasing primary lease."),n.delete(Rc.key)):Xc.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(ls("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),!re()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match("Version/14")&&e.Se.enterRestrictedMode(!0),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return cs("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return ls("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){ls("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function uh(t){return ul(t,Rc.store)}function ch(t){return ul(t,zc.store)}function lh(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var hh=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Bs.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):Oa(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Bs(e)).next((function(t){var e=Lu();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=Lu();return this.Ut.getCollectionParents(t,i).next((function(s){return Xc.forEach(s,(function(s){var a=function(t,e){return new Aa(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,l=r.get(c);null==l&&(l=oa.newInvalidDocument(c),r=r.insert(c,l)),lu(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){qa(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=Fu(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof vu&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),fh=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=Fu(),i=Fu(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),dh=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(Is.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var s=i.Cn(e,o);return(Da(e)||Ca(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(us()<=be.DEBUG&&cs("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ua(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new Du(ja(t));return e.forEach((function(e,r){qa(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return us()<=be.DEBUG&&cs("QueryEngine","Using full collection scan to execute query:",Ua(e)),this.Sn.getDocumentsMatchingQuery(t,e,Is.min())},t}(),ph=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new Au(ms),this.kn=new Xl((function(t){return ua(t)}),ca),this.$n=Is.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new hh(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Fn)}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vh(t,e,n,r){return new ph(t,e,n,r)}function gh(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i,o;return Wt(this,(function(s){switch(s.label){case 0:return n=vs(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new hh(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=Fu(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];s=s.add(f.key)}}for(var d=0,p=e;d<p.length;d++){var v=p[d];r.push(v.batchId);for(var g=0,y=v.mutations;g<y.length;g++){var m=y[g];s=s.add(m.key)}}return i.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function yh(t,e){var n=vs(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Xc.resolve();return o.forEach((function(t){s=s.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);ps(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),s.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function mh(t){var e=vs(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function bh(t,e){var n=vs(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return ps(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}}));var a=Ru();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(function(t,e,n,r,i){var o=Fu();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Ru();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(Is.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):cs("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(Is.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return Xc.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,a)})).next((function(){return a}))})).then((function(t){return n.Fn=i,t}))}function wh(t,e){var n=vs(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function Eh(t,e){var n=vs(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,Xc.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new hl(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function Ih(t,e,n){return Qt(this,void 0,void 0,(function(){var r,i,o,s;return Wt(this,(function(a){switch(a.label){case 0:r=vs(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!nl(s=a.sent()))throw s;return cs("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}}))}))}function _h(t,e,n){var r=vs(t),i=Is.min(),o=Fu();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=vs(t),i=r.kn.get(n);return void 0!==i?Xc.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,Pa(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:Is.min(),n?o:Fu())})).next((function(t){return{documents:t,Bn:o}}))}))}function Th(t,e){var n=vs(t),r=vs(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function Sh(t){var e=vs(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=vs(t),i=Ru(),o=vl(n),s=nh(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:Vc.readTimeIndex,range:a},(function(t,e){var n=dl(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:gl(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function Ah(t){return Qt(this,void 0,void 0,(function(){var e;return Wt(this,(function(n){return[2,(e=vs(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=nh(t),n=Is.min();return e.$t({index:Vc.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=gl(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var kh=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Xc.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:ec(n.createTime)}),Xc.resolve()},t.prototype.getNamedQuery=function(t,e){return Xc.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:Il(t.bundledQuery),readTime:ec(t.readTime)}}(e)),Xc.resolve()},t}(),Nh=function(){function t(){this.Wn=new Du(Dh.Gn),this.zn=new Du(Dh.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Dh(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new Dh(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new Bs(new ks([])),r=new Dh(n,t),i=new Dh(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Bs(new ks([])),n=new Dh(e,t),r=new Dh(e,t+1),i=Fu();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new Dh(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Dh=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Bs.comparator(t.key,e.key)||ms(t.ns,e.ns)},t.Hn=function(t,e){return ms(t.ns,e.ns)||Bs.comparator(t.key,e.key)},t}(),Ch=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Du(Dh.Gn)}return t.prototype.checkEmpty=function(t){return Xc.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new cl(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new Dh(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Xc.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Xc.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return Xc.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Xc.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Xc.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Dh(e,0),i=new Dh(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),Xc.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Du(ms);return e.forEach((function(t){var e=new Dh(t,0),i=new Dh(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),Xc.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Bs.isDocumentKey(i)||(i=i.child(""));var o=new Dh(new Bs(i),0),s=new Du(ms);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),Xc.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;ps(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Xc.forEach(e.mutations,(function(i){var o=new Dh(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new Dh(e,0),r=this.rs.firstAfterOrEqual(n);return Xc.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,Xc.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),xh=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new Au(Bs.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Xc.resolve(n?n.document.clone():oa.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=Ru();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():oa.newInvalidDocument(t))})),Xc.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Ru(),i=new Bs(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,l=u.readTime;if(!e.path.isPrefixOf(a.path))break;l.compareTo(n)<=0||qa(e,c)&&(r=r.insert(c.key,c.clone()))}return Xc.resolve(r)},t.prototype.fs=function(t,e){return Xc.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new Rh(this)},t.prototype.getSize=function(t){return Xc.resolve(this.size)},t}(),Rh=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return Gt(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),Xc.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Jl),Oh=function(){function t(t){this.persistence=t,this.ds=new Xl((function(t){return ua(t)}),ca),this.lastRemoteSnapshotVersion=Is.min(),this.highestTargetId=0,this.ws=0,this._s=new Nh,this.targetCount=0,this.ys=Ul.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),Xc.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Xc.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Xc.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Xc.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Xc.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Ul(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Xc.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Xc.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Xc.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),Xc.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return Xc.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Xc.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Xc.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),Xc.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Xc.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Xc.resolve(n)},t.prototype.containsKey=function(t,e){return Xc.resolve(this._s.containsKey(e))},t}(),Lh=function(){function t(t,e){var n=this;this.gs={},this.Ne=new is(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Oh(this),this.Ut=new Al,this.Ue=function(t,e){return new xh(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new fl(e),this.Ke=new kh(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Ch(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;cs("MemoryPersistence","Starting transaction:",t);var i=new Ph(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return Xc.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),Ph=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return Gt(e,t),e}(Wc),Mh=function(){function t(t){this.persistence=t,this.As=new Nh,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw ds()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Xc.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Xc.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Xc.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Xc.forEach(this.vs,(function(r){var i=Bs.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Xc.or([function(){return Xc.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),Fh=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Vh(t,e){return"firestore_clients_"+t+"_"+e}function Uh(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function qh(t,e){return"firestore_targets_"+t+"_"+e}Fh.UNAUTHENTICATED=new Fh(null),Fh.GOOGLE_CREDENTIALS=new Fh("google-credentials-uid"),Fh.FIRST_PARTY=new Fh("first-party-uid");var jh=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new ss(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(ls("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Bh=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new ss(i.error.code,i.error.message)),o?new t(e,i.state,r):(ls("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),$h=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Uu(),s=0;i&&s<r.activeTargetIds.length;++s)i=js(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(ls("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),zh=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(ls("SharedClientState","Failed to parse online state: "+e),null)},t}(),Kh=function(){function t(){this.activeTargetIds=Uu()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Gh=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new Au(ms),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Vh(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Kh),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Qt(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,l,h=this;return Wt(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(Vh(this.persistenceKey,r)))&&(o=$h.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)l=c[u],this.Fs(l);return this.$s=[],this.window.addEventListener("pagehide",(function(){return h.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(qh(this.persistenceKey,t));if(n){var r=Bh.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(qh(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return cs("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){cs("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){cs("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(cs("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void ls("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return Qt(e,void 0,void 0,(function(){var t,e,r,i,o,s;return Wt(this,(function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=is.o;if(null!=t)try{var n=JSON.parse(t);ps("number"==typeof n),e=n}catch(t){ls("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==is.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new jh(this.currentUser,t,e,n),i=Uh(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Uh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=qh(this.persistenceKey,t),i=new Bh(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return $h.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return jh.Vs(new Fh(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Bh.Vs(r,e)},t.prototype.js=function(t){return zh.Vs(t)},t.prototype.ii=function(t){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(cs("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.hi(s,a).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=Uu();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),Hh=function(){function t(){this.li=new Kh,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Kh,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Qh=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Wh=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){cs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){cs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Yh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Xh=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Jh=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return Gt(e,t),e.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var s=new rs;s.listenOnce(Xo.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case Yo.NO_ERROR:var e=s.getResponseJson();cs("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Yo.TIMEOUT:cs("Connection",'RPC "'+t+'" timed out'),o(new ss(os.DEADLINE_EXCEEDED,"Request time out"));break;case Yo.HTTP_ERROR:var n=s.getStatus();if(cs("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(os).indexOf(e)>=0?e:os.UNKNOWN}(r.status);o(new ss(a,r.message))}else o(new ss(os.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new ss(os.UNAVAILABLE,"Connection failed."));break;default:ds()}}finally{cs("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new Ko,o=Fr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new es({})),this.Fi(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ne())||"object"==typeof navigator&&"ReactNative"===navigator.product||ne().indexOf("Electron/")>=0||function(){var t=ne();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||ne().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");cs("Connection","Creating WebChannel: "+a,s);var u=i.createWebChannel(a,s),c=!1,l=!1,h=new Xh({Ei:function(t){l?cs("Connection","Not sending because WebChannel is closed:",t):(c||(cs("Connection","Opening WebChannel transport."),u.open(),c=!0),cs("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,ns.EventType.OPEN,(function(){l||cs("Connection","WebChannel transport opened.")})),f(u,ns.EventType.CLOSE,(function(){l||(l=!0,cs("Connection","WebChannel transport closed"),h.Vi())})),f(u,ns.EventType.ERROR,(function(t){l||(l=!0,hs("Connection","WebChannel transport errored:",t),h.Vi(new ss(os.UNAVAILABLE,"The operation could not be completed")))})),f(u,ns.EventType.MESSAGE,(function(t){var e;if(!l){var n=t.data[0];ps(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){cs("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=bu[t];if(void 0!==e)return Su(e)}(o),a=i.message;void 0===s&&(s=os.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),l=!0,h.Vi(new ss(s,a)),u.close()}else cs("Connection","WebChannel received:",n),h.Si(n)}})),f(o,Jo.STAT_EVENT,(function(t){t.stat===Zo?cs("Connection","Detected buffering proxy"):t.stat===ts&&cs("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Pi()}),0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);cs("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return cs("RestConnection","Received: ",t),t}),(function(e){throw hs("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.8.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=Yh[t];return this.Di+"/v1/"+e+":"+n},t}());
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Zh(){return"undefined"!=typeof window?window:null}function tf(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ef(t){return new Xu(t,!0)}var nf=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&cs("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),rf=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new nf(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===os.RESOURCE_EXHAUSTED?(ls(e.toString()),ls("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===os.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new ss(os.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return Qt(t,void 0,void 0,(function(){return Wt(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return cs("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(cs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),of=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return Gt(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:ds()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(ps(void 0===e||"string"==typeof e),xs.fromBase64String(e||"")):(ps(void 0===e||e instanceof Uint8Array),xs.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?os.UNKNOWN:Su(t.code);return new ss(e,t.message||"")}(a);n=new zu(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=oc(t,r.document.name),o=ec(r.document.updateTime);var a=new ra({mapValue:{fields:r.document.fields}}),u=(s=oa.newFoundDocument(i,o,a),r.targetIds||[]),c=r.removedTargetIds||[];n=new Bu(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=oc(t,r.document),o=r.readTime?ec(r.readTime):Is.min(),a=oa.newNoDocument(i,o),s=r.removedTargetIds||[],n=new Bu([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=oc(t,r.document),o=r.removedTargetIds||[],n=new Bu([],o,i,null);else{if(!("filter"in e))return ds();e.filter;var l=e.filter;l.targetId,r=l.count||0,i=new _u(r),o=l.targetId,n=new $u(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return Is.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Is.min():e.readTime?ec(e.readTime):Is.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=uc(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=la(r)?{documents:dc(t,r)}:{query:pc(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Zu(t,e.resumeToken):e.snapshotVersion.compareTo(Is.min())>0&&(n.readTime=Ju(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ds()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=uc(this.R),e.removeTarget=t,this.cr(e)},e}(rf),sf=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return Gt(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(ps(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(ps(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?ec(t.updateTime):ec(e);return n.isEqual(Is.min())&&(n=ec(e)),new ou(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=ec(t.commitTime);return this.listener.Tr(n,e)}return ps(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=uc(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return hc(e.R,t)}))};this.cr(n)},e}(rf),af=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return Gt(e,t),e.prototype.br=function(){if(this.Rr)throw new ss(os.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===os.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new ss(os.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===os.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new ss(os.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),uf=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(ls(e),this.Vr=!1):cs("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),cf=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return Qt(o,void 0,void 0,(function(){return Wt(this,(function(t){switch(t.label){case 0:return mf(this)?(cs("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Qt(this,void 0,void 0,(function(){var e;return Wt(this,(function(n){switch(n.label){case 0:return(e=vs(t)).Or.add(4),[4,hf(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,lf(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new uf(n,r)};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function lf(t){return Qt(this,void 0,void 0,(function(){var e,n;return Wt(this,(function(r){switch(r.label){case 0:if(!mf(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function hf(t){return Qt(this,void 0,void 0,(function(){var e,n;return Wt(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function ff(t,e){var n=vs(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),yf(n)?gf(n):Of(n).er()&&pf(n,e))}function df(t,e){var n=vs(t),r=Of(n);n.$r.delete(e),r.er()&&vf(n,e),0===n.$r.size&&(r.er()?r.ir():mf(n)&&n.Br.set("Unknown"))}function pf(t,e){t.qr.U(e.targetId),Of(t).mr(e)}function vf(t,e){t.qr.U(e),Of(t).yr(e)}function gf(t){t.qr=new Gu({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),Of(t).start(),t.Br.Sr()}function yf(t){return mf(t)&&!Of(t).tr()&&t.$r.size>0}function mf(t){return 0===vs(t).Or.size}function bf(t){t.qr=void 0}function wf(t){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(e){return t.$r.forEach((function(e,n){pf(t,e)})),[2]}))}))}function Ef(t,e){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(n){return bf(t),yf(t)?(t.Br.Nr(e),gf(t)):t.Br.set("Unknown"),[2]}))}))}function If(t,e,n){return Qt(this,void 0,void 0,(function(){var r,i,o;return Wt(this,(function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof zu&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i,o;return Wt(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),cs("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,_f(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Bu?t.qr.X(e):e instanceof $u?t.qr.rt(e):t.qr.et(e),n.isEqual(Is.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,mh(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(xs.EMPTY_BYTE_STRING,n.snapshotVersion)),vf(t,e);var r=new hl(n.target,e,1,n.sequenceNumber);pf(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return cs("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,_f(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function _f(t,e,n){return Qt(this,void 0,void 0,(function(){var r=this;return Wt(this,(function(i){switch(i.label){case 0:if(!nl(e))throw e;return t.Or.add(1),[4,hf(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return mh(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return Qt(r,void 0,void 0,(function(){return Wt(this,(function(e){switch(e.label){case 0:return cs("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,lf(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Tf(t,e){return e().catch((function(n){return _f(t,n,e)}))}function Sf(t){return Qt(this,void 0,void 0,(function(){var e,n,r,i,o;return Wt(this,(function(s){switch(s.label){case 0:e=vs(t),n=Lf(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return mf(t)&&t.kr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,wh(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=Lf(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,_f(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Af(e)&&kf(e),[2]}}))}))}function Af(t){return mf(t)&&!Lf(t).tr()&&t.kr.length>0}function kf(t){Lf(t).start()}function Nf(t){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(e){return Lf(t).Ar(),[2]}))}))}function Df(t){return Qt(this,void 0,void 0,(function(){var e,n,r,i;return Wt(this,(function(o){for(e=Lf(t),n=0,r=t.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function Cf(t,e,n){return Qt(this,void 0,void 0,(function(){var r,i;return Wt(this,(function(o){switch(o.label){case 0:return r=t.kr.shift(),i=ll.from(r,e,n),[4,Tf(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,Sf(t)];case 2:return o.sent(),[2]}}))}))}function xf(t,e){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(n){switch(n.label){case 0:return e&&Lf(t).pr?[4,function(t,e){return Qt(this,void 0,void 0,(function(){var n,r;return Wt(this,(function(i){switch(i.label){case 0:return Tu(r=e.code)&&r!==os.ABORTED?(n=t.kr.shift(),Lf(t).sr(),[4,Tf(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Sf(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Af(t)&&kf(t),[2]}}))}))}function Rf(t,e){return Qt(this,void 0,void 0,(function(){var n;return Wt(this,(function(r){switch(r.label){case 0:return n=vs(t),e?(n.Or.delete(2),[4,lf(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,hf(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Of(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=vs(t);return r.br(),new of(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:wf.bind(null,t),Ri:Ef.bind(null,t),_r:If.bind(null,t)}),t.Mr.push((function(n){return Qt(e,void 0,void 0,(function(){return Wt(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),yf(t)?gf(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),bf(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function Lf(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=vs(t);return r.br(),new sf(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Nf.bind(null,t),Ri:xf.bind(null,t),Ir:Df.bind(null,t),Tr:Cf.bind(null,t)}),t.Mr.push((function(n){return Qt(e,void 0,void 0,(function(){return Wt(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,Sf(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.kr.length>0&&(cs("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Pf=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Yc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ss(os.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Mf(t,e){if(ls("AsyncQueue",e+": "+t),nl(t))return new ss(os.UNAVAILABLE,e+": "+t);throw t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ff=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Bs.comparator(e.key,n.key)}:function(t,e){return Bs.comparator(t.key,e.key)},this.keyedMap=Lu(),this.sortedSet=new Au(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Vf=function(){function t(){this.Qr=new Au(Bs.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):ds():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),Uf=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Ff.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Fa(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),qf=function(){this.Wr=void 0,this.listeners=[]},jf=function(){this.queries=new Xl((function(t){return Va(t)}),Fa),this.onlineState="Unknown",this.Gr=new Set};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Bf(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return Wt(this,(function(c){switch(c.label){case 0:if(n=vs(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new qf),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=Mf(a,"Initialization of query '"+Ua(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Gf(n),[2]}}))}))}function $f(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i,o,s;return Wt(this,(function(a){return n=vs(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function zf(t,e){for(var n=vs(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,l=u.listeners;c<l.length;c++)l[c].Hr(s)&&(r=!0);u.Wr=s}}r&&Gf(n)}function Kf(t,e,n){var r=vs(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Gf(t){t.Gr.forEach((function(t){t.next()}))}var Hf=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Uf(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Uf.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Qf=function(t){this.key=t},Wf=function(t){this.key=t},Yf=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Fu(),this.mutatedKeys=Fu(),this.lo=ja(t),this.fo=new Ff(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new Vf,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=Da(this.query)&&i.size===this.query.limit?i.last():null,c=Ca(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var l=i.get(t),h=qa(n.query,e)?e:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),p=!0):n.yo(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.lo(h,u)>0||c&&n.lo(h,c)<0)&&(a=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(a=!0)),p&&(h?(s=s.add(h),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Da(this.query)||Ca(this.query))for(;s.size>this.query.limit;){var l=Da(this.query)?s.last():s.first();s=s.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ds()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new Uf(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Vf,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Fu(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new Wf(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new Qf(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Fu();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Uf.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Xf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Jf=function(t){this.key=t,this.bo=!1},Zf=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Xl((function(t){return Va(t)}),Fa),this.Vo=new Map,this.So=new Set,this.Do=new Au(Bs.comparator),this.Co=new Map,this.No=new Nh,this.xo={},this.Fo=new Map,this.ko=Ul.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function td(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Wt(this,(function(u){switch(u.label){case 0:return n=Dd(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,Eh(n.localStore,Pa(e))];case 2:return s=u.sent(),a=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,ed(n,e,r,"current"===a)];case 3:i=u.sent(),n.isPrimaryClient&&ff(n.remoteStore,s),u.label=4;case 4:return[2,i]}}))}))}function ed(t,e,n,r){return Qt(this,void 0,void 0,(function(){var i,o,s,a,u,c;return Wt(this,(function(l){switch(l.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Qt(this,void 0,void 0,(function(){var i,o,s;return Wt(this,(function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,_h(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(pd(t,e.targetId,s.To),s.snapshot)]}}))}))}(t,e,n,r)},[4,_h(t.localStore,e,!0)];case 1:return i=l.sent(),o=new Yf(e,i.Bn),s=o._o(i.documents),a=ju.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),pd(t,n,u.To),c=new Xf(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function nd(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i;return Wt(this,(function(o){switch(o.label){case 0:return n=vs(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!Fa(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,Ih(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),df(n.remoteStore,r.targetId),fd(n,r.targetId)})).catch(zl)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return fd(n,r.targetId),[4,Ih(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function rd(t,e,n){return Qt(this,void 0,void 0,(function(){var r,i,o,s;return Wt(this,(function(a){switch(a.label){case 0:r=Cd(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=vs(t),i=Es.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Fu());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],l=hu(c,n.get(c.key));null!=l&&s.push(new vu(c.key,l,ia(l.value.mapValue),su.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new Au(ms)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,yd(r,i.changes)];case 3:return a.sent(),[4,Sf(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=Mf(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function id(t,e){return Qt(this,void 0,void 0,(function(){var n,r;return Wt(this,(function(i){switch(i.label){case 0:n=vs(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,bh(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(ps(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?ps(r.bo):t.removedDocuments.size>0&&(ps(r.bo),r.bo=!1))})),[4,yd(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,zl(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function od(t,e,n){var r=vs(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=vs(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&Gf(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function sd(t,e,n){return Qt(this,void 0,void 0,(function(){var r,i,o,s,a,u;return Wt(this,(function(c){switch(c.label){case 0:return(r=vs(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new Au(Bs.comparator)).insert(o,oa.newNoDocument(o,Is.min())),a=Fu().add(o),u=new qu(Is.min(),new Map,new Du(ms),s,a),[4,id(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),gd(r),[3,4];case 2:return[4,Ih(r.localStore,e,!1).then((function(){return fd(r,e,n)})).catch(zl)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function ad(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i;return Wt(this,(function(o){switch(o.label){case 0:n=vs(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,yh(n.localStore,e)];case 2:return i=o.sent(),hd(n,r,null),ld(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,yd(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,zl(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function ud(t,e,n){return Qt(this,void 0,void 0,(function(){var r,i;return Wt(this,(function(o){switch(o.label){case 0:r=vs(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=vs(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return ps(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),hd(r,e,n),ld(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,yd(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,zl(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function cd(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i,o,s;return Wt(this,(function(a){switch(a.label){case 0:mf((n=vs(t)).remoteStore)||cs("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=vs(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=Mf(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function ld(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function hd(t,e,n){var r=vs(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function fd(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||dd(t,e)}))}function dd(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(df(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),gd(t))}function pd(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Qf?(t.No.addReference(o.key,e),vd(t,o)):o instanceof Wf?(cs("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||dd(t,o.key)):ds()}}function vd(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(cs("SyncEngine","New document in limbo: "+n),t.So.add(r),gd(t))}function gd(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Bs(ks.fromString(e)),r=t.ko.next();t.Co.set(r,new Jf(n)),t.Do=t.Do.insert(n,r),ff(t.remoteStore,new hl(Pa(Na(n.path)),r,2,is.o))}}function yd(t,e,n){return Qt(this,void 0,void 0,(function(){var r,i,o,s;return Wt(this,(function(a){switch(a.label){case 0:return r=vs(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,a){s.push(r.Oo(a,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=fh.Pn(a.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l;return Wt(this,(function(h){switch(h.label){case 0:n=vs(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Xc.forEach(e,(function(e){return Xc.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return Xc.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return h.sent(),[3,4];case 3:if(!nl(r=h.sent()))throw r;return cs("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],a=s.targetId,s.fromCache||(u=n.Fn.get(a),c=u.snapshotVersion,l=u.withLastLimboFreeSnapshotVersion(c),n.Fn=n.Fn.insert(a,l));return[2]}}))}))}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function md(t,e){return Qt(this,void 0,void 0,(function(){var n,r;return Wt(this,(function(i){switch(i.label){case 0:return(n=vs(t)).currentUser.isEqual(e)?[3,3]:(cs("SyncEngine","User change. New user:",e.toKey()),[4,gh(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach((function(t){t.forEach((function(t){t.reject(new ss(os.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,yd(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function bd(t,e){var n=vs(t),r=n.Co.get(e);if(r&&r.bo)return Fu().add(r.key);var i=Fu(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function wd(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i;return Wt(this,(function(o){switch(o.label){case 0:return[4,_h((n=vs(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&pd(n,e.targetId,i.To),i)]}}))}))}function Ed(t){return Qt(this,void 0,void 0,(function(){var e;return Wt(this,(function(n){return[2,Sh((e=vs(t)).localStore).then((function(t){return yd(e,t)}))]}))}))}function Id(t,e,n,r){return Qt(this,void 0,void 0,(function(){var i,o;return Wt(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=vs(t),r=vs(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):Xc.resolve(null)}))}))}((i=vs(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,Sf(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(hd(i,e,r||null),ld(i,e),function(t,e){vs(vs(t)._n).Gt(e)}(i.localStore,e)):ds(),s.label=4;case 4:return[4,yd(i,o)];case 5:return s.sent(),[3,7];case 6:cs("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function _d(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c;return Wt(this,(function(l){switch(l.label){case 0:return Dd(n=vs(t)),Cd(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Td(n,r.toArray())]);case 1:return i=l.sent(),n.$o=!0,[4,Rf(n.remoteStore,!0)];case 2:for(l.sent(),o=0,s=i;o<s.length;o++)a=s[o],ff(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return fd(n,e),Ih(n.localStore,e,!0)})),df(n.remoteStore,e)})),[4,c]);case 4:return l.sent(),[4,Td(n,u)];case 5:return l.sent(),function(t){var e=vs(t);e.Co.forEach((function(t,n){df(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new Au(Bs.comparator)}(n),n.$o=!1,[4,Rf(n.remoteStore,!1)];case 6:l.sent(),l.label=7;case 7:return[2]}}))}))}function Td(t,e,n){return Qt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l,h,f,d,p,v;return Wt(this,(function(g){switch(g.label){case 0:n=vs(t),r=[],i=[],o=0,s=e,g.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.Vo.get(a))&&0!==c.length?[4,Eh(n.localStore,Pa(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),l=0,h=c,g.label=3;case 3:return l<h.length?(f=h[l],d=n.Po.get(f),[4,wd(n,d)]):[3,6];case 4:(p=g.sent()).snapshot&&i.push(p.snapshot),g.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,Th(n.localStore,a)];case 8:return v=g.sent(),[4,Eh(n.localStore,v)];case 9:return u=g.sent(),[4,ed(n,Sd(v),a,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function Sd(t){return ka(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Ad(t){var e=vs(t);return vs(vs(e.localStore).persistence).fn()}function kd(t,e,n,r){return Qt(this,void 0,void 0,(function(){var i,o,s;return Wt(this,(function(a){switch(a.label){case 0:return(i=vs(t)).$o?(cs("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Sh(i.localStore)];case 3:return o=a.sent(),s=qu.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,yd(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,Ih(i.localStore,e,!0)];case 6:return a.sent(),fd(i,e,r),[3,8];case 7:ds(),a.label=8;case 8:return[2]}}))}))}function Nd(t,e,n){return Qt(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h,f;return Wt(this,(function(d){switch(d.label){case 0:if(!(r=Dd(t)).$o)return[3,10];i=0,o=e,d.label=1;case 1:return i<o.length?(s=o[i],r.Vo.has(s)?(cs("SyncEngine","Adding an already active target "+s),[3,5]):[4,Th(r.localStore,s)]):[3,6];case 2:return a=d.sent(),[4,Eh(r.localStore,a)];case 3:return u=d.sent(),[4,ed(r,Sd(a),u.targetId,!1)];case 4:d.sent(),ff(r.remoteStore,u),d.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Wt(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,Ih(r.localStore,t,!1).then((function(){df(r.remoteStore,t),fd(r,t)})).catch(zl)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,h=n,d.label=7;case 7:return l<h.length?(f=h[l],[5,c(f)]):[3,10];case 8:d.sent(),d.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function Dd(t){var e=vs(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=id.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=bd.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sd.bind(null,e),e.vo._r=zf.bind(null,e.eventManager),e.vo.Mo=Kf.bind(null,e.eventManager),e}function Cd(t){var e=vs(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ad.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ud.bind(null,e),e}var xd=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(e){switch(e.label){case 0:return this.R=ef(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return vh(this.persistence,new dh,t.initialUser,this.R)},t.prototype.qo=function(t){return new Lh(Mh.bs,this.R)},t.prototype.Bo=function(t){return new Hh},t.prototype.terminate=function(){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),Rd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Gt(e,t),e.prototype.initialize=function(e){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Ah(this.localStore)];case 2:return n.sent(),[4,this.Qo.initialize(this,e)];case 3:return n.sent(),[4,Cd(this.Qo.syncEngine)];case 4:return n.sent(),[4,Sf(this.Qo.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Ko=function(t){return vh(this.persistence,new dh,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new Hl(e,t.asyncQueue)},e.prototype.qo=function(t){var e=lh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?xl.withCacheSize(this.cacheSizeBytes):xl.DEFAULT;return new ah(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Zh(),tf(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Hh},e}(xd),Od=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Gt(e,t),e.prototype.initialize=function(e){return Qt(this,void 0,void 0,(function(){var n,r=this;return Wt(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof Gh?(this.sharedClientState.syncEngine={ui:Id.bind(null,n),ai:kd.bind(null,n),hi:Nd.bind(null,n),fn:Ad.bind(null,n),ci:Ed.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return Qt(r,void 0,void 0,(function(){return Wt(this,(function(e){switch(e.label){case 0:return[4,_d(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=Zh();if(!Gh.yt(e))throw new ss(os.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=lh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Gh(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(Rd),Ld=function(){function t(){}return t.prototype.initialize=function(t,e){return Qt(this,void 0,void 0,(function(){var n=this;return Wt(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return od(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=md.bind(null,this.syncEngine),[4,Rf(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new jf},t.prototype.createDatastore=function(t){var e,n=ef(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new Jh(e));return function(t,e,n){return new af(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return od(s.syncEngine,t,0)},o=Wh.yt()?new Wh:new Qh,new cf(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Zf(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Qt(this,void 0,void 0,(function(){var e;return Wt(this,(function(n){switch(n.label){case 0:return e=vs(t),cs("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,hf(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}(),Pd=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),Md=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Qt(this,void 0,void 0,(function(){var e,n=this;return Wt(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new ss(os.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Wt(this,(function(u){switch(u.label){case 0:return n=vs(t),r=uc(n.R)+"/documents",i={documents:e.map((function(t){return ic(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){ps(!!e.found),e.found.name,e.found.updateTime;var n=oc(t,e.found.name),r=ec(e.found.updateTime),i=new ra({mapValue:{fields:e.found.fields}});return oa.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){ps(!!e.missing),ps(!!e.readTime);var n=oc(t,e.missing),r=ec(e.readTime);return oa.newNoDocument(n,r)}(t,e):ds()}(n.R,t);s.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=s.get(t.toString());ps(!!e),a.push(e)})),a)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new Eu(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Qt(this,void 0,void 0,(function(){var t,e=this;return Wt(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Bs.fromPath(n);e.mutations.push(new Iu(r,e.precondition(r)))})),[4,function(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i;return Wt(this,(function(o){switch(o.label){case 0:return n=vs(t),r=uc(n.R)+"/documents",i={writes:e.map((function(t){return hc(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw ds();e=Is.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new ss(os.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?su.updateTime(e):su.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Is.min()))throw new ss(os.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return su.updateTime(e)}return su.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),Fd=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new nf(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return Qt(t,void 0,void 0,(function(){var t,e,n=this;return Wt(this,(function(r){return t=new Md(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Us(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Tu(e)}return!1},t}(),Vd=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Fh.UNAUTHENTICATED,this.clientId=ys.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return Qt(r,void 0,void 0,(function(){return Wt(this,(function(e){switch(e.label){case 0:return cs("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new ss(os.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Yc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return Qt(t,void 0,void 0,(function(){var t,n;return Wt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Mf(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Ud(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i=this;return Wt(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),cs("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return Qt(i,void 0,void 0,(function(){return Wt(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,gh(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function qd(t,e){return Qt(this,void 0,void 0,(function(){var n,r;return Wt(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,jd(t)];case 1:return n=i.sent(),cs("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return Qt(this,void 0,void 0,(function(){var n,r;return Wt(this,(function(i){switch(i.label){case 0:return(n=vs(t)).asyncQueue.verifyOperationInProgress(),cs("RemoteStore","RemoteStore received new credentials"),r=mf(n),n.Or.add(3),[4,hf(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,lf(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function jd(t){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(cs("FirestoreClient","Using default OfflineComponentProvider"),[4,Ud(t,new xd)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function Bd(t){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(cs("FirestoreClient","Using default OnlineComponentProvider"),[4,qd(t,new Ld)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function $d(t){return jd(t).then((function(t){return t.persistence}))}function zd(t){return jd(t).then((function(t){return t.localStore}))}function Kd(t){return Bd(t).then((function(t){return t.remoteStore}))}function Gd(t){return Bd(t).then((function(t){return t.syncEngine}))}function Hd(t){return Qt(this,void 0,void 0,(function(){var e,n;return Wt(this,(function(r){switch(r.label){case 0:return[4,Bd(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=td.bind(null,e.syncEngine),n.onUnlisten=nd.bind(null,e.syncEngine),n)]}}))}))}function Qd(t,e,n){var r=this;void 0===n&&(n={});var i=new Yc;return t.asyncQueue.enqueueAndForget((function(){return Qt(r,void 0,void 0,(function(){var r;return Wt(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Pd({next:function(o){e.enqueueAndForget((function(){return $f(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new ss(os.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new ss(os.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Hf(Na(n.path),o,{includeMetadataChanges:!0,so:!0});return Bf(t,s)},[4,Hd(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function Wd(t,e,n){var r=this;void 0===n&&(n={});var i=new Yc;return t.asyncQueue.enqueueAndForget((function(){return Qt(r,void 0,void 0,(function(){var r;return Wt(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Pd({next:function(n){e.enqueueAndForget((function(){return $f(t,s)})),n.fromCache&&"server"===r.source?i.reject(new ss(os.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Hf(n,o,{includeMetadataChanges:!0,so:!0});return Bf(t,s)},[4,Hd(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var Yd=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},Xd=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Jd=new Map,Zd=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},tp=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(Fh.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),ep=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),np=function(){function t(t){var e=this;this.currentUser=Fh.UNAUTHENTICATED,this.oc=new Yc,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){cs("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(cs("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(cs("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(ps("string"==typeof n.accessToken),new Zd(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return Qt(n,void 0,void 0,(function(){return Wt(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return ps(null===t||"string"==typeof t),new Fh(t)},t}(),rp=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=Fh.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),ip=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new rp(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(Fh.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function op(t,e,n){if(!n)throw new ss(os.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function sp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new ss(os.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function ap(t,e,n,r){if(!0===e&&!0===r)throw new ss(os.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function up(t){if(!Bs.isDocumentKey(t))throw new ss(os.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function cp(t){if(Bs.isDocumentKey(t))throw new ss(os.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function lp(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":ds()}function hp(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ss(os.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=lp(t);throw new ss(os.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function fp(t,e){if(e<=0)throw new ss(os.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var dp=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new ss(os.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new ss(os.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,ap("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),pp=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new dp({}),this._settingsFrozen=!1,t instanceof Xd?(this._databaseId=t,this._credentials=new tp):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new ss(os.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xd(t.options.projectId)}(t),this._credentials=new np(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new ss(os.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new ss(os.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new dp(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new tp;switch(t.type){case"gapi":var e=t.client;return ps(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ip(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new ss(os.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=Jd.get(this))&&(cs("ComponentProvider","Removing Datastore"),Jd.delete(this),t.terminate()),Promise.resolve();var t},t}(),vp=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new yp(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),gp=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),yp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Na(r))||this)._path=r,i.type="collection",i}return Gt(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new vp(this.firestore,null,new Bs(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(gp);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function mp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=fe(t),op("collection","path",e),t instanceof pp)return cp(n=ks.fromString.apply(ks,Jt([e],r))),new yp(t,null,n);if(!(t instanceof vp||t instanceof yp))throw new ss(os.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return cp(n=ks.fromString.apply(ks,Jt([t.path],r)).child(ks.fromString(e))),new yp(t.firestore,null,n)}function bp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=fe(t),1===arguments.length&&(e=ys.u()),op("doc","path",e),t instanceof pp)return up(n=ks.fromString.apply(ks,Jt([e],r))),new vp(t,null,new Bs(n));if(!(t instanceof vp||t instanceof yp))throw new ss(os.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return up(n=t._path.child(ks.fromString.apply(ks,Jt([e],r)))),new vp(t.firestore,t instanceof yp?t.converter:null,new Bs(n))}function wp(t,e){return t=fe(t),e=fe(e),(t instanceof vp||t instanceof yp)&&(e instanceof vp||e instanceof yp)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Ep(t,e){return t=fe(t),e=fe(e),t instanceof gp&&e instanceof gp&&t.firestore===e.firestore&&Fa(t._query,e._query)&&t.converter===e.converter
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Ip=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new nf(this,"async_queue_retry"),this.Ic=function(){var e=tf();e&&cs("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=tf();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},t.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var e=tf();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ic)}},t.prototype.enqueue=function(t){var e=this;if(this.Ac(),this._c)return new Promise((function(){}));var n=new Yc;return this.Rc((function(){return e._c&&e.Ec?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.bc()}))},t.prototype.bc=function(){return Qt(this,void 0,void 0,(function(){var t,e=this;return Wt(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!nl(t=n.sent()))throw t;return cs("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.bc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Rc=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,ls("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ac(),this.Tc.indexOf(t)>-1&&(e=0);var i=Pf.createAndSchedule(this,t,e,n,(function(t){return r.vc(t)}));return this.mc.push(i),i},t.prototype.Ac=function(){this.yc&&ds()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Pc=function(){return Qt(this,void 0,void 0,(function(){var t;return Wt(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Vc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Sc=function(t){var e=this;return this.Pc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Pc()}))},t.prototype.Dc=function(t){this.Tc.push(t)},t.prototype.vc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function _p(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Tp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new Ip,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return Gt(e,t),e.prototype._terminate=function(){return this._firestoreClient||Ap(this),this._firestoreClient.terminate()},e}(pp);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Sp(t){return t._firestoreClient||Ap(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Ap(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Yd(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Vd(t._credentials,t._queue,r)}function kp(t,e,n){var r=this,i=new Yc;return t.asyncQueue.enqueue((function(){return Qt(r,void 0,void 0,(function(){var r;return Wt(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Ud(t,n)];case 1:return o.sent(),[4,qd(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===os.FAILED_PRECONDITION||t.code===os.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function Np(t){if(t._initialized||t._terminated)throw new ss(os.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Dp=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new ss(os.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ds(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),Cp=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(xs.fromBase64String(e))}catch(e){throw new ss(os.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(xs.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),xp=function(t){this._methodName=t},Rp=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new ss(os.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new ss(os.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return ms(this._lat,t._lat)||ms(this._long,t._long)},t}(),Op=/^__.*__$/,Lp=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new vu(t,this.data,this.fieldMask,e,this.fieldTransforms):new pu(t,this.data,e,this.fieldTransforms)},t}(),Pp=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new vu(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Mp(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ds()}}var Fp=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),t.prototype.xc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.Fc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,kc:!1});return r.$c(t),r},t.prototype.Oc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,kc:!1});return r.Cc(),r},t.prototype.Mc=function(t){return this.xc({path:void 0,kc:!0})},t.prototype.Lc=function(t){return rv(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Lc("Document fields must not be empty");if(Mp(this.Nc)&&Op.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},t}(),Vp=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||ef(t)}return t.prototype.Uc=function(t,e,n,r){return void 0===r&&(r=!1),new Fp({Nc:t,methodName:e,qc:n,path:Ds.emptyPath(),kc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function Up(t){var e=t._freezeSettings(),n=ef(t._databaseId);return new Vp(t._databaseId,!!e.ignoreUndefinedProperties,n)}function qp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Uc(o.merge||o.mergeFields?2:0,e,n,i);Zp("Data must be an object, but it was:",s,r);var a,u,c=Xp(r,s);if(o.merge)a=new Cs(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var d=tv(e,f[h],n);if(!s.contains(d))throw new ss(os.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");iv(l,d)||l.push(d)}a=new Cs(l),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new Lp(new ra(c),a,u)}var jp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Gt(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Nc)throw 1===t.Nc?t.Lc(this._methodName+"() can only appear at the top level of your update data"):t.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(xp);function Bp(t,e,n){return new Fp({Nc:3,qc:e.settings.qc,methodName:t._methodName,kc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var $p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Gt(e,t),e.prototype._toFieldTransform=function(t){return new iu(t.path,new Ya)},e.prototype.isEqual=function(t){return t instanceof e},e}(xp),zp=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Gt(e,t),e.prototype._toFieldTransform=function(t){var e=Bp(this,t,!0),n=this.Kc.map((function(t){return Yp(t,e)})),r=new Xa(n);return new iu(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(xp),Kp=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Gt(e,t),e.prototype._toFieldTransform=function(t){var e=Bp(this,t,!0),n=this.Kc.map((function(t){return Yp(t,e)})),r=new Za(n);return new iu(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(xp),Gp=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return Gt(e,t),e.prototype._toFieldTransform=function(t){var e=new eu(t.R,Ka(t.R,this.Qc));return new iu(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(xp);function Hp(t,e,n,r){var i=t.Uc(1,e,n);Zp("Data must be an object, but it was:",i,r);var o=[],s=ra.empty();Ts(r,(function(t,r){var a=nv(e,t,n);r=fe(r);var u=i.Oc(a);if(r instanceof jp)o.push(a);else{var c=Yp(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new Cs(o);return new Pp(s,a,i.fieldTransforms)}function Qp(t,e,n,r,i,o){var s=t.Uc(1,e,n),a=[tv(e,r,n)],u=[i];if(o.length%2!=0)throw new ss(os.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(tv(e,o[c])),u.push(o[c+1]);for(var l=[],h=ra.empty(),f=a.length-1;f>=0;--f)if(!iv(l,a[f])){var d=a[f],p=u[f];p=fe(p);var v=s.Oc(d);if(p instanceof jp)l.push(d);else{var g=Yp(p,v);null!=g&&(l.push(d),h.set(d,g))}}var y=new Cs(l);return new Pp(h,y,s.fieldTransforms)}function Wp(t,e,n,r){return void 0===r&&(r=!1),Yp(n,t.Uc(r?4:3,e))}function Yp(t,e){if(Jp(t=fe(t)))return Zp("Unsupported field value:",e,t),Xp(t,e);if(t instanceof xp)return function(t,e){if(!Mp(e.Nc))throw e.Lc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Lc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.kc&&4!==e.Nc)throw e.Lc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Yp(o[i],e.Mc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=fe(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ka(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Es.fromDate(t);return{timestampValue:Ju(e.R,n)}}if(t instanceof Es)return n=new Es(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Ju(e.R,n)};if(t instanceof Rp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Cp)return{bytesValue:Zu(e.R,t._byteString)};if(t instanceof vp){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:nc(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Lc("Unsupported field value: "+lp(t))}(t,e)}function Xp(t,e){var n={};return Ss(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ts(t,(function(t,r){var i=Yp(r,e.Fc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Jp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Es||t instanceof Rp||t instanceof Cp||t instanceof vp||t instanceof xp)}function Zp(t,e,n){if(!Jp(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=lp(n);throw"an object"===r?e.Lc(t+" a custom object"):e.Lc(t+" "+r)}}function tv(t,e,n){if((e=fe(e))instanceof Dp)return e._internalPath;if("string"==typeof e)return nv(t,e);throw rv("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var ev=new RegExp("[~\\*/\\[\\]]");function nv(t,e,n){if(e.search(ev)>=0)throw rv("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Dp.bind.apply(Dp,Jt([void 0],e.split(".")))))._internalPath}catch(r){throw rv("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function rv(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new ss(os.INVALID_ARGUMENT,(a+=". ")+t+u)}function iv(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ov=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new vp(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new sv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(av("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),sv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Gt(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(ov);function av(t,e){return"string"==typeof e?nv(t,e):e instanceof Dp?e._internalPath:e._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var uv=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),cv=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return Gt(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new lv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(av("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(ov),lv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Gt(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(cv),hv=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new uv(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new lv(n._firestore,n._userDataWriter,r.key,r,new uv(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new ss(os.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new lv(t._firestore,t._userDataWriter,e.doc.key,e.doc,new uv(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new lv(t._firestore,t._userDataWriter,e.doc.key,e.doc,new uv(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:fv(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function fv(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ds()}}function dv(t,e){return t instanceof cv&&e instanceof cv?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof hv&&e instanceof hv&&t._firestore===e._firestore&&Ep(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function pv(t){if(Ca(t)&&0===t.explicitOrderBy.length)throw new ss(os.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var vv=function(){};function gv(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var yv=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).jc=e,i.Wc=n,i.Gc=r,i.type="where",i}return Gt(e,t),e.prototype._apply=function(t){var e=Up(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new ss(os.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Tv(s,o);for(var u=[],c=0,l=s;c<l.length;c++){var h=l[c];u.push(_v(r,t,h))}a={arrayValue:{values:u}}}else a=_v(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Tv(s,o),a=Wp(n,"where",s,"in"===o||"not-in"===o);var f=ha.create(i,o,a);return function(t,e){if(e.g()){var n=Ra(t);if(null!==n&&!n.isEqual(e.field))throw new ss(os.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=xa(t);null!==r&&Sv(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new ss(os.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new ss(os.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.jc,this.Wc,this.Gc);return new gp(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new Aa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(vv),mv=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jc=e,r.zc=n,r.type="orderBy",r}return Gt(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new ss(os.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new ss(os.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ia(e,n);return function(t,e){if(null===xa(t)){var n=Ra(t);null!==n&&Sv(t,n,e.field)}}(t,r),r}(t._query,this.jc,this.zc);return new gp(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Aa(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(vv),bv=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return Gt(e,t),e.prototype._apply=function(t){return new gp(t.firestore,t.converter,Ma(t._query,this.Hc,this.Jc))},e}(vv),wv=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return Gt(e,t),e.prototype._apply=function(t){var e=Iv(t,this.type,this.Yc,this.Xc);return new gp(t.firestore,t.converter,function(t,e){return new Aa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(vv),Ev=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return Gt(e,t),e.prototype._apply=function(t){var e=Iv(t,this.type,this.Yc,this.Xc);return new gp(t.firestore,t.converter,function(t,e){return new Aa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(vv);function Iv(t,e,n,r){if(n[0]=fe(n[0]),n[0]instanceof ov)return function(t,e,n,r,i){if(!r)throw new ss(os.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=La(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Ys(e,r.key));else{var c=r.data.field(u.field);if(Ms(c))throw new ss(os.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new ss(os.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new wa(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Up(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new ss(os.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new ss(os.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Oa(t)&&-1!==c.indexOf("/"))throw new ss(os.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=t.path.child(ks.fromString(c));if(!Bs.isDocumentKey(l))throw new ss(os.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new Bs(l);a.push(Ys(e,h))}else{var f=Wp(n,r,c);a.push(f)}}return new wa(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function _v(t,e,n){if("string"==typeof(n=fe(n))){if(""===n)throw new ss(os.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Oa(e)&&-1!==n.indexOf("/"))throw new ss(os.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ks.fromString(n));if(!Bs.isDocumentKey(r))throw new ss(os.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ys(t,new Bs(r))}if(n instanceof vp)return Ys(t,n._key);throw new ss(os.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+lp(n)+".")}function Tv(t,e){if(!Array.isArray(t)||0===t.length)throw new ss(os.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new ss(os.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Sv(t,e,n){if(!n.isEqual(e))throw new ss(os.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Av=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),$s(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ls(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Ps(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw ds()}},t.prototype.convertObject=function(t,e){var n=this,r={};return Ts(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new Rp(Ls(t.latitude),Ls(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Fs(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Vs(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=Os(t);return new Es(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=ks.fromString(t);ps(Ac(n));var r=new Xd(n.get(1),n.get(3)),i=new Bs(n.popFirst(5));return r.isEqual(e)||ls("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function kv(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Nv=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Gt(e,t),e.prototype.convertBytes=function(t){return new Cp(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new vp(this.firestore,null,e)},e}(Av),Dv=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Up(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=Cv(t,this._firestore),i=kv(r.converter,e,n),o=qp(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,su.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=Cv(t,this._firestore);return o="string"==typeof(e=fe(e))||e instanceof Dp?Qp(this._dataReader,"WriteBatch.update",s._key,e,n,r):Hp(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,su.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=Cv(t,this._firestore);return this._mutations=this._mutations.concat(new Eu(e._key,su.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new ss(os.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Cv(t,e){if((t=fe(t)).firestore!==e)throw new ss(os.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var xv=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Gt(e,t),e.prototype.convertBytes=function(t){return new Cp(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new vp(this.firestore,null,e)},e}(Av);function Rv(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=hp(t,vp);var o=hp(t.firestore,Tp),s=Up(o);return Lv(o,[("string"==typeof(e=fe(e))||e instanceof Dp?Qp(s,"updateDoc",t._key,e,n,r):Hp(s,"updateDoc",t._key,e)).toMutation(t._key,su.exists(!0))])}function Ov(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=fe(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||_p(i[a])||(s=i[a],a++);var u,c,l,h={includeMetadataChanges:s.includeMetadataChanges};if(_p(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof vp)c=hp(t.firestore,Tp),l=Na(t._key.path),u={next:function(e){i[a]&&i[a](Pv(c,t,e))},error:i[a+1],complete:i[a+2]};else{var d=hp(t,gp);c=hp(d.firestore,Tp),l=d._query;var p=new xv(c);u={next:function(t){i[a]&&i[a](new hv(c,p,d,t))},error:i[a+1],complete:i[a+2]},pv(t._query)}return function(t,e,n,r){var i=this,o=new Pd(r),s=new Hf(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return Qt(i,void 0,void 0,(function(){var e;return Wt(this,(function(n){switch(n.label){case 0:return e=Bf,[4,Hd(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return Qt(i,void 0,void 0,(function(){var e;return Wt(this,(function(n){switch(n.label){case 0:return e=$f,[4,Hd(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(Sp(c),l,h,u)}function Lv(t,e){return function(t,e){var n=this,r=new Yc;return t.asyncQueue.enqueueAndForget((function(){return Qt(n,void 0,void 0,(function(){var n;return Wt(this,(function(i){switch(i.label){case 0:return n=rd,[4,Gd(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(Sp(t),e)}function Pv(t,e,n){var r=n.docs.get(e._key),i=new xv(t);return new cv(t,i,e._key,r,new uv(n.hasPendingWrites,n.fromCache),e.converter)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Mv=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return Gt(e,t),e.prototype.get=function(e){var n=this,r=Cv(e,this._firestore),i=new xv(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new cv(n._firestore,i,r._key,t._document,new uv(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Up(t)}return t.prototype.get=function(t){var e=this,n=Cv(t,this._firestore),r=new Nv(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return ds();var i=t[0];if(i.isFoundDocument())return new ov(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new ov(e._firestore,r,n._key,null,n.converter);throw ds()}))},t.prototype.set=function(t,e,n){var r=Cv(t,this._firestore),i=kv(r.converter,e,n),o=qp(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Cv(t,this._firestore);return o="string"==typeof(e=fe(e))||e instanceof Dp?Qp(this._dataReader,"Transaction.update",s._key,e,n,r):Hp(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=Cv(t,this._firestore);return this._transaction.delete(e._key),this},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fv(){if("undefined"==typeof Uint8Array)throw new ss(os.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Vv(){if("undefined"==typeof atob)throw new ss(os.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Uv=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Vv(),new t(Cp.fromBase64String(e))},t.fromUint8Array=function(e){return Fv(),new t(Cp.fromUint8Array(e))},t.prototype.toBase64=function(){return Vv(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Fv(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),qv=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Np(t=hp(t,Tp));var n=Sp(t),r=t._freezeSettings(),i=new Ld;return kp(n,i,new Rd(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Np(t=hp(t,Tp));var e=Sp(t),n=t._freezeSettings(),r=new Ld;return kp(e,r,new Od(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new ss(os.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Yc;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return Qt(e,void 0,void 0,(function(){var e;return Wt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Qt(this,void 0,void 0,(function(){var e;return Wt(this,(function(n){switch(n.label){case 0:return Zc.yt()?(e=t+"main",[4,Zc.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(lh(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),jv=function(){function t(t,e,n){var r=this;this._delegate=e,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Xd||(this.tu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||hs("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=hp(t,pp))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&hs("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=Ht({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Zt.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),Zt.encodeString(JSON.stringify(o),!1),""].join(".")}(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new ss(os.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new ep(new Zd(o,new Fh(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Qt(e,void 0,void 0,(function(){var e,n;return Wt(this,(function(r){switch(r.label){case 0:return[4,$d(t)];case 1:return e=r.sent(),[4,Kd(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=vs(t);return e.Or.delete(0),lf(e)}(n))]}}))}))}))}(Sp(hp(this._delegate,Tp)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Qt(e,void 0,void 0,(function(){var e,n;return Wt(this,(function(r){switch(r.label){case 0:return[4,$d(t)];case 1:return e=r.sent(),[4,Kd(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Qt(this,void 0,void 0,(function(){var e;return Wt(this,(function(n){switch(n.label){case 0:return(e=vs(t)).Or.add(0),[4,hf(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Sp(hp(this._delegate,Tp)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&ap("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Yc;return t.asyncQueue.enqueueAndForget((function(){return Qt(e,void 0,void 0,(function(){var e;return Wt(this,(function(r){switch(r.label){case 0:return e=cd,[4,Gd(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Sp(hp(this._delegate,Tp)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Pd(e);return t.asyncQueue.enqueueAndForget((function(){return Qt(n,void 0,void 0,(function(){var e;return Wt(this,(function(n){switch(n.label){case 0:return e=function(t,e){vs(t).Gr.add(e),e.next()},[4,Hd(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return Qt(n,void 0,void 0,(function(){var e;return Wt(this,(function(n){switch(n.label){case 0:return e=function(t,e){vs(t).Gr.delete(e)},[4,Hd(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(Sp(t=hp(t,Tp)),_p(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.tu)throw new ss(os.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new eg(this,mp(this._delegate,t))}catch(t){throw Hv(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Gv(this,bp(this._delegate,t))}catch(t){throw Hv(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Jv(this,function(t,e){if(t=hp(t,pp),op("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ss(os.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new gp(t,null,function(t){return new Aa(ks.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Hv(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Yc;return t.asyncQueue.enqueueAndForget((function(){return Qt(n,void 0,void 0,(function(){var n;return Wt(this,(function(i){switch(i.label){case 0:return[4,function(t){return Bd(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new Fd(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(Sp(t),(function(n){return e(new Mv(t,n))}))}(this._delegate,(function(n){return t(new $v(e,n))}))},t.prototype.batch=function(){var t=this;return Sp(this._delegate),new zv(new Dv(this._delegate,(function(e){return Lv(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new ss(os.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new ss(os.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Bv=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Gt(e,t),e.prototype.convertBytes=function(t){return new Uv(new Cp(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Gv.eu(e,this.firestore,null)},e}(Av);var $v=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Bv(t)}return t.prototype.get=function(t){var e=this,n=ng(t);return this._delegate.get(n).then((function(t){return new Yv(e._firestore,new cv(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=ng(t);return n?(sp("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=ng(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Jt([s,e,n],i)),this},t.prototype.delete=function(t){var e=ng(t);return this._delegate.delete(e),this},t}(),zv=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=ng(t);return n?(sp("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=ng(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Jt([s,e,n],i)),this},t.prototype.delete=function(t){var e=ng(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Kv=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new lv(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Xv(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.nu=function(e,n){var r=t.su,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Bv(e),n),i.set(n,o)),o},t}();Kv.su=new WeakMap;var Gv=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Bv(t)}return t.iu=function(e,n,r){if(e.length%2!=0)throw new ss(os.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new vp(n._delegate,r,new Bs(e)))},t.eu=function(e,n,r){return new t(n,new vp(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new eg(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new eg(this.firestore,mp(this._delegate,t))}catch(t){throw Hv(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=fe(t))instanceof vp&&wp(this._delegate,t)},t.prototype.set=function(t,e){e=sp("DocumentReference.set",e);try{return function(t,e,n){t=hp(t,vp);var r=hp(t.firestore,Tp),i=kv(t.converter,e,n);return Lv(r,[qp(Up(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,su.none())])}(this._delegate,t,e)}catch(t){throw Hv(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Rv(this._delegate,t):Rv.apply(void 0,Jt([this._delegate,t,e],n))}catch(t){throw Hv(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return Lv(hp((t=this._delegate).firestore,Tp),[new Eu(t._key,su.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Qv(e),i=Wv(e,(function(e){return new Yv(t.firestore,new cv(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return Ov(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=hp(t,vp);var e=hp(t.firestore,Tp),n=Sp(e),r=new xv(e);return function(t,e){var n=this,r=new Yc;return t.asyncQueue.enqueueAndForget((function(){return Qt(n,void 0,void 0,(function(){var n;return Wt(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Qt(this,void 0,void 0,(function(){var r,i;return Wt(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=vs(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new ss(os.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Mf(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,zd(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new cv(e,r,t._key,n,new uv(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=hp(t,vp);var e=hp(t.firestore,Tp);return Qd(Sp(e),t._key,{source:"server"}).then((function(n){return Pv(e,t,n)}))}(this._delegate):function(t){t=hp(t,vp);var e=hp(t.firestore,Tp);return Qd(Sp(e),t._key).then((function(n){return Pv(e,t,n)}))}(this._delegate)).then((function(t){return new Yv(e.firestore,new cv(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Kv.nu(this.firestore,e)):this._delegate.withConverter(null))},t}();function Hv(t,e,n){return t.message=t.message.replace(e,n),t}function Qv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!_p(r))return r}return{}}function Wv(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=_p(t[0])?t[0]:_p(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Yv=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Gv(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return dv(this._delegate,t._delegate)},t}(),Xv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Gt(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Yv),Jv=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Bv(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,gv(this._delegate,function(t,e,n){var r=e,i=av("where",t);return new yv(i,r,n)}(e,n,r)))}catch(e){throw Hv(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,gv(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=av("orderBy",t);return new mv(r,n)}(e,n)))}catch(e){throw Hv(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,gv(this._delegate,function(t){return fp("limit",t),new bv("limit",t,"F")}(e)))}catch(e){throw Hv(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,gv(this._delegate,function(t){return fp("limitToLast",t),new bv("limitToLast",t,"L")}(e)))}catch(e){throw Hv(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,gv(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wv("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw Hv(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,gv(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wv("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw Hv(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,gv(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ev("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw Hv(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,gv(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ev("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw Hv(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return Ep(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=hp(t,gp);var e=hp(t.firestore,Tp),n=Sp(e),r=new xv(e);return function(t,e){var n=this,r=new Yc;return t.asyncQueue.enqueueAndForget((function(){return Qt(n,void 0,void 0,(function(){var n;return Wt(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Qt(this,void 0,void 0,(function(){var r,i,o,s,a;return Wt(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,_h(t,e,!0)];case 1:return a=u.sent(),r=new Yf(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=Mf(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,zd(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new hv(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=hp(t,gp);var e=hp(t.firestore,Tp),n=Sp(e),r=new xv(e);return Wd(n,t._query,{source:"server"}).then((function(n){return new hv(e,r,t,n)}))}(this._delegate):function(t){t=hp(t,gp);var e=hp(t.firestore,Tp),n=Sp(e),r=new xv(e);return pv(t._query),Wd(n,t._query).then((function(n){return new hv(e,r,t,n)}))}(this._delegate)).then((function(t){return new tg(e.firestore,new hv(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Qv(e),i=Wv(e,(function(e){return new tg(t.firestore,new hv(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return Ov(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Kv.nu(this.firestore,e)):this._delegate.withConverter(null))},t}(),Zv=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Xv(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),tg=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Jv(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new Xv(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new Zv(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new Xv(n._firestore,r))}))},t.prototype.isEqual=function(t){return dv(this._delegate,t._delegate)},t}(),eg=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return Gt(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Gv(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Gv(this.firestore,void 0===t?bp(this._delegate):bp(this._delegate,t))}catch(t){throw Hv(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=hp(t.firestore,Tp),r=bp(t),i=kv(t.converter,e);return Lv(n,[qp(Up(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,su.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new Gv(e.firestore,t)}))},e.prototype.isEqual=function(t){return wp(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Kv.nu(this.firestore,t)):this._delegate.withConverter(null))},e}(Jv);function ng(t){return hp(t,vp)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var rg,ig=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(Dp.bind.apply(Dp,Jt([void 0],t)))}return t.documentId=function(){return new t(Ds.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=fe(t))instanceof Dp&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),og=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new $p("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new jp("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new zp("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Kp("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Gp("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),sg={Firestore:jv,GeoPoint:Rp,Timestamp:Es,Blob:Uv,Transaction:$v,WriteBatch:zv,DocumentReference:Gv,DocumentSnapshot:Yv,Query:Jv,QueryDocumentSnapshot:Xv,QuerySnapshot:tg,CollectionReference:eg,FieldPath:ig,FieldValue:og,setLogLevel:function(t){var e;e=t,as.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new de("firestore",(function(t){return function(t,e){return new jv(t,new Tp(t,e),new qv)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},sg)))})(rg=je),rg.registerVersion("@firebase/firestore","2.3.9");
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var ag={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ug=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return Gt(e,t),e}(Error);var cg=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return Qt(this,void 0,void 0,(function(){var t;return Wt(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return Qt(this,void 0,void 0,(function(){return Wt(this,(function(t){switch(t.label){case 0:if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.messaging.getToken()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getContext=function(){return Qt(this,void 0,void 0,(function(){var t,e;return Wt(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function lg(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var hg=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return lg(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?lg(t,(function(t){return e.decode(t)})):t},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var fg=function(){function t(t,e,n,r,i,o){var s=this;void 0===i&&(i="us-central1"),this.app_=t,this.appCheckProvider=r,this.fetchImpl=o,this.serializer=new hg,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(s.deleteService())}},this.contextProvider=new cg(e,n),this.cancelAllRequests=new Promise((function(t){s.deleteService=function(){return t()}}));try{var a=new URL(i);this.customDomain=a.origin,this.region="us-central1"}catch(t){this.customDomain=null,this.region=i}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return Qt(this,void 0,void 0,(function(){var r,i,o;return Wt(this,(function(s){switch(s.label){case 0:return n["Content-Type"]="application/json",[4,this.getAppCheckToken()];case 1:null!==(r=s.sent())&&(n["X-Firebase-AppCheck"]=r),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 3:return i=s.sent(),[3,5];case 4:return s.sent(),[2,{status:0,json:null}];case 5:o=null,s.label=6;case 6:return s.trys.push([6,8,,9]),[4,i.json()];case 7:return o=s.sent(),[3,9];case 8:return s.sent(),[3,9];case 9:return[2,{status:i.status,json:o}]}}))}))},t.prototype.getAppCheckToken=function(){return Qt(this,void 0,void 0,(function(){var t;return Wt(this,(function(e){switch(e.label){case 0:return(t=this.appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype.call=function(t,e,n){return Qt(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h,f,d;return Wt(this,(function(p){switch(p.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(s=p.sent()).authToken&&(o.Authorization="Bearer "+s.authToken),s.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=s.instanceIdToken),a=n.timeout||7e4,u=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new ug("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(a),c=u.timer,l=u.promise,[4,Promise.race([dg(c,this.postJSON(r,i,o)),l,dg(c,this.cancelAllRequests)])];case 2:if(!(h=p.sent()))throw new ug("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var s=e&&e.error;if(s){var a=s.status;if("string"==typeof a){if(!ag[a])return new ug("internal","internal");r=ag[a],i=a}var u=s.message;"string"==typeof u&&(i=u),void 0!==(o=s.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new ug(r,i,o)}(h.status,h.json,this.serializer))throw f;if(!h.json)throw new ug("internal","Response is not valid JSON object.");if(void 0===(d=h.json.data)&&(d=h.json.result),void 0===d)throw new ug("internal","Response is missing data field.");return[2,{data:this.serializer.decode(d)}]}}))}))},t}();function dg(t,e){return Qt(this,void 0,void 0,(function(){var n;return Wt(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
!function(t,e){var n={Functions:fg};t.INTERNAL.registerComponent(new de("functions",(function(t,n){var r=n.instanceIdentifier,i=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal"),a=t.getProvider("messaging");return new fg(i,o,a,s,r,e)}),"PUBLIC").setServiceProps(n).setMultipleInstances(!0))}(je,fetch.bind(self)),je.registerVersion("@firebase/functions","0.6.13");je.initializeApp({apiKey:"AIzaSyAq59lK80pPZj_-DmD8swIckq2TYTt8Meo",authDomain:"anime-corner-rankings.firebaseapp.com",projectId:"anime-corner-rankings",storageBucket:"anime-corner-rankings.appspot.com",messagingSenderId:"1056575402361",appId:"1:1056575402361:web:0fd9790f5ef43a94897fa8",measurementId:"G-264NJGB06X"});const pg=je.firestore(),vg=je.functions();function gg(e){let n,r;return{c(){n=T("div"),r=A(e[0]),x(n,"class","svelte-w1ujin")},m(t,e){E(t,n,e),m(n,r)},p(t,[e]){1&e&&R(r,t[0])},i:t,o:t,d(t){t&&I(n)}}}function yg(t,e,n){let{rank:r}=e;return t.$$set=t=>{"rank"in t&&n(0,r=t.rank)},[r]}class mg extends kt{constructor(t){super(),At(this,t,yg,gg,a,{rank:0})}}function bg(e){let n,r,i;return{c(){n=T("div"),r=T("div"),i=A(e[1]),x(r,"class","title svelte-ps336j"),x(n,"class","banner svelte-ps336j"),O(n,"background-image","linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url("+e[0]+")")},m(t,e){E(t,n,e),m(n,r),m(r,i)},p(t,[e]){2&e&&R(i,t[1]),1&e&&O(n,"background-image","linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url("+t[0]+")")},i:t,o:t,d(t){t&&I(n)}}}function wg(t,e,n){let{banner:r}=e,{title:i}=e;return t.$$set=t=>{"banner"in t&&n(0,r=t.banner),"title"in t&&n(1,i=t.title)},[r,i]}class Eg extends kt{constructor(t){super(),At(this,t,wg,bg,a,{banner:0,title:1})}}function Ig(t){let e,n,r,i;return{c(){e=S("svg"),n=S("path"),r=k(),i=A(t[4]),x(n,"d","M24 22h-24l12-20z"),x(e,"class","arrow-gain svelte-63vq6l"),x(e,"xmlns","http://www.w3.org/2000/svg"),x(e,"width","16"),x(e,"height","16"),x(e,"viewBox","0 0 24 24")},m(t,o){E(t,e,o),m(e,n),E(t,r,o),E(t,i,o)},p(t,e){16&e&&R(i,t[4])},d(t){t&&I(e),t&&I(r),t&&I(i)}}}function _g(t){let e,n,r,i;return{c(){e=S("svg"),n=S("path"),r=k(),i=A(t[4]),x(n,"d","M0 9h24v6h-24z"),x(e,"class","arrow-neutral svelte-63vq6l"),x(e,"xmlns","http://www.w3.org/2000/svg"),x(e,"width","16"),x(e,"height","16"),x(e,"viewBox","0 0 24 24")},m(t,o){E(t,e,o),m(e,n),E(t,r,o),E(t,i,o)},p(t,e){16&e&&R(i,t[4])},d(t){t&&I(e),t&&I(r),t&&I(i)}}}function Tg(t){let e,n,r,i,o=t[4].toString().replace("-","")+"";return{c(){e=S("svg"),n=S("path"),r=k(),i=A(o),x(n,"d","M12 21l-12-18h24z"),x(e,"class","arrow-drop svelte-63vq6l"),x(e,"xmlns","http://www.w3.org/2000/svg"),x(e,"width","16"),x(e,"height","16"),x(e,"viewBox","0 0 24 24")},m(t,o){E(t,e,o),m(e,n),E(t,r,o),E(t,i,o)},p(t,e){16&e&&o!==(o=t[4].toString().replace("-","")+"")&&R(i,o)},d(t){t&&I(e),t&&I(r),t&&I(i)}}}function Sg(t){let e,n,r;return{c(){e=T("div"),n=A("From Rank "),r=A(t[1]),x(e,"class","label svelte-63vq6l"),M(e,"gain",t[4]>0),M(e,"drop",t[4]<0)},m(t,i){E(t,e,i),m(e,n),m(e,r)},p(t,n){2&n&&R(r,t[1]),16&n&&M(e,"gain",t[4]>0),16&n&&M(e,"drop",t[4]<0)},d(t){t&&I(e)}}}function Ag(t){let e;return{c(){e=T("div"),e.textContent="Same Rank",x(e,"class","label svelte-63vq6l"),M(e,"neutral",t[1]==t[0])},m(t,n){E(t,e,n)},p(t,n){3&n&&M(e,"neutral",t[1]==t[0])},d(t){t&&I(e)}}}function kg(t){let e;return{c(){e=T("div"),e.textContent="New Entry",x(e,"class","label svelte-63vq6l"),M(e,"neutral",null==t[1])},m(t,n){E(t,e,n)},p(t,n){2&n&&M(e,"neutral",null==t[1])},d(t){t&&I(e)}}}function Ng(t){let e;return{c(){e=T("div"),e.textContent="New Entry",x(e,"class","label border-br svelte-63vq6l"),M(e,"neutral",0==t[5]),M(e,"no-border-br",t[3])},m(t,n){E(t,e,n)},p(t,n){32&n&&M(e,"neutral",0==t[5]),8&n&&M(e,"no-border-br",t[3])},d(t){t&&I(e)}}}function Dg(t){let e,n,r;return{c(){e=T("div"),n=A(t[5]),r=A("% Drop"),x(e,"class","label border-br svelte-63vq6l"),M(e,"drop",t[5]<0),M(e,"no-border-br",t[3])},m(t,i){E(t,e,i),m(e,n),m(e,r)},p(t,r){32&r&&R(n,t[5]),32&r&&M(e,"drop",t[5]<0),8&r&&M(e,"no-border-br",t[3])},d(t){t&&I(e)}}}function Cg(t){let e,n,r,i;return{c(){e=T("div"),n=A("+"),r=A(t[5]),i=A("% Gain"),x(e,"class","label border-br svelte-63vq6l"),M(e,"gain",t[5]>0),M(e,"no-border-br",t[3])},m(t,o){E(t,e,o),m(e,n),m(e,r),m(e,i)},p(t,n){32&n&&R(r,t[5]),32&n&&M(e,"gain",t[5]>0),8&n&&M(e,"no-border-br",t[3])},d(t){t&&I(e)}}}function xg(e){let n,r,i,o,s,a,u,c,l,h;function f(t,e){return t[4]<0?Tg:0===t[4]?_g:Ig}let d=f(e),p=d(e);function v(t,e){return null==t[1]?kg:t[1]==t[0]?Ag:Sg}let g=v(e),y=g(e);function b(t,e){return t[5]>0?Cg:t[5]<0?Dg:Ng}let w=b(e),_=w(e);return{c(){n=T("div"),r=T("div"),i=T("div"),p.c(),o=k(),y.c(),s=k(),a=T("div"),u=T("div"),c=A(e[2]),l=A("%"),h=k(),_.c(),x(i,"class","figure svelte-63vq6l"),x(r,"class","sub-container svelte-63vq6l"),x(u,"class","figure border-br svelte-63vq6l"),x(a,"class","sub-container border-br svelte-63vq6l"),x(n,"class","container border-tr border-br svelte-63vq6l")},m(t,e){E(t,n,e),m(n,r),m(r,i),p.m(i,null),m(r,o),y.m(r,null),m(n,s),m(n,a),m(a,u),m(u,c),m(u,l),m(a,h),_.m(a,null)},p(t,[e]){d===(d=f(t))&&p?p.p(t,e):(p.d(1),p=d(t),p&&(p.c(),p.m(i,null))),g===(g=v(t))&&y?y.p(t,e):(y.d(1),y=g(t),y&&(y.c(),y.m(r,null))),4&e&&R(c,t[2]),w===(w=b(t))&&_?_.p(t,e):(_.d(1),_=w(t),_&&(_.c(),_.m(a,null)))},i:t,o:t,d(t){t&&I(n),p.d(),y.d(),_.d()}}}function Rg(t,e,n){let r,i,{rank:o}=e,{previousRank:s}=e,{votes:a}=e,{previousVotes:u}=e,{isActive:c}=e;return function(t){K().$$.after_update.push(t)}((()=>{n(4,r=function(t,e){return null==e?0:t<e?e-t:e==t?0:e-t}(o,s)),n(5,i=function(t,e){if(null==e)return 0;return(t-e).toFixed(2)}(a,u))})),t.$$set=t=>{"rank"in t&&n(0,o=t.rank),"previousRank"in t&&n(1,s=t.previousRank),"votes"in t&&n(2,a=t.votes),"previousVotes"in t&&n(6,u=t.previousVotes),"isActive"in t&&n(3,c=t.isActive)},[o,s,a,c,r,i,u]}class Og extends kt{constructor(t){super(),At(this,t,Rg,xg,a,{rank:0,previousRank:1,votes:2,previousVotes:6,isActive:3})}}function Lg(t){let e,n=localStorage.getItem(`${t}`);return n&&(n=JSON.parse(n),e=parseInt(Date.now()/1e3)-n.cachetime>86400),{cachedData:n,expired:e}}function Pg(t,e){const n={data:e,cachetime:parseInt(Date.now()/1e3)};localStorage.setItem(`${t}`,JSON.stringify(n))}function Mg(t,e,n){const r=t.slice();return r[13]=e[n],r}function Fg(t,e,n){const r=t.slice();return r[9]=e[n],r}function Vg(t){let e,n,r,i,o,s,a,u,c,l,h,f,d,p,v=t[9],g=[];for(let e=0;e<v.length;e+=1)g[e]=Ug(Fg(t,v,e));const y=[jg,qg],b=[];function w(t,e){return 0==t[8].length?0:1}return c=w(t),l=b[c]=y[c](t),{c(){e=T("div"),n=T("div"),r=T("h2"),i=A(t[2]),o=k(),s=T("div");for(let t=0;t<g.length;t+=1)g[t].c();a=k(),u=T("div"),l.c(),h=k(),f=new F,x(r,"class","title svelte-gd335j"),x(s,"class","pills svelte-gd335j"),x(u,"class","links svelte-gd335j"),f.a=null,x(e,"class","card-content svelte-gd335j")},m(l,d){E(l,e,d),m(e,n),m(n,r),m(r,i),m(e,o),m(e,s);for(let t=0;t<g.length;t+=1)g[t].m(s,null);m(e,a),m(e,u),b[c].m(u,null),m(e,h),f.m(t[7],e),p=!0},p(t,e){if((!p||4&e)&&R(i,t[2]),512&e){let n;for(v=t[9],n=0;n<v.length;n+=1){const r=Fg(t,v,n);g[n]?g[n].p(r,e):(g[n]=Ug(r),g[n].c(),g[n].m(s,null))}for(;n<g.length;n+=1)g[n].d(1);g.length=v.length}let n=c;c=w(t),c===n?b[c].p(t,e):(ut(),ht(b[n],1,1,(()=>{b[n]=null})),ct(),l=b[c],l?l.p(t,e):(l=b[c]=y[c](t),l.c()),lt(l,1),l.m(u,null)),(!p||128&e)&&f.p(t[7])},i(t){p||(lt(l),J((()=>{d||(d=dt(e,xt,{duration:200},!0)),d.run(1)})),p=!0)},o(t){ht(l),d||(d=dt(e,xt,{duration:200},!1)),d.run(0),p=!1},d(t){t&&I(e),_(g,t),b[c].d(),t&&d&&d.end()}}}function Ug(t){let e,n,r=t[9]+"";return{c(){e=T("div"),n=A(r),x(e,"class","pill svelte-gd335j")},m(t,r){E(t,e,r),m(e,n)},p(t,e){512&e&&r!==(r=t[9]+"")&&R(n,r)},d(t){t&&I(e)}}}function qg(t){let e,n,r,i=t[8],o=[];for(let e=0;e<i.length;e+=1)o[e]=Yg(Mg(t,i,e));const s=t=>ht(o[t],1,1,(()=>{o[t]=null}));return{c(){e=A("Watch on:\n          ");for(let t=0;t<o.length;t+=1)o[t].c();n=N()},m(t,i){E(t,e,i);for(let e=0;e<o.length;e+=1)o[e].m(t,i);E(t,n,i),r=!0},p(t,e){if(3328&e){let r;for(i=t[8],r=0;r<i.length;r+=1){const s=Mg(t,i,r);o[r]?(o[r].p(s,e),lt(o[r],1)):(o[r]=Yg(s),o[r].c(),lt(o[r],1),o[r].m(n.parentNode,n))}for(ut(),r=i.length;r<o.length;r+=1)s(r);ct()}},i(t){if(!r){for(let t=0;t<i.length;t+=1)lt(o[t]);r=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)ht(o[t]);r=!1},d(t){t&&I(e),_(o,t),t&&I(n)}}}function jg(e){let n;return{c(){n=A("Could not find on Crunchyroll or Funimation ")},m(t,e){E(t,n,e)},p:t,i:t,o:t,d(t){t&&I(n)}}}function Bg(t){let e,n,r={ctx:t,current:null,token:null,hasCatch:!1,pending:Gg,then:Kg,catch:zg,value:16,blocks:[,,,]};return pt(t[11](),r),{c(){e=N(),r.block.c()},m(t,i){E(t,e,i),r.block.m(t,r.anchor=i),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(e,n){vt(r,t=e,n)},i(t){n||(lt(r.block),n=!0)},o(t){for(let t=0;t<3;t+=1){ht(r.blocks[t])}n=!1},d(t){t&&I(e),r.block.d(t),r.token=null,r=null}}}function $g(t){let e,n,r={ctx:t,current:null,token:null,hasCatch:!1,pending:Wg,then:Qg,catch:Hg,value:16,blocks:[,,,]};return pt(t[10](),r),{c(){e=N(),r.block.c()},m(t,i){E(t,e,i),r.block.m(t,r.anchor=i),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(e,n){vt(r,t=e,n)},i(t){n||(lt(r.block),n=!0)},o(t){for(let t=0;t<3;t+=1){ht(r.blocks[t])}n=!1},d(t){t&&I(e),r.block.d(t),r.token=null,r=null}}}function zg(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function Kg(e){let n,r,i,o,s;return{c(){n=T("a"),r=T("img"),s=k(),c(r.src,i=e[16])||x(r,"src",i),x(r,"alt","Funimation Logo"),x(r,"class","funimation svelte-gd335j"),x(n,"href",o=e[13].url),x(n,"class","link svelte-gd335j"),x(n,"target","_blank")},m(t,e){E(t,n,e),m(n,r),E(t,s,e)},p(t,e){256&e&&o!==(o=t[13].url)&&x(n,"href",o)},i:t,o:t,d(t){t&&I(n),t&&I(s)}}}function Gg(e){let n,r,i;return n=new zt({props:{size:"32",unit:"px",color:"#65b893"}}),{c(){It(n.$$.fragment),r=k()},m(t,e){_t(n,t,e),E(t,r,e),i=!0},p:t,i(t){i||(lt(n.$$.fragment,t),i=!0)},o(t){ht(n.$$.fragment,t),i=!1},d(t){Tt(n,t),t&&I(r)}}}function Hg(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function Qg(e){let n,r,i,o,s;return{c(){n=T("a"),r=T("img"),s=k(),c(r.src,i=e[16])||x(r,"src",i),x(r,"alt","Crunchyroll Logo"),x(r,"class","crunchyroll svelte-gd335j"),x(n,"href",o=e[13].url),x(n,"class","link svelte-gd335j"),x(n,"target","_blank")},m(t,e){E(t,n,e),m(n,r),E(t,s,e)},p(t,e){256&e&&o!==(o=t[13].url)&&x(n,"href",o)},i:t,o:t,d(t){t&&I(n),t&&I(s)}}}function Wg(e){let n,r,i;return n=new zt({props:{size:"32",unit:"px",color:"#65b893"}}),{c(){It(n.$$.fragment),r=k()},m(t,e){_t(n,t,e),E(t,r,e),i=!0},p:t,i(t){i||(lt(n.$$.fragment,t),i=!0)},o(t){ht(n.$$.fragment,t),i=!1},d(t){Tt(n,t),t&&I(r)}}}function Yg(t){let e,n,r,i;const o=[$g,Bg],s=[];function a(t,e){return"Crunchyroll"==t[13].site?0:"Funimation"==t[13].site?1:-1}return~(e=a(t))&&(n=s[e]=o[e](t)),{c(){n&&n.c(),r=N()},m(t,n){~e&&s[e].m(t,n),E(t,r,n),i=!0},p(t,i){let u=e;e=a(t),e===u?~e&&s[e].p(t,i):(n&&(ut(),ht(s[u],1,1,(()=>{s[u]=null})),ct()),~e?(n=s[e],n?n.p(t,i):(n=s[e]=o[e](t),n.c()),lt(n,1),n.m(r.parentNode,r)):n=null)},i(t){i||(lt(n),i=!0)},o(t){ht(n),i=!1},d(t){~e&&s[e].d(t),t&&I(r)}}}function Xg(t){let e,n,r,i,s,a,u,c,l,h,f;r=new mg({props:{rank:t[1]}}),s=new Eg({props:{banner:t[4],title:t[2]}}),u=new Og({props:{rank:t[1],previousRank:t[5],votes:t[3],previousVotes:t[6],isActive:t[0]}});let d=t[0]&&Vg(t);return{c(){e=T("div"),n=T("div"),It(r.$$.fragment),i=k(),It(s.$$.fragment),a=k(),It(u.$$.fragment),c=k(),d&&d.c(),x(n,"class","card svelte-gd335j"),x(n,"tabindex","0"),x(e,"class","wrapper svelte-gd335j")},m(o,p){E(o,e,p),m(e,n),_t(r,n,null),m(n,i),_t(s,n,null),m(n,a),_t(u,n,null),m(e,c),d&&d.m(e,null),l=!0,h||(f=[D(n,"click",t[12]),D(n,"keypress",C(t[12]))],h=!0)},p(t,[n]){const i={};2&n&&(i.rank=t[1]),r.$set(i);const o={};16&n&&(o.banner=t[4]),4&n&&(o.title=t[2]),s.$set(o);const a={};2&n&&(a.rank=t[1]),32&n&&(a.previousRank=t[5]),8&n&&(a.votes=t[3]),64&n&&(a.previousVotes=t[6]),1&n&&(a.isActive=t[0]),u.$set(a),t[0]?d?(d.p(t,n),1&n&&lt(d,1)):(d=Vg(t),d.c(),lt(d,1),d.m(e,null)):d&&(ut(),ht(d,1,1,(()=>{d=null})),ct())},i(t){l||(lt(r.$$.fragment,t),lt(s.$$.fragment,t),lt(u.$$.fragment,t),lt(d),l=!0)},o(t){ht(r.$$.fragment,t),ht(s.$$.fragment,t),ht(u.$$.fragment,t),ht(d),l=!1},d(t){t&&I(e),Tt(r),Tt(s),Tt(u),d&&d.d(),h=!1,o(f)}}}function Jg(t,e,n){let{rank:r}=e,{title:i}=e,{votes:o}=e,{banner:s}=e,{previousRank:a}=e,{previousVotes:u}=e,{description:c}=e,{genres:l}=e,{externalLinks:h}=e,{isActive:f}=e;return t.$$set=t=>{"rank"in t&&n(1,r=t.rank),"title"in t&&n(2,i=t.title),"votes"in t&&n(3,o=t.votes),"banner"in t&&n(4,s=t.banner),"previousRank"in t&&n(5,a=t.previousRank),"previousVotes"in t&&n(6,u=t.previousVotes),"description"in t&&n(7,c=t.description),"genres"in t&&n(9,l=t.genres),"externalLinks"in t&&n(8,h=t.externalLinks),"isActive"in t&&n(0,f=t.isActive)},[f,r,i,o,s,a,u,c,h,l,async()=>{const t="crunchyroll",e=Lg(t);let n;return e.cachedData&&!e.expired?n=e.cachedData.data:(n=await pg.collection("logos").doc("crunchyroll").get().then((t=>t.data().url)),Pg(t,n)),n},async()=>{const t="funimation",e=Lg(t);let n;return e.cachedData&&!e.expired?n=e.cachedData.data:(n=await pg.collection("logos").doc("funimation").get().then((t=>t.data().url)),Pg(t,n)),n},function(){n(0,f=!f)}]}class Zg extends kt{constructor(t){super(),At(this,t,Jg,Xg,a,{rank:1,title:2,votes:3,banner:4,previousRank:5,previousVotes:6,description:7,genres:9,externalLinks:8,isActive:0})}}function ty(t){let e,n,r;return{c(){e=T("div"),x(e,"class","panel svelte-11l3acu")},m(n,i){E(n,e,i),e.innerHTML=t[3],r=!0},p(t,n){(!r||8&n)&&(e.innerHTML=t[3])},i(t){r||(J((()=>{n||(n=dt(e,xt,{duration:200},!0)),n.run(1)})),r=!0)},o(t){n||(n=dt(e,xt,{duration:200},!1)),n.run(0),r=!1},d(t){t&&I(e),t&&n&&n.end()}}}function ey(t){let e,n,r,i,s,a,u,c,l=(t[1]||t[0])&&ty(t);return{c(){e=T("div"),n=T("h3"),r=A(t[2]),i=k(),l&&l.c(),s=N(),x(n,"class","svelte-11l3acu"),x(e,"class","accordion svelte-11l3acu"),x(e,"tabindex","0"),M(e,"active",t[1])},m(o,h){E(o,e,h),m(e,n),m(n,r),E(o,i,h),l&&l.m(o,h),E(o,s,h),a=!0,u||(c=[D(e,"click",t[4]),D(e,"keypress",t[4])],u=!0)},p(t,[n]){(!a||4&n)&&R(r,t[2]),2&n&&M(e,"active",t[1]),t[1]||t[0]?l?(l.p(t,n),3&n&&lt(l,1)):(l=ty(t),l.c(),lt(l,1),l.m(s.parentNode,s)):l&&(ut(),ht(l,1,1,(()=>{l=null})),ct())},i(t){a||(lt(l),a=!0)},o(t){ht(l),a=!1},d(t){t&&I(e),t&&I(i),l&&l.d(t),t&&I(s),u=!1,o(c)}}}function ny(t,e,n){let{question:r}=e,{answer:i}=e,{showAll:o}=e,{showDropdown:s}=e;return t.$$set=t=>{"question"in t&&n(2,r=t.question),"answer"in t&&n(3,i=t.answer),"showAll"in t&&n(0,o=t.showAll),"showDropdown"in t&&n(1,s=t.showDropdown)},[o,s,r,i,function(){o?(n(0,o=!1),n(1,s=!1)):n(1,s=!s)}]}class ry extends kt{constructor(t){super(),At(this,t,ny,ey,a,{question:2,answer:3,showAll:0,showDropdown:1})}}function iy(t,e,n){const r=t.slice();return r[12]=e[n],r}function oy(e){let n,r,i,a,u,c,l,h,f,d,p,v,g,y,b,w,S,N,C,R,O,L,P,F,V,U,q,j,B,$,z,K,G,H,Q=e[3],W=[];for(let t=0;t<Q.length;t+=1)W[t]=sy(iy(e,Q,t));const Y=t=>ht(W[t],1,1,(()=>{W[t]=null}));return{c(){n=T("div"),r=T("div"),i=k(),a=T("div"),u=T("div"),c=T("button"),c.innerHTML='<svg id="svg-close" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="#fff" preserveAspectRatio="xMidYMid meet" class="svelte-64hn7n"><path d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"></path></svg>',l=k(),h=T("div"),f=T("div"),f.innerHTML='<h1 class="svelte-64hn7n">About</h1>',d=k(),p=T("h2"),p.textContent="Navigation",v=k(),g=T("p"),g.innerHTML='Use the A D,\n          <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="#fff"><path d="M16.67 0l2.83 2.829-9.339 9.175 9.339 9.167-2.83 2.829-12.17-11.996z"></path></svg> \n          <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="#fff"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path></svg> keys to navigate back and forth the weekly ranking.',y=k(),b=T("h2"),b.textContent="Legend",w=k(),S=T("ul"),S.innerHTML='<li><svg class="arrow-gain svelte-64hn7n" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path d="M24 22h-24l12-20z"></path></svg> \n            <svg class="arrow-drop svelte-64hn7n" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path d="M12 21l-12-18h24z"></path></svg> \n            <svg class="arrow-neutral svelte-64hn7n" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path d="M0 9h24v6h-24z"></path></svg>\n            Rank Progression</li> \n          <li>% Vote Percentage</li>',N=k(),C=T("h2"),C.textContent="FAQ",R=k(),O=T("div"),L=T("button"),P=A("Expand All"),F=A("\n          |\n          "),V=T("button"),U=A("Collapse All"),j=k();for(let t=0;t<W.length;t+=1)W[t].c();x(r,"class","backdrop svelte-64hn7n"),x(c,"aria-label","Open About"),x(u,"class","close svelte-64hn7n"),x(f,"class","title svelte-64hn7n"),x(p,"class","svelte-64hn7n"),x(b,"class","svelte-64hn7n"),x(C,"class","svelte-64hn7n"),x(L,"id","expand"),L.disabled=e[0],x(L,"class","svelte-64hn7n"),M(L,"active",!e[0]),M(L,"disabled",e[0]),x(V,"id","collapse"),V.disabled=q=!e[0],x(V,"class","svelte-64hn7n"),M(V,"active",e[0]),M(V,"disabled",!e[0]),x(O,"class","expand-toggles"),x(h,"class","content svelte-64hn7n"),x(a,"class","content-wrapper svelte-64hn7n"),x(n,"class","modal svelte-64hn7n"),x(n,"tabindex","0")},m(o,I){E(o,n,I),m(n,r),m(n,i),m(n,a),m(a,u),m(u,c),m(a,l),m(a,h),m(h,f),m(h,d),m(h,p),m(h,v),m(h,g),m(h,y),m(h,b),m(h,w),m(h,S),m(h,N),m(h,C),m(h,R),m(h,O),m(O,L),m(L,P),m(O,F),m(O,V),m(V,U),m(h,j);for(let t=0;t<W.length;t+=1)W[t].m(h,null);var _;K=!0,G||(H=[D(c,"click",e[6]),D(L,"click",e[7]),D(V,"click",e[8]),(_=$=e[9].call(null,n),_&&s(_.destroy)?_.destroy:t)],G=!0)},p(t,e){if((!K||1&e)&&(L.disabled=t[0]),1&e&&M(L,"active",!t[0]),1&e&&M(L,"disabled",t[0]),(!K||1&e&&q!==(q=!t[0]))&&(V.disabled=q),1&e&&M(V,"active",t[0]),1&e&&M(V,"disabled",!t[0]),11&e){let n;for(Q=t[3],n=0;n<Q.length;n+=1){const r=iy(t,Q,n);W[n]?(W[n].p(r,e),lt(W[n],1)):(W[n]=sy(r),W[n].c(),lt(W[n],1),W[n].m(h,null))}for(ut(),n=Q.length;n<W.length;n+=1)Y(n);ct()}},i(t){if(!K){for(let t=0;t<Q.length;t+=1)lt(W[t]);J((()=>{B||(B=dt(a,Ct,{y:50,duration:200},!0)),B.run(1)})),J((()=>{z||(z=dt(n,Dt,{duration:200},!0)),z.run(1)})),K=!0}},o(t){W=W.filter(Boolean);for(let t=0;t<W.length;t+=1)ht(W[t]);B||(B=dt(a,Ct,{y:50,duration:200},!1)),B.run(0),z||(z=dt(n,Dt,{duration:200},!1)),z.run(0),K=!1},d(t){t&&I(n),_(W,t),t&&B&&B.end(),t&&z&&z.end(),G=!1,o(H)}}}function sy(t){let e,r;const i=[t[12],{showAll:t[0]},{showDropdown:t[1]}];let o={};for(let t=0;t<i.length;t+=1)o=n(o,i[t]);return e=new ry({props:o}),{c(){It(e.$$.fragment)},m(t,n){_t(e,t,n),r=!0},p(t,n){const r=11&n?wt(i,[8&n&&Et(t[12]),1&n&&{showAll:t[0]},2&n&&{showDropdown:t[1]}]):{};e.$set(r)},i(t){r||(lt(e.$$.fragment,t),r=!0)},o(t){ht(e.$$.fragment,t),r=!1},d(t){Tt(e,t)}}}function ay(t){let e,n,r,i,o,s,a,u=t[2]&&oy(t);return{c(){e=T("div"),n=T("button"),n.innerHTML='<svg id="svg-info" width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" class="svelte-64hn7n"><path d="M24 17.981h-13l-7 5.02v-5.02h-4v-16.981h24v16.981zm-11-9.98h-2v6h2v-6zm-1-1.5c.69 0 1.25-.56 1.25-1.25s-.56-1.25-1.25-1.25-1.25.56-1.25 1.25.56 1.25 1.25 1.25z"></path></svg>',r=k(),u&&u.c(),i=N(),x(n,"class","about svelte-64hn7n"),x(n,"aria-label","Open About Modal")},m(c,l){E(c,e,l),m(e,n),E(c,r,l),u&&u.m(c,l),E(c,i,l),o=!0,s||(a=D(n,"click",t[5]),s=!0)},p(t,[e]){t[2]?u?(u.p(t,e),4&e&&lt(u,1)):(u=oy(t),u.c(),lt(u,1),u.m(i.parentNode,i)):u&&(ut(),ht(u,1,1,(()=>{u=null})),ct())},i(t){o||(lt(u),o=!0)},o(t){ht(u),o=!1},d(t){t&&I(e),t&&I(r),u&&u.d(t),t&&I(i),s=!1,a()}}}function uy(t){t.target.focus()}function cy(t,e,n){let r,i;l(t,jt,(t=>n(3,i=t)));const o=function(t){const e=Lt(t),{set:n}=e;return{isOpen:e,open:()=>n(!0),close:()=>n(!1)}}(!1),{isOpen:s,open:a,close:u}=o;l(t,s,(t=>n(2,r=t)));let c=!1,h=!1;function f(t){t.stopPropagation(),"Escape"===t.key&&u()}return[c,h,r,i,s,a,u,function(){n(0,c=!0),n(1,h=!0)},function(){n(0,c=!1),n(1,h=!1)},function(t){const e=[];if("hidden"!==document.body.style.overflow){const t=document.body.style.overflow;document.body.style.overflow="hidden",e.push((()=>{document.body.style.overflow=t}))}return t.addEventListener("keydown",f),t.addEventListener("transitionend",uy),t.focus(),e.push((()=>{t.removeEventListener("keydown",f),t.removeEventListener("transitionend",uy)})),{destroy:()=>e.forEach((t=>t()))}}]}class ly extends kt{constructor(t){super(),At(this,t,cy,ay,a,{})}}function hy(t,e,n){const r=t.slice();return r[34]=e[n],r}function fy(t,e,n){const r=t.slice();return r[34]=e[n],r}function dy(t,e,n){const r=t.slice();return r[39]=e[n],r}function py(t,e,n){const r=t.slice();return r[42]=e[n],r}function vy(t){let e,n,r,i=t[0],s=[];for(let e=0;e<i.length;e+=1)s[e]=yy(py(t,i,e));return{c(){e=T("select");for(let t=0;t<s.length;t+=1)s[t].c();x(e,"aria-label","Select Season"),void 0===t[7]&&J((()=>t[16].call(e)))},m(i,o){E(i,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);L(e,t[7]),n||(r=[D(e,"change",t[16]),D(e,"change",t[12])],n=!0)},p(t,n){if(1&n[0]){let r;for(i=t[0],r=0;r<i.length;r+=1){const o=py(t,i,r);s[r]?s[r].p(o,n):(s[r]=yy(o),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=i.length}129&n[0]&&L(e,t[7])},d(t){t&&I(e),_(s,t),n=!1,o(r)}}}function gy(e){let n,r;return{c(){n=T("select"),r=T("option"),r.textContent="Loading...",r.__value="",r.value=r.__value,x(n,"aria-label","Select Season")},m(t,e){E(t,n,e),m(n,r)},p:t,d(t){t&&I(n)}}}function yy(t){let e,n,r,i=t[42]+"";return{c(){e=T("option"),n=A(i),x(e,"class","dropdown-item svelte-168ebyw"),e.__value=r=t[42],e.value=e.__value},m(t,r){E(t,e,r),m(e,n)},p(t,o){1&o[0]&&i!==(i=t[42]+"")&&R(n,i),1&o[0]&&r!==(r=t[42])&&(e.__value=r,e.value=e.__value)},d(t){t&&I(e)}}}function my(t){let e,n,r,i=t[1],s=[];for(let e=0;e<i.length;e+=1)s[e]=wy(dy(t,i,e));return{c(){e=T("select");for(let t=0;t<s.length;t+=1)s[t].c();x(e,"aria-label","Select Week"),void 0===t[6]&&J((()=>t[17].call(e)))},m(i,o){E(i,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);L(e,t[6]),n||(r=[D(e,"change",t[17]),D(e,"change",t[13])],n=!0)},p(t,n){if(2&n[0]){let r;for(i=t[1],r=0;r<i.length;r+=1){const o=dy(t,i,r);s[r]?s[r].p(o,n):(s[r]=wy(o),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=i.length}66&n[0]&&L(e,t[6])},d(t){t&&I(e),_(s,t),n=!1,o(r)}}}function by(e){let n,r;return{c(){n=T("select"),r=T("option"),r.textContent="Loading...",r.__value="",r.value=r.__value,x(n,"aria-label","Select Week")},m(t,e){E(t,n,e),m(n,r)},p:t,d(t){t&&I(n)}}}function wy(t){let e,n,r,i,o=parseInt(t[39].split("-")[1])+"";return{c(){e=T("option"),n=A("Week "),r=A(o),x(e,"class","dropdown-item svelte-168ebyw"),e.__value=i=t[39],e.value=e.__value},m(t,i){E(t,e,i),m(e,n),m(e,r)},p(t,n){2&n[0]&&o!==(o=parseInt(t[39].split("-")[1])+"")&&R(r,o),2&n[0]&&i!==(i=t[39])&&(e.__value=i,e.value=e.__value)},d(t){t&&I(e)}}}function Ey(t){let e,n,r=[],i=new Map,o=t[2];const s=t=>t[34].title;for(let e=0;e<o.length;e+=1){let n=hy(t,o,e),a=s(n);i.set(a,r[e]=Ty(a,n))}return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=N()},m(t,i){for(let e=0;e<r.length;e+=1)r[e].m(t,i);E(t,e,i),n=!0},p(t,n){if(516&n[0]){o=t[2],ut();for(let t=0;t<r.length;t+=1)r[t].r();r=bt(r,n,s,1,t,o,i,e.parentNode,mt,Ty,e,hy);for(let t=0;t<r.length;t+=1)r[t].a();ct()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)lt(r[t]);n=!0}},o(t){for(let t=0;t<r.length;t+=1)ht(r[t]);n=!1},d(t){for(let e=0;e<r.length;e+=1)r[e].d(t);t&&I(e)}}}function Iy(t){let e,n,r=[],i=new Map,o=t[2];const s=t=>t[34].title;for(let e=0;e<o.length;e+=1){let n=fy(t,o,e),a=s(n);i.set(a,r[e]=Sy(a,n))}return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=N()},m(t,i){for(let e=0;e<r.length;e+=1)r[e].m(t,i);E(t,e,i),n=!0},p(t,n){516&n[0]&&(o=t[2],ut(),r=bt(r,n,s,1,t,o,i,e.parentNode,yt,Sy,e,fy),ct())},i(t){if(!n){for(let t=0;t<o.length;t+=1)lt(r[t]);n=!0}},o(t){for(let t=0;t<r.length;t+=1)ht(r[t]);n=!1},d(t){for(let e=0;e<r.length;e+=1)r[e].d(t);t&&I(e)}}}function _y(e){let n,r,i;return r=new zt({props:{size:"64",unit:"px",color:ky}}),{c(){n=T("div"),It(r.$$.fragment),x(n,"class","loading svelte-168ebyw")},m(t,e){E(t,n,e),_t(r,n,null),i=!0},p:t,i(t){i||(lt(r.$$.fragment,t),i=!0)},o(t){ht(r.$$.fragment,t),i=!1},d(t){t&&I(n),Tt(r)}}}function Ty(r,i){let a,u,c,l,h,f,p,v=t;const g=[i[34],{isActive:i[9]}];let b={};for(let t=0;t<g.length;t+=1)b=n(b,g[t]);return u=new Zg({props:b}),{key:r,first:null,c(){a=T("div"),It(u.$$.fragment),c=k(),this.first=a},m(t,e){E(t,a,e),_t(u,a,null),m(a,c),p=!0},p(t,e){i=t;const n=516&e[0]?wt(g,[4&e[0]&&Et(i[34]),512&e[0]&&{isActive:i[9]}]):{};u.$set(n)},r(){f=a.getBoundingClientRect()},f(){!function(t){const e=getComputedStyle(t);if("absolute"!==e.position&&"fixed"!==e.position){const{width:n,height:r}=e,i=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=r,$(t,i)}}(a),v(),$(a,f)},a(){v(),v=function(n,r,i,o){if(!r)return t;const s=n.getBoundingClientRect();if(r.left===s.left&&r.right===s.right&&r.top===s.top&&r.bottom===s.bottom)return t;const{delay:a=0,duration:u=300,easing:c=e,start:l=d()+a,end:h=l+u,tick:f=t,css:p}=i(n,{from:r,to:s},o);let v,g=!0,m=!1;function b(){p&&B(n,v),g=!1}return y((t=>{if(!m&&t>=l&&(m=!0),m&&t>=h&&(f(1,0),b()),!g)return!1;if(m){const e=0+1*c((t-l)/u);f(e,1-e)}return!0})),p&&(v=j(n,0,1,u,a,c,p)),a||(m=!0),f(0,1),b}(a,f,Rt,{duration:850})},i(n){p||(lt(u.$$.fragment,n),J((()=>{h&&h.end(1),l=function(n,r,i){let o,a,u=r(n,i),c=!1,l=0;function h(){o&&B(n,o)}function f(){const{delay:r=0,duration:i=300,easing:s=e,tick:f=t,css:p}=u||ft;p&&(o=j(n,0,1,i,r,s,p,l++)),f(0,1);const v=d()+r,g=v+i;a&&a.abort(),c=!0,J((()=>ot(n,!0,"start"))),a=y((t=>{if(c){if(t>=g)return f(1,0),ot(n,!0,"end"),h(),c=!1;if(t>=v){const e=s((t-v)/i);f(e,1-e)}}return c}))}let p=!1;return{start(){p||(p=!0,B(n),s(u)?(u=u(),it().then(f)):f())},invalidate(){p=!1},end(){c&&(h(),c=!1)}}}(a,Dt,{duration:500}),l.start()})),p=!0)},o(n){ht(u.$$.fragment,n),l&&l.invalidate(),h=function(n,r,i){let a,u=r(n,i),c=!0;const l=at;function h(){const{delay:r=0,duration:i=300,easing:s=e,tick:h=t,css:f}=u||ft;f&&(a=j(n,1,0,i,r,s,f));const p=d()+r,v=p+i;J((()=>ot(n,!1,"start"))),y((t=>{if(c){if(t>=v)return h(0,1),ot(n,!1,"end"),--l.r||o(l.c),!1;if(t>=p){const e=s((t-p)/i);h(1-e,e)}}return c}))}return l.r+=1,s(u)?it().then((()=>{u=u(),h()})):h(),{end(t){t&&u.tick&&u.tick(1,0),c&&(a&&B(n,a),c=!1)}}}(a,Dt,{duration:300}),p=!1},d(t){t&&I(a),Tt(u),t&&h&&h.end()}}}function Sy(t,e){let r,i,o;const s=[e[34],{isActive:e[9]}];let a={};for(let t=0;t<s.length;t+=1)a=n(a,s[t]);return i=new Zg({props:a}),{key:t,first:null,c(){r=N(),It(i.$$.fragment),this.first=r},m(t,e){E(t,r,e),_t(i,t,e),o=!0},p(t,n){e=t;const r=516&n[0]?wt(s,[4&n[0]&&Et(e[34]),512&n[0]&&{isActive:e[9]}]):{};i.$set(r)},i(t){o||(lt(i.$$.fragment,t),o=!0)},o(t){ht(i.$$.fragment,t),o=!1},d(t){t&&I(r),Tt(i,t)}}}function Ay(t){let e,n,r,i,s,a,u,c,l,h,f,d,p,v,g,y,b,w,_;function A(t,e){return 0==t[0]?gy:vy}let N=A(t),C=N(t);function R(t,e){return 0==t[1].length||t[3]?by:my}let O=R(t),L=O(t);d=new ly({});const P=[_y,Iy,Ey],F=[];function V(t,e){return 0==t[2].length?0:!0===t[8].noanimations?1:2}return g=V(t),y=F[g]=P[g](t),{c(){e=T("div"),n=T("button"),r=S("svg"),i=S("path"),s=k(),C.c(),a=k(),L.c(),u=k(),c=T("button"),l=S("svg"),h=S("path"),f=k(),It(d.$$.fragment),p=k(),v=T("div"),y.c(),x(i,"d","M24 20.205L21.005 23.185L9.873 12L21.005 0.813972L24 3.79497L15.833 12L24 20.205V20.205ZM5.96 12L14.127 3.79497L11.132 0.814974L0 12L11.132 23.186L14.127 20.206L5.96 12V12Z"),x(r,"xmlns","http://www.w3.org/2000/svg"),x(r,"width","16"),x(r,"height","16"),x(r,"viewBox","0 0 24 24"),x(r,"class","svelte-168ebyw"),M(r,"active",!t[5]),M(r,"disabled",t[5]),x(n,"class","arrow svelte-168ebyw"),x(n,"id","prev-btn"),x(n,"aria-label","Previous Page"),x(h,"d","M0 3.795l2.995-2.98 11.132 11.185-11.132 11.186-2.995-2.981 8.167-8.205-8.167-8.205zm18.04 8.205l-8.167 8.205 2.995 2.98 11.132-11.185-11.132-11.186-2.995 2.98 8.167 8.206z"),x(l,"xmlns","http://www.w3.org/2000/svg"),x(l,"width","16"),x(l,"height","16"),x(l,"viewBox","0 0 24 24"),x(l,"class","svelte-168ebyw"),M(l,"active",!t[4]),M(l,"disabled",t[4]),x(c,"class","arrow svelte-168ebyw"),x(c,"id","next-btn"),x(c,"aria-label","Next Page"),x(e,"class","filters svelte-168ebyw"),x(v,"class","rankings svelte-168ebyw")},m(o,y){E(o,e,y),m(e,n),m(n,r),m(r,i),m(e,s),C.m(e,null),m(e,a),L.m(e,null),m(e,u),m(e,c),m(c,l),m(l,h),m(e,f),_t(d,e,null),E(o,p,y),E(o,v,y),F[g].m(v,null),b=!0,w||(_=[D(n,"click",t[14]),D(c,"click",t[15])],w=!0)},p(t,n){32&n[0]&&M(r,"active",!t[5]),32&n[0]&&M(r,"disabled",t[5]),N===(N=A(t))&&C?C.p(t,n):(C.d(1),C=N(t),C&&(C.c(),C.m(e,a))),O===(O=R(t))&&L?L.p(t,n):(L.d(1),L=O(t),L&&(L.c(),L.m(e,u))),16&n[0]&&M(l,"active",!t[4]),16&n[0]&&M(l,"disabled",t[4]);let i=g;g=V(t),g===i?F[g].p(t,n):(ut(),ht(F[i],1,1,(()=>{F[i]=null})),ct(),y=F[g],y?y.p(t,n):(y=F[g]=P[g](t),y.c()),lt(y,1),y.m(v,null))},i(t){b||(lt(d.$$.fragment,t),lt(y),b=!0)},o(t){ht(d.$$.fragment,t),ht(y),b=!1},d(t){t&&I(e),C.d(),L.d(),Tt(d),t&&I(p),t&&I(v),F[g].d(),w=!1,o(_)}}}const ky="#f3667b";function Ny(t,e=300){let n;return(...r)=>{n||t.apply(this,r),clearTimeout(n),n=setTimeout((()=>{n=void 0}),e)}}function Dy(t,e,n){let r,i,o,s,a,u,c,f;l(t,Vt,(t=>n(6,o=t))),l(t,Ft,(t=>n(7,s=t))),l(t,Mt,(t=>n(20,a=t))),l(t,Ut,(t=>n(21,u=t))),l(t,Pt,(t=>n(8,c=t))),l(t,qt,(t=>n(9,f=t)));const d=function(t){const e=Lt(t),{set:n}=e;return{next:e,enableNext:()=>{document.getElementById("next-btn").disabled=!1,n(!1)},disableNext:()=>{document.getElementById("next-btn").disabled=!0,n(!0)}}}(!1),p=function(t){const e=Lt(t),{set:n}=e;return{prev:e,enablePrev:()=>{document.getElementById("prev-btn").disabled=!1,n(!1)},disablePrev:()=>{document.getElementById("prev-btn").disabled=!0,n(!0)}}}(!1),{next:v,enableNext:g,disableNext:y}=d;l(t,v,(t=>n(4,r=t)));const{prev:m,enablePrev:b,disablePrev:w}=p;l(t,m,(t=>n(5,i=t)));let E=[],I=[],_=[],T=!1,S=!1,A=pg.collection(a).doc(s).collection(o).orderBy("rank","asc").limit(15);!function(t){K().$$.on_mount.push(t)}((async()=>{w(),y(),n(2,_=await k()),n(0,E=await N()),n(1,I=await D()),b(),y()}));const k=async()=>{let t=`${s}-${o}-page-${u}`,e=Lg(t);if(e.cachedData&&!e.expired)return document.getElementById("prev-btn").disabled=!1,document.getElementById("next-btn").disabled=!1,e.cachedData.data;{let e=await A.get().then((t=>t.docs.map((t=>t.data()))));return await x(e),Pg(t,e),e}},N=async()=>{let t="Seasons",e=Lg(t);if(e.cachedData&&!e.expired)return e.cachedData.data;{let e=pg.collection(a).orderBy("order","asc");return await e.get().then((t=>{t.forEach((t=>{n(0,E=[...E,t.id])}))})),Pg(t,E),E}},D=async()=>{w(),y();let t=`${s}-Weeks`,e=Lg(t);if(e.cachedData&&!e.expired)return n(1,I.length=0,I),n(1,I=e.cachedData.data),b(),g(),I;{n(1,I.length=0,I);const e=vg.httpsCallable("fetchSubCollections");return await e({year:a,season:s}).then((t=>{n(1,I=t.data)})),Pg(t,I),b(),g(),I}},C=async()=>{w(),y(),h(Ut,u=1,u);let t=`${s}-${o}-page-${u}`,e=Lg(t);if(e.cachedData&&!e.expired)n(2,_.length=0,_),n(2,_=e.cachedData.data);else{let e=[];n(2,_.length=0,_),A=pg.collection(a).doc(s).collection(o).orderBy("rank","asc").limit(15);let r=await A.get().then((t=>t.docs.map((t=>t.data()))));await x(r);for(let t=0;t<r.length;t++)e={rank:r[t].rank,title:r[t].title,votes:r[t].votes,banner:r[t].banner,previousRank:r[t].previousRank,previousVotes:r[t].previousVotes,description:r[t].description,genres:r[t].genres,externalLinks:r[t].externalLinks},n(2,_=[..._,e]);Pg(t,r)}"Week-01"==o?(w(),g()):"Week-12"==o?(b(),y()):(b(),g())},x=async t=>{let e;for(let n=0;n<t.length;n++)e=await pg.collection("banners").doc(t[n].title).get().then((t=>t.data().banner)),t[n].banner=e};const R=Ny((()=>function(){let t=I.indexOf(o);r&&g(),1==t?(h(Vt,o=I[t-1],o),C(),w()):(h(Vt,o=I[t-1],o),C())}())),O=Ny((()=>function(){let t=I.indexOf(o);i&&b(),t+1==I.length-1?(h(Vt,o=I[t+1],o),C(),y()):(h(Vt,o=I[t+1],o),C())}()));return document.addEventListener("keydown",(t=>{S||(S=!0,"KeyA"!==t.code&&"ArrowLeft"!==t.code||i||R(),"KeyD"!==t.code&&"ArrowRight"!==t.code||r||O())})),document.addEventListener("keyup",(()=>{S=!1})),[E,I,_,T,r,i,o,s,c,f,v,m,async()=>{n(3,T=!0),h(Vt,o="Week-01",o),await C(),await D(),n(3,T=!1),w()},C,R,O,function(){s=P(this),Ft.set(s),n(0,E)},function(){o=P(this),Vt.set(o),n(1,I)}]}class Cy extends kt{constructor(t){super(),At(this,t,Dy,Ay,a,{},null,[-1,-1])}}function xy(e){let n;return{c(){n=T("footer"),n.innerHTML='<div class="footer svelte-7v7sya"><div class="vote svelte-7v7sya">Vote for next week on <a href="https://polls.animecorner.me/" target="_blank">polls.animecorner.me</a></div> \n\n    <div class="follow svelte-7v7sya">Follow Anime Corner on\n      <div><a class="icon svelte-7v7sya" href="https://www.facebook.com/AnimeCorner.Official" target="_blank" aria-label="Open Anime Corner&#39;s Facebook Page"><svg class="svg-icon svelte-7v7sya" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm3 8h-1.35c-.538 0-.65.221-.65.778v1.222h2l-.209 2h-1.791v7h-3v-7h-2v-2h2v-2.308c0-1.769.931-2.692 3.029-2.692h1.971v3z"></path></svg></a> \n\n        <a class="icon svelte-7v7sya" href="https://twitter.com/animecorner_ac" target="_blank" aria-label="Open Anime Corner&#39;s Twitter Page"><svg class="svg-icon svelte-7v7sya" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path></svg></a> \n\n        <a class="icon svelte-7v7sya" href="https://www.instagram.com/animecorner_ac/" target="_blank" aria-label="Open Anime Corner&#39;s Instagram Page"><svg class="svg-icon svelte-7v7sya" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path></svg></a> \n\n        <a class="icon svelte-7v7sya" href="https://discord.gg/RcXTHqByGP" target="_blank" aria-label="Open Anime Corner&#39;s Discord Group"><svg class="svg-icon svelte-7v7sya" width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd"><path d="M19.54 0c1.356 0 2.46 1.104 2.46 2.472v21.528l-2.58-2.28-1.452-1.344-1.536-1.428.636 2.22h-13.608c-1.356 0-2.46-1.104-2.46-2.472v-16.224c0-1.368 1.104-2.472 2.46-2.472h16.08zm-4.632 15.672c2.652-.084 3.672-1.824 3.672-1.824 0-3.864-1.728-6.996-1.728-6.996-1.728-1.296-3.372-1.26-3.372-1.26l-.168.192c2.04.624 2.988 1.524 2.988 1.524-1.248-.684-2.472-1.02-3.612-1.152-.864-.096-1.692-.072-2.424.024l-.204.024c-.42.036-1.44.192-2.724.756-.444.204-.708.348-.708.348s.996-.948 3.156-1.572l-.12-.144s-1.644-.036-3.372 1.26c0 0-1.728 3.132-1.728 6.996 0 0 1.008 1.74 3.66 1.824 0 0 .444-.54.804-.996-1.524-.456-2.1-1.416-2.1-1.416l.336.204.048.036.047.027.014.006.047.027c.3.168.6.3.876.408.492.192 1.08.384 1.764.516.9.168 1.956.228 3.108.012.564-.096 1.14-.264 1.74-.516.42-.156.888-.384 1.38-.708 0 0-.6.984-2.172 1.428.36.456.792.972.792.972zm-5.58-5.604c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332.012-.732-.54-1.332-1.224-1.332zm4.38 0c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332 0-.732-.54-1.332-1.224-1.332z"></path></svg></a></div></div></div>',x(n,"class","svelte-7v7sya")},m(t,e){E(t,n,e)},p:t,i:t,o:t,d(t){t&&I(n)}}}class Ry extends kt{constructor(t){super(),At(this,t,null,xy,a,{})}}const{window:Oy}=gt;function Ly(t){let e,n,r,i,s,a,u,c,l,h,f,d,p;return a=new Cy({}),h=new Ry({}),{c(){e=T("main"),n=T("h1"),n.innerHTML='<a href="https://animecorner.me/" target="_blank" class="svelte-1fcuxu5">animecorner.me rankings</a>',r=k(),i=T("p"),i.textContent="A web representation of anime corner's anime of the week.",s=k(),It(a.$$.fragment),u=k(),c=T("button"),c.innerHTML='<svg id="arrow" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 16.67l2.829 2.83 9.175-9.339 9.167 9.339 2.829-2.83-11.996-12.17z"></path></svg>',l=k(),It(h.$$.fragment),x(n,"class","svelte-1fcuxu5"),x(e,"class","svelte-1fcuxu5"),x(c,"aria-label","Back To Top"),x(c,"class","svelte-1fcuxu5"),M(c,"hidden",t[0])},m(o,v){E(o,e,v),m(e,n),m(e,r),m(e,i),m(e,s),_t(a,e,null),E(o,u,v),E(o,c,v),E(o,l,v),_t(h,o,v),f=!0,d||(p=[D(Oy,"scroll",t[1]),D(c,"click",Py)],d=!0)},p(t,[e]){1&e&&M(c,"hidden",t[0])},i(t){f||(lt(a.$$.fragment,t),lt(h.$$.fragment,t),f=!0)},o(t){ht(a.$$.fragment,t),ht(h.$$.fragment,t),f=!1},d(t){t&&I(e),Tt(a),t&&I(u),t&&I(c),t&&I(l),Tt(h,t),d=!1,o(p)}}}function Py(){window.scrollTo(0,0)}function My(){return document.documentElement||document.body}function Fy(t,e,n){let r=!0;return[r,function(){My()&&(My().scrollTop>200?n(0,r=!1):n(0,r=!0))}]}return new class extends kt{constructor(t){super(),At(this,t,Fy,Ly,a,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
